{"version":3,"file":"UsersButton.3be34569.js","sources":["../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/add/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInCalendarMonths/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInCalendarYears/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInDays/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInMilliseconds/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInHours/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInMinutes/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/isLastDayOfMonth/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInMonths/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInSeconds/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/differenceInYears/index.js","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/intervalToDuration/index.js","../../../../node_modules/.pnpm/react-use@17.4.0_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-use/esm/useUpdate.js","../../../../node_modules/.pnpm/rc-switch@3.2.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/rc-switch/es/index.js","../../../../node_modules/.pnpm/antd@4.23.2_sfoxds7t5ydpegc3knd667wn6m/node_modules/antd/es/switch/index.js","../../../../packages/flat-components/src/components/ChatPanel/ChatMessages/icons/chat-messages-default.svg","../../../../packages/flat-components/src/components/ChatPanel/ChatMessages/icons/chat-messages-default-dark.svg","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGCamera.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGCameraMute.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGChatBanning.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGExit.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGHandUp.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGMenuFold.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGMenuUnfold.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGMicrophoneMute.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGPlus.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGRecord.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGRecordStop.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGScreenSharing.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGSend.tsx","../../../../packages/flat-components/src/components/FlatIcons/icons/SVGUserInvite.tsx","../../../../packages/flat-components/src/components/ChatPanel/ChatTypeBox/index.tsx","../../../../node_modules/.pnpm/react-virtualized@9.22.3_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-virtualized/dist/es/CellMeasurer/CellMeasurerCache.js","../../../../packages/flat-components/src/components/ChatPanel/ChatMessage/index.tsx","../../../../packages/flat-components/src/components/ChatPanel/ChatMessageList/index.tsx","../../../../packages/flat-components/src/components/ChatPanel/ChatMessages/index.tsx","../../../../packages/flat-components/src/components/ChatPanel/ChatTabTitle/index.tsx","../../../../packages/flat-components/src/components/ChatPanel/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/ExitRoomConfirmModal/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/NetworkStatus/icons/signal-0.svg","../../../../packages/flat-components/src/components/ClassroomPage/NetworkStatus/icons/signal-1.svg","../../../../packages/flat-components/src/components/ClassroomPage/NetworkStatus/icons/signal-2.svg","../../../../packages/flat-components/src/components/ClassroomPage/NetworkStatus/icons/signal-3.svg","../../../../packages/flat-components/src/components/ClassroomPage/NetworkStatus/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/TopBar/TopBarRightBtn/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/RoomInfo/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/RoomStoppedModal/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/VideoAvatar/IconMic.tsx","../../../../packages/flat-components/src/components/ClassroomPage/VideoAvatar/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/VideoAvatarAbsent/icons/Placeholder.tsx","../../../../packages/flat-components/src/components/ClassroomPage/VideoAvatarAbsent/index.tsx","../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/toFinite.js","../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/toInteger.js","../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isInteger.js","../../../../packages/flat-components/src/components/ClassroomPage/RaiseHand/index.tsx","../../../../node_modules/.pnpm/@wopjs+dom@0.1.3/node_modules/@wopjs/dom/dist/index.js","../../../../packages/flat-components/src/components/ClassroomPage/AvatarWindow/index.tsx","../../../../packages/flat-components/src/components/ClassroomPage/CloudRecordBtn/index.tsx","../../../../node_modules/.pnpm/date-fns@2.29.3/node_modules/date-fns/esm/fp/intervalToDuration/index.js","../../../../packages/flat-components/src/components/ClassroomPage/Timer/index.tsx","../../../../packages/flat-components/src/components/PresetsModal/Thumbnail.tsx","../../../../packages/flat-components/src/components/PresetsModal/index.tsx","../../../../packages/flat-components/src/components/SaveAnnotationModal/icons/download.svg","../../../../packages/flat-components/src/components/SaveAnnotationModal/index.tsx","../../../../packages/flat-components/src/components/UsersPanel/index.tsx","../../../../packages/flat-stores/src/user-store.ts","../../../../packages/flat-stores/src/classroom-store/chat-store.ts","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/codec-pool-worker.js","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/codec-pool.js","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/io.js","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/constants.js","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/util/decode-text.js","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/zip-entry.js","../../../../node_modules/.pnpm/@zip.js+zip.js@2.6.29/node_modules/@zip.js/zip.js/lib/core/zip-reader.js","../../../../packages/flat-stores/src/utils/courseware-preloader/index.ts","../../../../packages/flat-stores/src/whiteboard-store/index.ts","../../../../packages/flat-stores/src/classroom-store/constants.ts","../../../../packages/flat-stores/src/classroom-store/index.ts","../../../../packages/flat-pages/src/components/ChatPanel/index.tsx","../../../../packages/flat-pages/src/components/ClassRoom/RoomStatusStoppedModal.tsx","../../../../packages/flat-pages/src/CloudStoragePage/CloudStoragePanel.tsx","../../../../packages/flat-pages/src/components/CloudStorageButton.tsx","../../../../packages/flat-pages/src/components/ExitRoomConfirm.tsx","../../../../packages/flat-pages/src/components/Modal/InviteModal.tsx","../../../../packages/flat-pages/src/components/InviteButton.tsx","../../../../packages/flat-pages/src/components/RealtimePanel.tsx","../../../../packages/flat-pages/src/utils/drag-and-drop/index.ts","../../../../packages/flat-pages/src/utils/drag-and-drop/image.ts","../../../../packages/flat-pages/src/constants/presets.ts","../../../../packages/flat-pages/src/utils/create-cloud-file.ts","../../../../packages/flat-pages/src/components/UserWindows.tsx","../../../../packages/flat-pages/src/components/Whiteboard.tsx","../../../../packages/flat-pages/src/components/RTCAvatar/AvatarCanvas.tsx","../../../../packages/flat-pages/src/components/RTCAvatar/index.tsx","../../../../packages/flat-pages/src/assets/image/drag.svg","../../../../packages/flat-pages/src/components/ShareScreen/ShareScreenTip/index.tsx","../../../../packages/flat-pages/src/components/ShareScreen/index.tsx","../../../../packages/flat-pages/src/utils/use-classroom-store.ts","../../../../packages/flat-pages/src/utils/with-classroom-store.tsx","../../../../packages/flat-pages/src/components/ShareScreen/ShareScreenPicker/ScreenList/index.tsx","../../../../packages/flat-pages/src/components/ShareScreen/ShareScreenPicker/index.tsx","../../../../packages/flat-pages/src/components/ExtraPadding.tsx","../../../../packages/flat-pages/src/components/UsersButton.tsx"],"sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nimport addDays from \"../addDays/index.js\";\nimport addMonths from \"../addMonths/index.js\";\nimport toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport toInteger from \"../_lib/toInteger/index.js\";\n\n/**\n * @name add\n * @category Common Helpers\n * @summary Add the specified years, months, weeks, days, hours, minutes and seconds to the given date.\n *\n * @description\n * Add the specified years, months, weeks, days, hours, minutes and seconds to the given date.\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Duration} duration - the object with years, months, weeks, days, hours, minutes and seconds to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n *\n * | Key            | Description                        |\n * |----------------|------------------------------------|\n * | years          | Amount of years to be added        |\n * | months         | Amount of months to be added       |\n * | weeks          | Amount of weeks to be added        |\n * | days           | Amount of days to be added         |\n * | hours          | Amount of hours to be added        |\n * | minutes        | Amount of minutes to be added      |\n * | seconds        | Amount of seconds to be added      |\n *\n * All values default to 0\n *\n * @returns {Date} the new date with the seconds added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add the following duration to 1 September 2014, 10:19:50\n * const result = add(new Date(2014, 8, 1, 10, 19, 50), {\n *   years: 2,\n *   months: 9,\n *   weeks: 1,\n *   days: 7,\n *   hours: 5,\n *   minutes: 9,\n *   seconds: 30,\n * })\n * //=> Thu Jun 15 2017 15:29:20\n */\nexport default function add(dirtyDate, duration) {\n  requiredArgs(2, arguments);\n  if (!duration || _typeof(duration) !== 'object') return new Date(NaN);\n  var years = duration.years ? toInteger(duration.years) : 0;\n  var months = duration.months ? toInteger(duration.months) : 0;\n  var weeks = duration.weeks ? toInteger(duration.weeks) : 0;\n  var days = duration.days ? toInteger(duration.days) : 0;\n  var hours = duration.hours ? toInteger(duration.hours) : 0;\n  var minutes = duration.minutes ? toInteger(duration.minutes) : 0;\n  var seconds = duration.seconds ? toInteger(duration.seconds) : 0; // Add years and months\n\n  var date = toDate(dirtyDate);\n  var dateWithMonths = months || years ? addMonths(date, months + years * 12) : date; // Add weeks and days\n\n  var dateWithDays = days || weeks ? addDays(dateWithMonths, days + weeks * 7) : dateWithMonths; // Add days, hours, minutes and seconds\n\n  var minutesToAdd = minutes + hours * 60;\n  var secondsToAdd = seconds + minutesToAdd * 60;\n  var msToAdd = secondsToAdd * 1000;\n  var finalDate = new Date(dateWithDays.getTime() + msToAdd);\n  return finalDate;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\n\nexport default function differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInCalendarYears\n * @category Year Helpers\n * @summary Get the number of calendar years between the given dates.\n *\n * @description\n * Get the number of calendar years between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInCalendarYears(\n *   new Date(2015, 1, 11),\n *   new Date(2013, 11, 31)\n * )\n * //=> 2\n */\n\nexport default function differenceInCalendarYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  return dateLeft.getFullYear() - dateRight.getFullYear();\n}","import toDate from \"../toDate/index.js\";\nimport differenceInCalendarDays from \"../differenceInCalendarDays/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\"; // Like `compareAsc` but uses local time not UTC, which is needed\n// for accurate equality comparisons of UTC timestamps that end up\n// having the same representation in local time, e.g. one hour before\n// DST ends vs. the instant that DST ends.\n\nfunction compareLocalAsc(dateLeft, dateRight) {\n  var diff = dateLeft.getFullYear() - dateRight.getFullYear() || dateLeft.getMonth() - dateRight.getMonth() || dateLeft.getDate() - dateRight.getDate() || dateLeft.getHours() - dateRight.getHours() || dateLeft.getMinutes() - dateRight.getMinutes() || dateLeft.getSeconds() - dateRight.getSeconds() || dateLeft.getMilliseconds() - dateRight.getMilliseconds();\n\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1; // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}\n/**\n * @name differenceInDays\n * @category Day Helpers\n * @summary Get the number of full days between the given dates.\n *\n * @description\n * Get the number of full day periods between two dates. Fractional days are\n * truncated towards zero.\n *\n * One \"full day\" is the distance between a local time in one day to the same\n * local time on the next or previous day. A full day can sometimes be less than\n * or more than 24 hours if a daylight savings change happens between two dates.\n *\n * To ignore DST and only measure exact 24-hour periods, use this instead:\n * `Math.floor(differenceInHours(dateLeft, dateRight)/24)|0`.\n *\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full days according to the local timezone\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 365\n * // How many full days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 0\n * // How many full days are between\n * // 1 March 2020 0:00 and 1 June 2020 0:00 ?\n * // Note: because local time is used, the\n * // result will always be 92 days, even in\n * // time zones where DST starts and the\n * // period has only 92*24-1 hours.\n * const result = differenceInDays(\n *   new Date(2020, 5, 1),\n *   new Date(2020, 2, 1)\n * )\n//=> 92\n */\n\n\nexport default function differenceInDays(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareLocalAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarDays(dateLeft, dateRight));\n  dateLeft.setDate(dateLeft.getDate() - sign * difference); // Math.abs(diff in full days - diff in calendar days) === 1 if last calendar day is not full\n  // If so, result must be decreased by 1 in absolute value\n\n  var isLastDayNotFull = Number(compareLocalAsc(dateLeft, dateRight) === -sign);\n  var result = sign * (difference - isLastDayNotFull); // Prevent negative zero\n\n  return result === 0 ? 0 : result;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of milliseconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\n\nexport default function differenceInMilliseconds(dateLeft, dateRight) {\n  requiredArgs(2, arguments);\n  return toDate(dateLeft).getTime() - toDate(dateRight).getTime();\n}","import { millisecondsInHour } from \"../constants/index.js\";\nimport differenceInMilliseconds from \"../differenceInMilliseconds/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport { getRoundingMethod } from \"../_lib/roundingMethods/index.js\";\n/**\n * @name differenceInHours\n * @category Hour Helpers\n * @summary Get the number of hours between the given dates.\n *\n * @description\n * Get the number of hours between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of hours\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many hours are between 2 July 2014 06:50:00 and 2 July 2014 19:00:00?\n * const result = differenceInHours(\n *   new Date(2014, 6, 2, 19, 0),\n *   new Date(2014, 6, 2, 6, 50)\n * )\n * //=> 12\n */\n\nexport default function differenceInHours(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInHour;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}","import { millisecondsInMinute } from \"../constants/index.js\";\nimport differenceInMilliseconds from \"../differenceInMilliseconds/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport { getRoundingMethod } from \"../_lib/roundingMethods/index.js\";\n/**\n * @name differenceInMinutes\n * @category Minute Helpers\n * @summary Get the number of minutes between the given dates.\n *\n * @description\n * Get the signed number of full (rounded towards 0) minutes between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of minutes\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many minutes are between 2 July 2014 12:07:59 and 2 July 2014 12:20:00?\n * const result = differenceInMinutes(\n *   new Date(2014, 6, 2, 12, 20, 0),\n *   new Date(2014, 6, 2, 12, 7, 59)\n * )\n * //=> 12\n *\n * @example\n * // How many minutes are between 10:01:59 and 10:00:00\n * const result = differenceInMinutes(\n *   new Date(2000, 0, 1, 10, 0, 0),\n *   new Date(2000, 0, 1, 10, 1, 59)\n * )\n * //=> -1\n */\n\nexport default function differenceInMinutes(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / millisecondsInMinute;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}","import toDate from \"../toDate/index.js\";\nimport endOfDay from \"../endOfDay/index.js\";\nimport endOfMonth from \"../endOfMonth/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * @param {Date|Number} date - the date to check\n * @returns {Boolean} the date is the last day of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * const result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\n\nexport default function isLastDayOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  return endOfDay(date).getTime() === endOfMonth(date).getTime();\n}","import toDate from \"../toDate/index.js\";\nimport differenceInCalendarMonths from \"../differenceInCalendarMonths/index.js\";\nimport compareAsc from \"../compareAsc/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport isLastDayOfMonth from \"../isLastDayOfMonth/index.js\";\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @description\n * Get the number of full months between the given dates using trunc as a default rounding method.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\n\nexport default function differenceInMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarMonths(dateLeft, dateRight));\n  var result; // Check for the difference of less than month\n\n  if (difference < 1) {\n    result = 0;\n  } else {\n    if (dateLeft.getMonth() === 1 && dateLeft.getDate() > 27) {\n      // This will check if the date is end of Feb and assign a higher end of month date\n      // to compare it with Jan\n      dateLeft.setDate(30);\n    }\n\n    dateLeft.setMonth(dateLeft.getMonth() - sign * difference); // Math.abs(diff in full months - diff in calendar months) === 1 if last calendar month is not full\n    // If so, result must be decreased by 1 in absolute value\n\n    var isLastMonthNotFull = compareAsc(dateLeft, dateRight) === -sign; // Check for cases of one full calendar month\n\n    if (isLastDayOfMonth(toDate(dirtyDateLeft)) && difference === 1 && compareAsc(dirtyDateLeft, dateRight) === 1) {\n      isLastMonthNotFull = false;\n    }\n\n    result = sign * (difference - Number(isLastMonthNotFull));\n  } // Prevent negative zero\n\n\n  return result === 0 ? 0 : result;\n}","import differenceInMilliseconds from \"../differenceInMilliseconds/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport { getRoundingMethod } from \"../_lib/roundingMethods/index.js\";\n/**\n * @name differenceInSeconds\n * @category Second Helpers\n * @summary Get the number of seconds between the given dates.\n *\n * @description\n * Get the number of seconds between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of seconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many seconds are between\n * // 2 July 2014 12:30:07.999 and 2 July 2014 12:30:20.000?\n * const result = differenceInSeconds(\n *   new Date(2014, 6, 2, 12, 30, 20, 0),\n *   new Date(2014, 6, 2, 12, 30, 7, 999)\n * )\n * //=> 12\n */\n\nexport default function differenceInSeconds(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / 1000;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}","import toDate from \"../toDate/index.js\";\nimport differenceInCalendarYears from \"../differenceInCalendarYears/index.js\";\nimport compareAsc from \"../compareAsc/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInYears\n * @category Year Helpers\n * @summary Get the number of full years between the given dates.\n *\n * @description\n * Get the number of full years between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full years\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full years are between 31 December 2013 and 11 February 2015?\n * const result = differenceInYears(new Date(2015, 1, 11), new Date(2013, 11, 31))\n * //=> 1\n */\n\nexport default function differenceInYears(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarYears(dateLeft, dateRight)); // Set both dates to a valid leap year for accurate comparison when dealing\n  // with leap days\n\n  dateLeft.setFullYear(1584);\n  dateRight.setFullYear(1584); // Math.abs(diff in full years - diff in calendar years) === 1 if last calendar year is not full\n  // If so, result must be decreased by 1 in absolute value\n\n  var isLastYearNotFull = compareAsc(dateLeft, dateRight) === -sign;\n  var result = sign * (difference - Number(isLastYearNotFull)); // Prevent negative zero\n\n  return result === 0 ? 0 : result;\n}","import compareAsc from \"../compareAsc/index.js\";\nimport add from \"../add/index.js\";\nimport differenceInDays from \"../differenceInDays/index.js\";\nimport differenceInHours from \"../differenceInHours/index.js\";\nimport differenceInMinutes from \"../differenceInMinutes/index.js\";\nimport differenceInMonths from \"../differenceInMonths/index.js\";\nimport differenceInSeconds from \"../differenceInSeconds/index.js\";\nimport differenceInYears from \"../differenceInYears/index.js\";\nimport toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name intervalToDuration\n * @category Common Helpers\n * @summary Convert interval to duration\n *\n * @description\n * Convert a interval object to a duration object.\n *\n * @param {Interval} interval - the interval to convert to duration\n *\n * @returns {Duration} The duration Object\n * @throws {TypeError} Requires 2 arguments\n * @throws {RangeError} `start` must not be Invalid Date\n * @throws {RangeError} `end` must not be Invalid Date\n *\n * @example\n * // Get the duration between January 15, 1929 and April 4, 1968.\n * intervalToDuration({\n *   start: new Date(1929, 0, 15, 12, 0, 0),\n *   end: new Date(1968, 3, 4, 19, 5, 0)\n * })\n * // => { years: 39, months: 2, days: 20, hours: 7, minutes: 5, seconds: 0 }\n */\n\nexport default function intervalToDuration(interval) {\n  requiredArgs(1, arguments);\n  var start = toDate(interval.start);\n  var end = toDate(interval.end);\n  if (isNaN(start.getTime())) throw new RangeError('Start Date is invalid');\n  if (isNaN(end.getTime())) throw new RangeError('End Date is invalid');\n  var duration = {};\n  duration.years = Math.abs(differenceInYears(end, start));\n  var sign = compareAsc(end, start);\n  var remainingMonths = add(start, {\n    years: sign * duration.years\n  });\n  duration.months = Math.abs(differenceInMonths(end, remainingMonths));\n  var remainingDays = add(remainingMonths, {\n    months: sign * duration.months\n  });\n  duration.days = Math.abs(differenceInDays(end, remainingDays));\n  var remainingHours = add(remainingDays, {\n    days: sign * duration.days\n  });\n  duration.hours = Math.abs(differenceInHours(end, remainingHours));\n  var remainingMinutes = add(remainingHours, {\n    hours: sign * duration.hours\n  });\n  duration.minutes = Math.abs(differenceInMinutes(end, remainingMinutes));\n  var remainingSeconds = add(remainingMinutes, {\n    minutes: sign * duration.minutes\n  });\n  duration.seconds = Math.abs(differenceInSeconds(end, remainingSeconds));\n  return duration;\n}","import { useReducer } from 'react';\nvar updateReducer = function (num) { return (num + 1) % 1000000; };\nexport default function useUpdate() {\n    var _a = useReducer(updateReducer, 0), update = _a[1];\n    return update;\n}\n","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport KeyCode from \"rc-util/es/KeyCode\";\nvar Switch = React.forwardRef(function (_ref, ref) {\n  var _classNames;\n\n  var _ref$prefixCls = _ref.prefixCls,\n      prefixCls = _ref$prefixCls === void 0 ? 'rc-switch' : _ref$prefixCls,\n      className = _ref.className,\n      checked = _ref.checked,\n      defaultChecked = _ref.defaultChecked,\n      disabled = _ref.disabled,\n      loadingIcon = _ref.loadingIcon,\n      checkedChildren = _ref.checkedChildren,\n      unCheckedChildren = _ref.unCheckedChildren,\n      onClick = _ref.onClick,\n      onChange = _ref.onChange,\n      onKeyDown = _ref.onKeyDown,\n      restProps = _objectWithoutProperties(_ref, [\"prefixCls\", \"className\", \"checked\", \"defaultChecked\", \"disabled\", \"loadingIcon\", \"checkedChildren\", \"unCheckedChildren\", \"onClick\", \"onChange\", \"onKeyDown\"]);\n\n  var _useMergedState = useMergedState(false, {\n    value: checked,\n    defaultValue: defaultChecked\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      innerChecked = _useMergedState2[0],\n      setInnerChecked = _useMergedState2[1];\n\n  function triggerChange(newChecked, event) {\n    var mergedChecked = innerChecked;\n\n    if (!disabled) {\n      mergedChecked = newChecked;\n      setInnerChecked(mergedChecked);\n      onChange === null || onChange === void 0 ? void 0 : onChange(mergedChecked, event);\n    }\n\n    return mergedChecked;\n  }\n\n  function onInternalKeyDown(e) {\n    if (e.which === KeyCode.LEFT) {\n      triggerChange(false, e);\n    } else if (e.which === KeyCode.RIGHT) {\n      triggerChange(true, e);\n    }\n\n    onKeyDown === null || onKeyDown === void 0 ? void 0 : onKeyDown(e);\n  }\n\n  function onInternalClick(e) {\n    var ret = triggerChange(!innerChecked, e); // [Legacy] trigger onClick with value\n\n    onClick === null || onClick === void 0 ? void 0 : onClick(ret, e);\n  }\n\n  var switchClassName = classNames(prefixCls, className, (_classNames = {}, _defineProperty(_classNames, \"\".concat(prefixCls, \"-checked\"), innerChecked), _defineProperty(_classNames, \"\".concat(prefixCls, \"-disabled\"), disabled), _classNames));\n  return React.createElement(\"button\", Object.assign({}, restProps, {\n    type: \"button\",\n    role: \"switch\",\n    \"aria-checked\": innerChecked,\n    disabled: disabled,\n    className: switchClassName,\n    ref: ref,\n    onKeyDown: onInternalKeyDown,\n    onClick: onInternalClick\n  }), loadingIcon, React.createElement(\"span\", {\n    className: \"\".concat(prefixCls, \"-inner\")\n  }, innerChecked ? checkedChildren : unCheckedChildren));\n});\nSwitch.displayName = 'Switch';\nexport default Switch;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport LoadingOutlined from \"@ant-design/icons/es/icons/LoadingOutlined\";\nimport classNames from 'classnames';\nimport RcSwitch from 'rc-switch';\nimport * as React from 'react';\nimport { ConfigContext } from '../config-provider';\nimport DisabledContext from '../config-provider/DisabledContext';\nimport SizeContext from '../config-provider/SizeContext';\nimport warning from '../_util/warning';\nimport Wave from '../_util/wave';\nvar Switch = /*#__PURE__*/React.forwardRef(function (_a, ref) {\n  var _classNames;\n\n  var customizePrefixCls = _a.prefixCls,\n      customizeSize = _a.size,\n      customDisabled = _a.disabled,\n      loading = _a.loading,\n      _a$className = _a.className,\n      className = _a$className === void 0 ? '' : _a$className,\n      props = __rest(_a, [\"prefixCls\", \"size\", \"disabled\", \"loading\", \"className\"]);\n\n  process.env.NODE_ENV !== \"production\" ? warning('checked' in props || !('value' in props), 'Switch', '`value` is not a valid prop, do you mean `checked`?') : void 0;\n\n  var _React$useContext = React.useContext(ConfigContext),\n      getPrefixCls = _React$useContext.getPrefixCls,\n      direction = _React$useContext.direction;\n\n  var size = React.useContext(SizeContext); // ===================== Disabled =====================\n\n  var disabled = React.useContext(DisabledContext);\n  var mergedDisabled = customDisabled || disabled || loading;\n  var prefixCls = getPrefixCls('switch', customizePrefixCls);\n  var loadingIcon = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-handle\")\n  }, loading && /*#__PURE__*/React.createElement(LoadingOutlined, {\n    className: \"\".concat(prefixCls, \"-loading-icon\")\n  }));\n  var classes = classNames((_classNames = {}, _defineProperty(_classNames, \"\".concat(prefixCls, \"-small\"), (customizeSize || size) === 'small'), _defineProperty(_classNames, \"\".concat(prefixCls, \"-loading\"), loading), _defineProperty(_classNames, \"\".concat(prefixCls, \"-rtl\"), direction === 'rtl'), _classNames), className);\n  return /*#__PURE__*/React.createElement(Wave, {\n    insertExtraNode: true\n  }, /*#__PURE__*/React.createElement(RcSwitch, _extends({}, props, {\n    prefixCls: prefixCls,\n    className: classes,\n    disabled: mergedDisabled,\n    ref: ref,\n    loadingIcon: loadingIcon\n  })));\n});\nSwitch.__ANT_SWITCH = true;\n\nif (process.env.NODE_ENV !== 'production') {\n  Switch.displayName = 'Switch';\n}\n\nexport default Switch;","export default \"data:image/svg+xml;charset=utf8,%3csvg width='200' height='200' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M20 100c0-44.183 35.817-80 80-80h80v80c0 44.183-35.817 80-80 80s-80-35.817-80-80Z' fill='%23F4F8FF'/%3e%3cpath d='M156 136h-.625v-.625H156V136Zm0 12h.625v1.509l-1.067-1.067L156 148Zm-12-12v-.625h.259l.183.183L144 136Zm27.375-40A7.375 7.375 0 0 0 164 88.625v-1.25A8.625 8.625 0 0 1 172.625 96h-1.25Zm0 32V96h1.25v32h-1.25ZM164 135.375a7.375 7.375 0 0 0 7.375-7.375h1.25a8.626 8.626 0 0 1-8.625 8.625v-1.25Zm-8 0h8v1.25h-8v-1.25Zm.625.625v12h-1.25v-12h1.25Zm-1.067 12.442-12-12 .884-.884 12 12-.884.884ZM100 135.375h44v1.25h-44v-1.25ZM92.625 128a7.375 7.375 0 0 0 7.375 7.375v1.25A8.625 8.625 0 0 1 91.375 128h1.25Zm0-32v32h-1.25V96h1.25ZM100 88.625A7.375 7.375 0 0 0 92.625 96h-1.25A8.625 8.625 0 0 1 100 87.375v1.25Zm64 0h-64v-1.25h64v1.25Z' fill='%232867CC'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 107h-40v2h40v-2Zm-8 8h-32v2h32v-2Z' fill='%232867CC'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M28 60a8 8 0 0 1 8-8h64a8 8 0 0 1 8 8v32a8 8 0 0 1-8 8H56l-12 12v-12h-8a8 8 0 0 1-8-8V60Zm26 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm14 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm17-3a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z' fill='%233381FF'/%3e%3c/svg%3e\";","export default \"data:image/svg+xml;charset=utf8,%3csvg width='200' height='200' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M20 100c0-44.183 35.817-80 80-80h80v80c0 44.183-35.817 80-80 80s-80-35.817-80-80Z' fill='%232B2F38'/%3e%3cpath d='M156 136h-.625v-.625H156V136Zm0 12h.625v1.509l-1.067-1.067L156 148Zm-12-12v-.625h.259l.183.183L144 136Zm27.375-40A7.375 7.375 0 0 0 164 88.625v-1.25A8.625 8.625 0 0 1 172.625 96h-1.25Zm0 32V96h1.25v32h-1.25ZM164 135.375a7.375 7.375 0 0 0 7.375-7.375h1.25a8.626 8.626 0 0 1-8.625 8.625v-1.25Zm-8 0h8v1.25h-8v-1.25Zm.625.625v12h-1.25v-12h1.25Zm-1.067 12.442-12-12 .884-.884 12 12-.884.884ZM100 135.375h44v1.25h-44v-1.25ZM92.625 128a7.375 7.375 0 0 0 7.375 7.375v1.25A8.625 8.625 0 0 1 91.375 128h1.25Zm0-32v32h-1.25V96h1.25ZM100 88.625A7.375 7.375 0 0 0 92.625 96h-1.25A8.625 8.625 0 0 1 100 87.375v1.25Zm64 0h-64v-1.25h64v1.25Z' fill='%232867CC'/%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M152 107h-40v2h40v-2Zm-8 8h-32v2h32v-2ZM28 60a8 8 0 0 1 8-8h64a8 8 0 0 1 8 8v32a8 8 0 0 1-8 8H56l-12 12v-12h-8a8 8 0 0 1-8-8V60Zm26 19a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm14 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm17-3a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z' fill='%232867CC'/%3e%3c/svg%3e\";","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGCamera: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <circle\n                className=\"flat-icon-stroke-color\"\n                cx=\"12\"\n                cy=\"11\"\n                r=\"7\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></circle>\n            <circle\n                className=\"flat-icon-stroke-color\"\n                cx=\"12\"\n                cy=\"11\"\n                r=\"3\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></circle>\n            <circle\n                className=\"flat-icon-fill-color\"\n                cx=\"14.625\"\n                cy=\"6.625\"\n                fill=\"#5D6066\"\n                r=\".625\"\n            ></circle>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M7 18.25a8.004 8.004 0 0 0 10 0\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGCamera;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGCameraMute: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m5 5 14 14\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-fill-color\"\n                clipRule=\"evenodd\"\n                d=\"m15.72 18.373.91.909a8.63 8.63 0 0 1-9.788-.364l-.232-.18.78-.976a7.38 7.38 0 0 0 8.33.61Zm2.434-2.87A7.625 7.625 0 0 0 7.497 4.846l.897.896a6.375 6.375 0 0 1 8.864 8.864l.896.897Zm-3.857 1.446.952.951A7.625 7.625 0 0 1 5.1 7.751l.951.952a6.375 6.375 0 0 0 8.246 8.246Zm.956-4.348a3.625 3.625 0 0 0-4.854-4.854l.964.964a2.378 2.378 0 0 1 2.926 2.926l.964.964Zm-.628-5.351a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25Z\"\n                fill=\"#5D6066\"\n                fillRule=\"evenodd\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGCameraMute;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGChatBanning: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-fill-color\"\n                clipRule=\"evenodd\"\n                d=\"M18.674 16.022A2.62 2.62 0 0 0 19.625 14V7A2.625 2.625 0 0 0 17 4.375H7.027l1.25 1.25H17c.76 0 1.375.616 1.375 1.375v7c0 .469-.235.883-.593 1.13l.892.892Zm-5.95-.647 1.25 1.25h-1.717l-2.815 2.817a.625.625 0 0 1-1.06-.347L8.375 19v-2.375H7a2.625 2.625 0 0 1-2.62-2.459L4.375 14V7.027l1.25 1.25V14c0 .76.616 1.375 1.375 1.375h2c.345 0 .625.28.625.625v1.491l1.933-1.933a.625.625 0 0 1 .344-.175l.098-.008h.723Z\"\n                fill=\"#5D6066\"\n                fillRule=\"evenodd\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m5 5 14 14\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGChatBanning;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGExit: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-fill-color\"\n                d=\"M15.625 7V6h-1.25v1h1.25ZM14 4.375H6v1.25h8v-1.25ZM4.375 6v12h1.25V6h-1.25ZM6 19.625h8v-1.25H6v1.25ZM15.625 18v-1h-1.25v1h1.25ZM14 19.625c.898 0 1.625-.727 1.625-1.625h-1.25a.375.375 0 0 1-.375.375v1.25ZM4.375 18c0 .898.728 1.625 1.625 1.625v-1.25A.375.375 0 0 1 5.625 18h-1.25ZM6 4.375c-.897 0-1.625.728-1.625 1.625h1.25c0-.207.168-.375.375-.375v-1.25ZM15.625 6c0-.897-.727-1.625-1.625-1.625v1.25c.207 0 .375.168.375.375h1.25Z\"\n                fill=\"#5D6066\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M10 12h9m-3 3 3-3-3-3\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGExit;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGHandUp: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M15.869 12.624a3 3 0 0 0-2.121 3.674\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                clipRule=\"evenodd\"\n                d=\"m17.4 17.617 2.554-7.549a.862.862 0 0 0-.385-1.023.815.815 0 0 0-1.05.202l-2.65 3.377-2.07-7.727a1 1 0 0 0-1.932.517l1.294 4.83-.966.259-1.812-6.762a1 1 0 1 0-1.932.518l1.812 6.761-.966.26-1.553-5.796A1 1 0 0 0 5.812 6l1.553 5.796-.966.259-1.035-3.864a1 1 0 1 0-1.932.518l2.588 9.659a4 4 0 0 0 4.9 2.828l3.727-.998a4 4 0 0 0 2.754-2.582Z\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGHandUp;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGMenuFold: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m16 10 2 2-2 2M6 6h12M6 18h12M6 14h8m-8-4h8\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGMenuFold;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGMenuUnfold: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m8 10-2 2 2 2m10-8H6m12 12H6m12-4h-8m8-4h-8\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGMenuUnfold;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGMicrophoneMute: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m5 5 14 14\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-fill-color\"\n                clipRule=\"evenodd\"\n                d=\"M19.277 16.625H20v-1.25h-1.973l1.25 1.25Zm-3.239 2.065.89.89a4.602 4.602 0 0 1-2.716 1.04l-.212.005h-4a4.626 4.626 0 0 1-4.55-3.787l-.033-.213H4v-1.25h2c.345 0 .625.28.625.625a3.375 3.375 0 0 0 3.19 3.37l.185.005h4a3.36 3.36 0 0 0 2.038-.685Zm.587-4.717V8a4.625 4.625 0 0 0-8.5-2.526l.911.91a3.374 3.374 0 0 1 6.281.991H14v1.25h1.375v.75H14v1.25h1.375v.75h-1.348l1.25 1.25h.098v.098l1.25 1.25Zm-2.587 2.717.89.89A4.625 4.625 0 0 1 7.375 14v-3.973l1.25 1.25v.098h.098l1.25 1.25H8.625V14a3.375 3.375 0 0 0 5.413 2.69Z\"\n                fill=\"#5D6066\"\n                fillRule=\"evenodd\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGMicrophoneMute;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGPlus: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M5 12h14m-7-7v14\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGPlus;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGRecord: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <rect\n                className=\"flat-icon-stroke-color\"\n                height=\"12\"\n                rx=\"2\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n                width=\"14\"\n                x=\"3\"\n                y=\"6\"\n            ></rect>\n            <path\n                className=\"flat-icon-stroke-color\"\n                clipRule=\"evenodd\"\n                d=\"m17 11 4-2v6l-4-2v-2Z\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M6 9h4\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGRecord;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGRecordStop: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M3 11V8a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-5\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <circle\n                className=\"flat-icon-stroke-color\"\n                cx=\"6\"\n                cy=\"15\"\n                r=\"3\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></circle>\n            <path className=\"flat-icon-fill-color\" d=\"M5 14h2v2H5z\" fill=\"#5D6066\"></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                clipRule=\"evenodd\"\n                d=\"m17 11 4-2v6l-4-2v-2Z\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M6 9h4\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGRecordStop;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGScreenSharing: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M12 17v3m-3 0h6\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-fill-color\"\n                d=\"M18.375 11v4h1.25v-4h-1.25ZM17 16.375H7v1.25h10v-1.25ZM5.625 15V8h-1.25v7h1.25ZM7 6.625h5v-1.25H7v1.25ZM5.625 8c0-.76.616-1.375 1.375-1.375v-1.25A2.625 2.625 0 0 0 4.375 8h1.25ZM7 16.375c-.76 0-1.375-.616-1.375-1.375h-1.25A2.625 2.625 0 0 0 7 17.625v-1.25ZM18.375 15c0 .76-.616 1.375-1.375 1.375v1.25A2.625 2.625 0 0 0 19.625 15h-1.25Z\"\n                fill=\"#5D6066\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m17 4 2 2-2 2\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n            <path\n                className=\"flat-icon-fill-color\"\n                d=\"M19 5.375h-3v1.25h3v-1.25ZM13.375 8v3h1.25V8h-1.25ZM16 5.375A2.625 2.625 0 0 0 13.375 8h1.25c0-.76.616-1.375 1.375-1.375v-1.25Z\"\n                fill=\"#5D6066\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGScreenSharing;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGSend: React.FC<FlatIconProps> = ({ active, className = \"\", ...restProps }) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"m15 10-5 5v5l4-4 4 3 2-15-16 9 4 1\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGSend;\n","import \"../style.less\";\nimport React from \"react\";\nimport { FlatIconProps } from \"../types\";\n\nexport const SVGUserInvite: React.FC<FlatIconProps> = ({\n    active,\n    className = \"\",\n    ...restProps\n}) => {\n    return (\n        <svg\n            className={`${className} flat-icon ${active ? \"is-active\" : \"\"}`}\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <path\n                className=\"flat-icon-fill-color\"\n                d=\"m7.265 14.925.294.552-.294-.552Zm-.03.724.324-.172-.588-1.103-.324.173.588 1.102Zm3.203-3.128.121-.242-1.118-.559-.12.242 1.117.559Zm-.813-2.935V7h-1.25v2.586h1.25ZM14.375 7v2.586h1.25V7h-1.25Zm-.934 5.28.496.99 1.118-.558-.496-.992-1.118.56Zm.934-2.694c0 .74-.294 1.449-.817 1.972l.884.884a4.04 4.04 0 0 0 1.183-2.856h-1.25ZM9.625 7A2.375 2.375 0 0 1 12 4.625v-1.25A3.625 3.625 0 0 0 8.375 7h1.25Zm.817 4.558a2.79 2.79 0 0 1-.817-1.972h-1.25c0 1.071.426 2.098 1.183 2.856l.884-.884Zm-2.883 3.919a6.793 6.793 0 0 0 2.88-2.956l-1.119-.559a5.543 5.543 0 0 1-2.349 2.412l.588 1.103ZM12 4.625A2.375 2.375 0 0 1 14.375 7h1.25A3.625 3.625 0 0 0 12 3.375v1.25ZM4.625 20a4.93 4.93 0 0 1 2.61-4.35l-.588-1.103A6.18 6.18 0 0 0 3.375 20h1.25Z\"\n                fill=\"#5D6066\"\n            ></path>\n            <path\n                className=\"flat-icon-stroke-color\"\n                d=\"M21 17h-8m4 4v-8\"\n                stroke=\"#5D6066\"\n                strokeLinejoin=\"round\"\n                strokeWidth=\"1.25\"\n            ></path>\n        </svg>\n    );\n};\n\nexport default SVGUserInvite;\n","import \"./style.less\";\nimport { SVGSend, SVGChatBanning } from \"../../FlatIcons\";\n\nimport React, { useMemo, useRef, useState } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { useSafePromise } from \"../../../utils/hooks\";\nimport { useTranslate } from \"@netless/flat-i18n\";\n\nexport interface ChatTypeBoxProps {\n    /** Only room owner can ban chatting. */\n    isCreator: boolean;\n    isBan: boolean;\n    onBanChange: () => void;\n    onMessageSend: (text: string) => Promise<void>;\n}\n\nexport const ChatTypeBox = /* @__PURE__ */ observer<ChatTypeBoxProps>(function ChatTypeBox({\n    isCreator,\n    isBan,\n    onBanChange,\n    onMessageSend,\n}) {\n    const t = useTranslate();\n    const sp = useSafePromise();\n    const inputRef = useRef<HTMLInputElement>(null);\n    const [text, updateText] = useState(\"\");\n    const [isSending, updateSending] = useState(false);\n\n    const trimmedText = useMemo(() => text.trim(), [text]);\n\n    async function sendMessage(): Promise<void> {\n        if (isSending || trimmedText.length <= 0) {\n            return;\n        }\n\n        updateSending(true);\n\n        try {\n            await sp(onMessageSend(text));\n            updateText(\"\");\n            inputRef.current?.focus();\n        } catch (e) {\n            console.warn(e);\n        }\n\n        updateSending(false);\n    }\n\n    return (\n        <div className=\"chat-typebox\">\n            {isCreator && (\n                <button className=\"chat-typebox-icon\" title={t(\"ban\")} onClick={onBanChange}>\n                    <SVGChatBanning active={isBan} />\n                </button>\n            )}\n            {!isCreator && isBan ? (\n                <span className=\"chat-typebox-ban-input\" title={t(\"all-staff-are-under-ban\")}>\n                    {t(\"all-staff-are-under-ban\")}\n                </span>\n            ) : (\n                <input\n                    ref={inputRef}\n                    className=\"chat-typebox-input\"\n                    placeholder={t(\"say-something\")}\n                    type=\"text\"\n                    value={text}\n                    onChange={e => updateText(e.currentTarget.value.slice(0, 200))}\n                    onKeyPress={e => {\n                        if (e.key === \"Enter\") {\n                            void sendMessage();\n                        }\n                    }}\n                />\n            )}\n            <button\n                className=\"chat-typebox-send\"\n                disabled={(!isCreator && isBan) || isSending || trimmedText.length <= 0}\n                title={t(\"send\")}\n                onClick={sendMessage}\n            >\n                <SVGSend />\n            </button>\n        </div>\n    );\n});\n","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nexport var DEFAULT_HEIGHT = 30;\nexport var DEFAULT_WIDTH = 100; // Enables more intelligent mapping of a given column and row index to an item ID.\n// This prevents a cell cache from being invalidated when its parent collection is modified.\n\n/**\n * Caches measurements for a given cell.\n */\nvar CellMeasurerCache =\n/*#__PURE__*/\nfunction () {\n  function CellMeasurerCache() {\n    var _this = this;\n\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, CellMeasurerCache);\n\n    _defineProperty(this, \"_cellHeightCache\", {});\n\n    _defineProperty(this, \"_cellWidthCache\", {});\n\n    _defineProperty(this, \"_columnWidthCache\", {});\n\n    _defineProperty(this, \"_rowHeightCache\", {});\n\n    _defineProperty(this, \"_defaultHeight\", void 0);\n\n    _defineProperty(this, \"_defaultWidth\", void 0);\n\n    _defineProperty(this, \"_minHeight\", void 0);\n\n    _defineProperty(this, \"_minWidth\", void 0);\n\n    _defineProperty(this, \"_keyMapper\", void 0);\n\n    _defineProperty(this, \"_hasFixedHeight\", void 0);\n\n    _defineProperty(this, \"_hasFixedWidth\", void 0);\n\n    _defineProperty(this, \"_columnCount\", 0);\n\n    _defineProperty(this, \"_rowCount\", 0);\n\n    _defineProperty(this, \"columnWidth\", function (_ref) {\n      var index = _ref.index;\n\n      var key = _this._keyMapper(0, index);\n\n      return _this._columnWidthCache[key] !== undefined ? _this._columnWidthCache[key] : _this._defaultWidth;\n    });\n\n    _defineProperty(this, \"rowHeight\", function (_ref2) {\n      var index = _ref2.index;\n\n      var key = _this._keyMapper(index, 0);\n\n      return _this._rowHeightCache[key] !== undefined ? _this._rowHeightCache[key] : _this._defaultHeight;\n    });\n\n    var defaultHeight = params.defaultHeight,\n        defaultWidth = params.defaultWidth,\n        fixedHeight = params.fixedHeight,\n        fixedWidth = params.fixedWidth,\n        keyMapper = params.keyMapper,\n        minHeight = params.minHeight,\n        minWidth = params.minWidth;\n    this._hasFixedHeight = fixedHeight === true;\n    this._hasFixedWidth = fixedWidth === true;\n    this._minHeight = minHeight || 0;\n    this._minWidth = minWidth || 0;\n    this._keyMapper = keyMapper || defaultKeyMapper;\n    this._defaultHeight = Math.max(this._minHeight, typeof defaultHeight === 'number' ? defaultHeight : DEFAULT_HEIGHT);\n    this._defaultWidth = Math.max(this._minWidth, typeof defaultWidth === 'number' ? defaultWidth : DEFAULT_WIDTH);\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (this._hasFixedHeight === false && this._hasFixedWidth === false) {\n        console.warn(\"CellMeasurerCache should only measure a cell's width or height. \" + 'You have configured CellMeasurerCache to measure both. ' + 'This will result in poor performance.');\n      }\n\n      if (this._hasFixedHeight === false && this._defaultHeight === 0) {\n        console.warn('Fixed height CellMeasurerCache should specify a :defaultHeight greater than 0. ' + 'Failing to do so will lead to unnecessary layout and poor performance.');\n      }\n\n      if (this._hasFixedWidth === false && this._defaultWidth === 0) {\n        console.warn('Fixed width CellMeasurerCache should specify a :defaultWidth greater than 0. ' + 'Failing to do so will lead to unnecessary layout and poor performance.');\n      }\n    }\n  }\n\n  _createClass(CellMeasurerCache, [{\n    key: \"clear\",\n    value: function clear(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var key = this._keyMapper(rowIndex, columnIndex);\n\n      delete this._cellHeightCache[key];\n      delete this._cellWidthCache[key];\n\n      this._updateCachedColumnAndRowSizes(rowIndex, columnIndex);\n    }\n  }, {\n    key: \"clearAll\",\n    value: function clearAll() {\n      this._cellHeightCache = {};\n      this._cellWidthCache = {};\n      this._columnWidthCache = {};\n      this._rowHeightCache = {};\n      this._rowCount = 0;\n      this._columnCount = 0;\n    }\n  }, {\n    key: \"hasFixedHeight\",\n    value: function hasFixedHeight() {\n      return this._hasFixedHeight;\n    }\n  }, {\n    key: \"hasFixedWidth\",\n    value: function hasFixedWidth() {\n      return this._hasFixedWidth;\n    }\n  }, {\n    key: \"getHeight\",\n    value: function getHeight(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      if (this._hasFixedHeight) {\n        return this._defaultHeight;\n      } else {\n        var _key = this._keyMapper(rowIndex, columnIndex);\n\n        return this._cellHeightCache[_key] !== undefined ? Math.max(this._minHeight, this._cellHeightCache[_key]) : this._defaultHeight;\n      }\n    }\n  }, {\n    key: \"getWidth\",\n    value: function getWidth(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      if (this._hasFixedWidth) {\n        return this._defaultWidth;\n      } else {\n        var _key2 = this._keyMapper(rowIndex, columnIndex);\n\n        return this._cellWidthCache[_key2] !== undefined ? Math.max(this._minWidth, this._cellWidthCache[_key2]) : this._defaultWidth;\n      }\n    }\n  }, {\n    key: \"has\",\n    value: function has(rowIndex) {\n      var columnIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var key = this._keyMapper(rowIndex, columnIndex);\n\n      return this._cellHeightCache[key] !== undefined;\n    }\n  }, {\n    key: \"set\",\n    value: function set(rowIndex, columnIndex, width, height) {\n      var key = this._keyMapper(rowIndex, columnIndex);\n\n      if (columnIndex >= this._columnCount) {\n        this._columnCount = columnIndex + 1;\n      }\n\n      if (rowIndex >= this._rowCount) {\n        this._rowCount = rowIndex + 1;\n      } // Size is cached per cell so we don't have to re-measure if cells are re-ordered.\n\n\n      this._cellHeightCache[key] = height;\n      this._cellWidthCache[key] = width;\n\n      this._updateCachedColumnAndRowSizes(rowIndex, columnIndex);\n    }\n  }, {\n    key: \"_updateCachedColumnAndRowSizes\",\n    value: function _updateCachedColumnAndRowSizes(rowIndex, columnIndex) {\n      // :columnWidth and :rowHeight are derived based on all cells in a column/row.\n      // Pre-cache these derived values for faster lookup later.\n      // Reads are expected to occur more frequently than writes in this case.\n      // Only update non-fixed dimensions though to avoid doing unnecessary work.\n      if (!this._hasFixedWidth) {\n        var columnWidth = 0;\n\n        for (var i = 0; i < this._rowCount; i++) {\n          columnWidth = Math.max(columnWidth, this.getWidth(i, columnIndex));\n        }\n\n        var columnKey = this._keyMapper(0, columnIndex);\n\n        this._columnWidthCache[columnKey] = columnWidth;\n      }\n\n      if (!this._hasFixedHeight) {\n        var rowHeight = 0;\n\n        for (var _i = 0; _i < this._columnCount; _i++) {\n          rowHeight = Math.max(rowHeight, this.getHeight(rowIndex, _i));\n        }\n\n        var rowKey = this._keyMapper(rowIndex, 0);\n\n        this._rowHeightCache[rowKey] = rowHeight;\n      }\n    }\n  }, {\n    key: \"defaultHeight\",\n    get: function get() {\n      return this._defaultHeight;\n    }\n  }, {\n    key: \"defaultWidth\",\n    get: function get() {\n      return this._defaultWidth;\n    }\n  }]);\n\n  return CellMeasurerCache;\n}();\n\nexport { CellMeasurerCache as default };\n\nfunction defaultKeyMapper(rowIndex, columnIndex) {\n  return \"\".concat(rowIndex, \"-\").concat(columnIndex);\n}\n\nimport { bpfrpt_proptype_CellMeasureCache } from \"./types\";","import \"./style.less\";\n\nimport React, { useEffect } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { format } from \"date-fns\";\nimport { ChatMsg } from \"../types\";\n\nexport interface ChatMessageProps {\n    /** current user uuid */\n    userUUID: string;\n    messageUser?: { name: string; avatar: string };\n    message: ChatMsg;\n    onMount: () => void;\n    openCloudStorage?: () => void;\n}\n\nexport const ChatMessage = /* @__PURE__ */ observer<ChatMessageProps>(function ChatMessage({\n    userUUID,\n    messageUser,\n    message,\n    onMount,\n    openCloudStorage,\n}) {\n    const t = useTranslate();\n    useEffect(() => {\n        onMount();\n        // run only once\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    switch (message.type) {\n        case \"notice\": {\n            return (\n                <div className=\"chat-message-line\">\n                    <div className=\"chat-message-notice\">{message.text}</div>\n                </div>\n            );\n        }\n        case \"ban\": {\n            return (\n                <div className=\"chat-message-line\">\n                    <div className=\"chat-message-ban\">\n                        <span>{message.status ? t(\"banned\") : t(\"unban\")}</span>\n                    </div>\n                </div>\n            );\n        }\n        case \"user-guide\": {\n            return (\n                <div className=\"chat-message-line\">\n                    <div className=\"chat-message-user-guide-bubble\">\n                        <pre>\n                            {t(\"user-guide-text\")}\n                            <span\n                                className=\"chat-message-user-guide-btn\"\n                                onClick={openCloudStorage}\n                            >\n                                {t(\"user-guide-button\")}\n                            </span>\n                        </pre>\n                    </div>\n                </div>\n            );\n        }\n        default: {\n            break;\n        }\n    }\n\n    const time = new Date(message.timestamp);\n    const fullTimeString = format(time, \"yyyy-MM-dd HH:mm\");\n    const [dateString, timeString] = fullTimeString.split(\" \");\n    const dateToday = format(new Date(), \"yyyy-MM-dd\");\n    const finalTimeString = dateString === dateToday ? timeString : fullTimeString;\n\n    if (userUUID === message.senderID) {\n        return (\n            <div className=\"chat-message-line is-reverse\">\n                <div className=\"chat-message-avatar\">\n                    <span className=\"chat-message-user-avatar\">\n                        <img alt=\"[avatar]\" src={messageUser?.avatar} />\n                    </span>\n                </div>\n                <div className=\"chat-message-user-bubble\">\n                    <div className=\"chat-message-user\">\n                        <span className=\"chat-message-user-name\">\n                            {messageUser?.name || message.senderID}\n                        </span>\n                        <time\n                            className=\"chat-message-user-time\"\n                            dateTime={time.toISOString()}\n                            title={time.toLocaleString()}\n                        >\n                            {finalTimeString}\n                        </time>\n                    </div>\n                    <div className=\"chat-message-bubble is-self\">\n                        <pre>{message.text}</pre>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"chat-message-line\">\n            <div className=\"chat-message-avatar\">\n                <span className=\"chat-message-user-avatar\">\n                    <img alt=\"[avatar]\" src={messageUser?.avatar} />\n                </span>\n            </div>\n            <div className=\"chat-message-user-bubble\">\n                <div className=\"chat-message-user\">\n                    <span className=\"chat-message-user-name\">\n                        {messageUser?.name || message.senderID}\n                    </span>\n                    <time\n                        className=\"chat-message-user-time\"\n                        dateTime={time.toISOString()}\n                        title={time.toLocaleString()}\n                    >\n                        {finalTimeString}\n                    </time>\n                </div>\n                <div className=\"chat-message-bubble\">\n                    <pre>{message.text}</pre>\n                </div>\n            </div>\n        </div>\n    );\n});\n","import React, { useEffect, useRef, useState } from \"react\";\nimport { useUpdate } from \"react-use\";\nimport { Observer, observer } from \"mobx-react-lite\";\nimport {\n    AutoSizer,\n    CellMeasurer,\n    CellMeasurerCache,\n    Index,\n    InfiniteLoader,\n    InfiniteLoaderProps,\n    List,\n    ListRowRenderer,\n} from \"react-virtualized\";\nimport { User } from \"../../../types/user\";\nimport { useReaction } from \"../../../utils/hooks\";\nimport { ChatMessage } from \"../ChatMessage\";\nimport { ChatMsg } from \"../types\";\n\nexport interface ChatMessageListProps {\n    visible: boolean;\n    userUUID: string;\n    messages: ChatMsg[];\n    getUserByUUID: (uuid: string) => User | undefined;\n    loadMoreRows: InfiniteLoaderProps[\"loadMoreRows\"];\n    openCloudStorage: () => void;\n}\n\nexport const ChatMessageList = /* @__PURE__ */ observer<ChatMessageListProps>(\n    function ChatMessageList({\n        visible,\n        userUUID,\n        messages,\n        getUserByUUID,\n        loadMoreRows,\n        openCloudStorage,\n    }) {\n        const forceUpdate = useUpdate();\n\n        const [scrollToIndex, setScrollToIndex] = useState<number | undefined>(messages.length - 1);\n\n        const [cellCache] = useState(\n            () =>\n                new CellMeasurerCache({\n                    defaultHeight: 72,\n                    fixedWidth: true,\n                    keyMapper: index => messages[index].uuid,\n                }),\n        );\n\n        useEffect(() => {\n            // re-measure cell when tab panel is visible\n            if (visible) {\n                cellCache.clearAll();\n                forceUpdate();\n                setScrollToIndex(messages.length - 1);\n            }\n            // only listen to visible\n            // eslint-disable-next-line react-hooks/exhaustive-deps\n        }, [visible]);\n\n        /**\n         * The scrollToIndex is causing scroll jumping in random situation.\n         * Clear it after it is applied.\n         */\n        useEffect(() => {\n            if (scrollToIndex !== void 0) {\n                // wait one loop after rendering complete\n                const ticket = window.setTimeout(() => {\n                    setScrollToIndex(void 0);\n                }, 0);\n                return () => {\n                    window.clearTimeout(ticket);\n                };\n            }\n            return;\n        }, [scrollToIndex]);\n\n        useReaction(\n            () => ({\n                messageCount: messages.length,\n                latestMessage: messages.length > 0 ? messages[messages.length - 1] : null,\n            }),\n            ({ messageCount, latestMessage }, prev) => {\n                if (messageCount > prev.messageCount) {\n                    // more messages are loaded\n                    if (\n                        !prev.latestMessage ||\n                        latestMessage!.timestamp > prev.latestMessage.timestamp\n                    ) {\n                        // user sent a new message\n                        // scroll to the bottom\n                        setScrollToIndex(messageCount - 1);\n                    } else {\n                        // history messages loaded\n                        // stay at the last position\n                        setScrollToIndex(messageCount - prev.messageCount);\n                    }\n                }\n            },\n        );\n\n        const isFirstLoadRef = useRef(true);\n\n        const isRowLoaded = ({ index }: Index): boolean => {\n            // load more when scroll to top\n            const loaded = index > 0;\n            if (isFirstLoadRef.current) {\n                // skip extra first loading\n                isFirstLoadRef.current = false;\n                return true;\n            }\n            return loaded;\n        };\n\n        const rowRenderer: ListRowRenderer = ({ index, parent, style }) => (\n            <CellMeasurer\n                key={messages[index].uuid}\n                cache={cellCache}\n                columnIndex={0}\n                parent={parent}\n                rowIndex={index}\n            >\n                {({ measure, registerChild }) => {\n                    return (\n                        <div ref={el => el && registerChild && registerChild(el)} style={style}>\n                            <Observer>\n                                {() => (\n                                    <ChatMessage\n                                        message={messages[index]}\n                                        messageUser={getUserByUUID(messages[index].senderID)}\n                                        openCloudStorage={openCloudStorage}\n                                        userUUID={userUUID}\n                                        onMount={measure}\n                                    />\n                                )}\n                            </Observer>\n                        </div>\n                    );\n                }}\n            </CellMeasurer>\n        );\n\n        return (\n            <InfiniteLoader\n                isRowLoaded={isRowLoaded}\n                loadMoreRows={loadMoreRows}\n                rowCount={messages.length}\n                threshold={1}\n            >\n                {({ onRowsRendered, registerChild }) => (\n                    <AutoSizer>\n                        {({ height, width }) => (\n                            <Observer>\n                                {() => (\n                                    <List\n                                        ref={registerChild}\n                                        className=\"fancy-scrollbar\"\n                                        height={height}\n                                        rowCount={messages.length}\n                                        rowHeight={cellCache.rowHeight}\n                                        rowRenderer={rowRenderer}\n                                        scrollToAlignment=\"start\"\n                                        scrollToIndex={scrollToIndex}\n                                        width={width}\n                                        onRowsRendered={onRowsRendered}\n                                    />\n                                )}\n                            </Observer>\n                        )}\n                    </AutoSizer>\n                )}\n            </InfiniteLoader>\n        );\n    },\n);\n","import \"./style.less\";\nimport chatMessagesDefaultSVG from \"./icons/chat-messages-default.svg\";\nimport chatMessagesDefaultDarkSVG from \"./icons/chat-messages-default-dark.svg\";\n\nimport React, { useContext } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { ChatTypeBox, ChatTypeBoxProps } from \"../ChatTypeBox\";\nimport { ChatMessageList, ChatMessageListProps } from \"../ChatMessageList\";\nimport { DarkModeContext } from \"../../FlatThemeProvider\";\n\nexport type ChatMessagesProps = ChatTypeBoxProps & ChatMessageListProps;\n\nexport const ChatMessages = /* @__PURE__ */ observer<ChatMessagesProps>(function ChatMessages({\n    messages,\n    ...restProps\n}) {\n    const isDark = useContext(DarkModeContext);\n\n    return (\n        <div className=\"chat-messages-wrap\">\n            <div className=\"chat-messages\">\n                {messages.length > 0 ? (\n                    <div className=\"chat-messages-box\">\n                        <ChatMessageList messages={messages} {...restProps} />\n                    </div>\n                ) : (\n                    <div className=\"chat-messages-default\">\n                        <img src={isDark ? chatMessagesDefaultDarkSVG : chatMessagesDefaultSVG} />\n                    </div>\n                )}\n            </div>\n            <ChatTypeBox {...restProps} />\n        </div>\n    );\n});\n","import \"./style.less\";\n\nimport React, { FC, useMemo } from \"react\";\nimport classNames from \"classnames\";\n\nexport interface ChatTabTitleProps {\n    unreadCount?: number | null;\n}\n\nfunction isInteger(n: unknown): n is number {\n    return Number.isSafeInteger(n);\n}\n\nexport const ChatTabTitle: FC<ChatTabTitleProps> = ({ unreadCount, children }) => {\n    const count = useMemo(\n        () =>\n            isInteger(unreadCount) && (\n                <span\n                    className={classNames(\"chat-tab-red-dot\", {\n                        \"is-large\": unreadCount > 99,\n                    })}\n                >\n                    {unreadCount < 100 ? unreadCount : \"99+\"}\n                </span>\n            ),\n        [unreadCount],\n    );\n\n    return (\n        <span className=\"chat-tab-title\">\n            {children}\n            {count}\n        </span>\n    );\n};\n","import \"./style.less\";\n\nimport React from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { ChatMessages, ChatMessagesProps } from \"./ChatMessages\";\nimport { ChatTabTitle, ChatTabTitleProps } from \"./ChatTabTitle\";\n\nexport type ChatPanelProps = {\n    totalUserCount?: number;\n    onClickTotalUsersCount?: () => void;\n} & ChatTabTitleProps &\n    Omit<ChatMessagesProps, \"visible\">;\n\nexport const ChatPanel = /* @__PURE__ */ observer<ChatPanelProps>(function ChatPanel(props) {\n    const t = useTranslate();\n\n    return (\n        <div className=\"chat-panel\">\n            <div className=\"chat-panel-header\">\n                <ChatTabTitle>\n                    <span>{t(\"messages\")}</span>\n                </ChatTabTitle>\n                {props.totalUserCount && (\n                    <span className=\"chat-tab-subtitle\" onClick={props.onClickTotalUsersCount}>\n                        {t(\"total-users-count\", { count: props.totalUserCount })}\n                    </span>\n                )}\n            </div>\n            <ChatMessages {...props} visible />\n        </div>\n    );\n});\n\nexport { ChatMessage } from \"./ChatMessage\";\n\nexport * from \"./types\";\n","import React, { FC } from \"react\";\nimport { Button, Modal } from \"antd\";\nimport { useTranslate } from \"@netless/flat-i18n\";\n\nexport interface StopClassConfirmModalProps {\n    visible: boolean;\n    loading: boolean;\n    onStop: () => void;\n    onCancel: () => void;\n}\n\n/**\n * When room creator presses the the Stop Class button.\n * [cancel] [stop]\n */\nexport const StopClassConfirmModal: FC<StopClassConfirmModalProps> = ({\n    visible,\n    loading,\n    onStop,\n    onCancel,\n}) => {\n    const t = useTranslate();\n    return (\n        <Modal\n            okButtonProps={{ loading }}\n            open={visible}\n            title={t(\"confirmation-of-the-end-of-classes\")}\n            onCancel={onCancel}\n            onOk={onStop}\n        >\n            <p>{t(\"end-of-class-tips\")}</p>\n        </Modal>\n    );\n};\n\nexport interface CloseRoomConfirmModalProps {\n    visible: boolean;\n    hangLoading: boolean;\n    stopLoading: boolean;\n    onHang: () => void;\n    onStop: () => void;\n    onCancel: () => void;\n}\n\n/**\n * When room creator presses the exit button.\n * [cancel] [hang] [stop]\n */\nexport const CloseRoomConfirmModal: FC<CloseRoomConfirmModalProps> = ({\n    visible,\n    hangLoading,\n    stopLoading,\n    onHang,\n    onStop,\n    onCancel,\n}) => {\n    const t = useTranslate();\n    return (\n        <Modal\n            footer={[\n                <Button key=\"Cancel\" onClick={onCancel}>\n                    {t(\"cancel\")}\n                </Button>,\n                <Button key=\"ReturnMain\" loading={hangLoading} onClick={onHang}>\n                    {t(\"hang-up-the-room\")}\n                </Button>,\n                <Button key=\"StopClass\" loading={stopLoading} type=\"primary\" onClick={onStop}>\n                    {t(\"end-the-class\")}\n                </Button>,\n            ]}\n            open={visible}\n            title={t(\"close-option\")}\n            onCancel={onCancel}\n            onOk={onCancel}\n        >\n            <p>{t(\"exit-room-tips\")}</p>\n        </Modal>\n    );\n};\n\nexport interface ExitRoomConfirmModalProps {\n    visible: boolean;\n    onExit: () => void;\n    onCancel: () => void;\n}\n\n/**\n * When joiner presses exit room button.\n * [cancel] [ok]\n */\nexport const ExitRoomConfirmModal: FC<ExitRoomConfirmModalProps> = ({\n    visible,\n    onExit,\n    onCancel,\n}) => {\n    const t = useTranslate();\n    return (\n        <Modal\n            open={visible}\n            title={t(\"student-sure-to-exit-the-room\")}\n            onCancel={onCancel}\n            onOk={onExit}\n        >\n            <p>{t(\"student-exit-room-tip\")}</p>\n        </Modal>\n    );\n};\n","export default \"data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cpath d='M0 10h2v4H0zm6-4v8H4V6h2zm4-4v12H8V2h2z' fill='%23d0d1d1' fill-rule='evenodd'/%3e%3c/svg%3e\";","export default \"data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cg fill='none' fill-rule='evenodd'%3e%3cpath fill='%23FF9393' d='M0 10h2v4H0z'/%3e%3cpath fill='%23FFD4D4' d='M6 6v8H4V6h2zm4-4v12H8V2h2z'/%3e%3c/g%3e%3c/svg%3e\";","export default \"data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cg fill='none' fill-rule='evenodd'%3e%3cpath fill='%23FFF3D1' d='M8 2h2v12H8z'/%3e%3cpath fill='%23FFE08D' d='M2 10v4H0v-4h2zm4-4v8H4V6h2z'/%3e%3c/g%3e%3c/svg%3e\";","export default \"data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 18'%3e%3cpath fill='%239FDF76' fill-rule='evenodd' d='M2 10v4H0v-4h2zm4-4v8H4V6h2zm4-4v12H8V2h2z'/%3e%3c/svg%3e\";","import \"./style.less\";\nimport signal0SVG from \"./icons/signal-0.svg\";\nimport signal1SVG from \"./icons/signal-1.svg\";\nimport signal2SVG from \"./icons/signal-2.svg\";\nimport signal3SVG from \"./icons/signal-3.svg\";\n\nimport React, { useMemo } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\n\ninterface NetworkQuality {\n    delay: number;\n    uplink: number;\n    downlink: number;\n}\n\nfunction getSignalIcon(uplink: number, downlink: number): string {\n    if (uplink === 5 || downlink === 5 || uplink === 4 || downlink === 4) {\n        return signal1SVG;\n    }\n    if (uplink === 3 || downlink === 3) {\n        return signal2SVG;\n    }\n    if (uplink === 2 || downlink === 2 || uplink === 1 || downlink === 1) {\n        return signal3SVG;\n    }\n    if (uplink === 8 || downlink === 8) {\n        // checking\n        return signal3SVG;\n    }\n    return signal0SVG;\n}\n\nexport interface NetworkStatusProps {\n    networkQuality: NetworkQuality;\n}\n\nexport const NetworkStatus = /* @__PURE__ */ observer<NetworkStatusProps>(function NetworkStatus({\n    networkQuality,\n}) {\n    const t = useTranslate();\n    const { uplink, downlink } = networkQuality;\n\n    const signalIcon = useMemo(() => getSignalIcon(uplink, downlink), [uplink, downlink]);\n\n    const signalText = useMemo(\n        () =>\n            t(\"network-quality\", {\n                uplink: t(`network-quality${uplink}`),\n                downlink: t(`network-quality${downlink}`),\n            }),\n        [t, uplink, downlink],\n    );\n\n    return (\n        <div className=\"network-status\">\n            <span\n                className=\"network-status-delay\"\n                title={t(\"client-to-edge-server-network-latency\")}\n            >\n                {t(\"delay\")}\n                <span className=\"network-status-delay-ms\">{networkQuality.delay}ms</span>\n            </span>\n            <span className=\"network-status-signal\" title={signalText}>\n                {t(\"network\")}\n                <img alt={signalText} src={signalIcon} />\n            </span>\n        </div>\n    );\n});\n","import \"./style.less\";\n\nimport classNames from \"classnames\";\nimport React, { ReactElement, ButtonHTMLAttributes, FC } from \"react\";\n\nexport interface TopBarRightBtnProps extends ButtonHTMLAttributes<HTMLButtonElement> {\n    icon?: ReactElement;\n}\n\nexport const TopBarRightBtn: FC<TopBarRightBtnProps> = ({\n    title,\n    icon,\n    disabled,\n    className,\n    ...restProps\n}) => (\n    <button\n        {...restProps}\n        className={classNames(\"topbar-right-btn\", className)}\n        disabled={disabled}\n        title={title}\n    >\n        {icon}\n    </button>\n);\n","import \"./style.less\";\n\nimport classNames from \"classnames\";\nimport React, { FC } from \"react\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { RoomStatus, RoomType } from \"../../../types/room\";\nimport { roomStatusToI18nKey } from \"../../../utils/room\";\n\nexport interface RoomInfoProps {\n    roomStatus: RoomStatus;\n    roomType?: RoomType;\n}\n\nexport const RoomInfo: FC<RoomInfoProps> = ({ roomStatus, roomType }) => {\n    const t = useTranslate();\n    return (\n        <div className=\"room-info\">\n            <span>\n                {t(\"current-status\")}\n                <span\n                    className={classNames(\"room-info-progress\", {\n                        \"is-active\": roomStatus !== RoomStatus.Idle,\n                    })}\n                >\n                    {t(`room-status.${roomStatusToI18nKey(roomStatus)}`)}\n                </span>\n            </span>\n            <span>\n                {t(\"current-mode\")}\n                <span className=\"room-info-mode\">\n                    {t(`class-room-type.${roomType || RoomType.BigClass}`)}\n                </span>\n            </span>\n        </div>\n    );\n};\n","import { FC, useEffect, useRef, useState } from \"react\";\nimport { Modal } from \"antd\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { RoomStatus } from \"../../../types/room\";\n\nexport interface RoomStoppedModalProps {\n    isCreator: boolean;\n    isRemoteLogin: boolean;\n    roomStatus: RoomStatus;\n    onExit: () => void;\n}\n\n/**\n * Show an info modal on joiner side when room status becomes stopped.\n *\n * **Note**: be sure to use `useCallback` when passing the `onExit` prop.\n */\nexport const RoomStoppedModal: FC<RoomStoppedModalProps> = ({\n    isCreator,\n    isRemoteLogin,\n    roomStatus,\n    onExit,\n}) => {\n    const modalRef = useRef<ReturnType<typeof Modal.info>>();\n    const [visible, setVisible] = useState(false);\n    const t = useTranslate();\n\n    useEffect(() => {\n        if (isRemoteLogin) {\n            setVisible(true);\n        }\n    }, [isRemoteLogin]);\n\n    useEffect(() => {\n        if (roomStatus === RoomStatus.Stopped) {\n            if (isCreator) {\n                onExit();\n            } else {\n                setVisible(true);\n            }\n        }\n    }, [roomStatus, isCreator, onExit]);\n\n    useEffect(() => {\n        let ticket: number | undefined;\n\n        if (visible) {\n            let countdown = 5;\n\n            modalRef.current = Modal.info({\n                title: isRemoteLogin\n                    ? t(\"you-have-entered-the-room-at-another-device\")\n                    : t(\"the-room-has-ended-and-is-about-to-exit\"),\n                okText: t(\"got-it-countdown\", { countdown }),\n                onOk: onExit,\n                onCancel: onExit,\n            });\n\n            ticket = window.setInterval(() => {\n                modalRef.current?.update({\n                    okText: t(\"got-it-countdown\", { countdown: --countdown }),\n                });\n                if (countdown <= 0) {\n                    window.clearInterval(ticket);\n                    onExit();\n                }\n            }, 1000);\n        }\n\n        return () => {\n            window.clearInterval(ticket);\n            modalRef.current?.destroy();\n        };\n    }, [visible, onExit, t, isRemoteLogin]);\n\n    return null;\n};\n","import React, { useEffect, useState } from \"react\";\n\nexport interface IconMicProps\n    extends Pick<React.SVGProps<SVGSVGElement>, \"className\" | \"style\" | \"width\" | \"height\"> {\n    /** 0~1 */\n    getVolumeLevel?: () => number;\n    /** 0~1 */\n    noise?: number;\n}\n\nexport const IconMic = /* @__PURE__ */ React.memo<IconMicProps>(function IconMic({\n    getVolumeLevel,\n    noise = 0.075,\n    ...restProps\n}) {\n    noise = Math.max(0, Math.min(1, noise));\n\n    const vHeight = 14;\n    const vWidth = 8;\n    const vBaseX = 8;\n    const vBaseY = 4;\n\n    const [baseVolumeLevel, setBaseVolumeLevel] = useState(0);\n    const [volumeLevel, setVolumeLevel] = useState(0);\n\n    useEffect(() => {\n        if (!getVolumeLevel) {\n            setBaseVolumeLevel(0);\n            return;\n        }\n\n        const safeSetVolumeLevel = (): void => {\n            setBaseVolumeLevel(Math.max(0, Math.min(1, getVolumeLevel())));\n        };\n\n        safeSetVolumeLevel();\n        const ticket = setInterval(safeSetVolumeLevel, 500);\n\n        return () => clearInterval(ticket);\n    }, [getVolumeLevel]);\n\n    useEffect(() => {\n        if (!baseVolumeLevel) {\n            return;\n        }\n\n        const ticket = setInterval(() => {\n            setVolumeLevel(\n                baseVolumeLevel + Math.random() * noise * (Math.random() > 0.5 ? 1 : -1),\n            );\n        }, 50);\n\n        return () => clearInterval(ticket);\n    }, [baseVolumeLevel, noise]);\n\n    return (\n        <svg\n            fill=\"none\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            width=\"24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            {...restProps}\n        >\n            <defs>\n                <clipPath id=\"icon-mic-v-clip\">\n                    <rect height={vHeight} rx={vWidth / 2} width={vWidth} x={vBaseX} y={vBaseY} />\n                </clipPath>\n            </defs>\n            <path d=\"M0 0h24v24H0z\" fill=\"#999CA3\" opacity=\".01\" />\n            <rect\n                clipPath=\"url(#icon-mic-v-clip)\"\n                fill=\"#fff\"\n                height={vHeight}\n                width={vWidth}\n                x={vBaseX}\n                y={vBaseY}\n            />\n            <path\n                d=\"M4 16.625h2v-1.25H4v1.25Zm6 4h4v-1.25h-4v1.25Zm8-4h2v-1.25h-2v1.25Zm-4 4A4.625 4.625 0 0 0 18.625 16h-1.25A3.375 3.375 0 0 1 14 19.375v1.25ZM5.375 16A4.625 4.625 0 0 0 10 20.625v-1.25A3.375 3.375 0 0 1 6.625 16h-1.25Z\"\n                fill=\"#fff\"\n            />\n            <g clipPath=\"url(#icon-mic-v-clip)\">\n                <rect\n                    fill=\"#44AD00\"\n                    height={vHeight * 2}\n                    style={{\n                        transform: `translateY(${(1 - volumeLevel) * vHeight}px)`,\n                        transition: \"transform .1s\",\n                    }}\n                    width={vWidth}\n                    x={vBaseX}\n                    y={vBaseY}\n                />\n            </g>\n        </svg>\n    );\n});\n","import \"./style.less\";\n\nimport React from \"react\";\nimport classnames from \"classnames\";\nimport { createPortal } from \"react-dom\";\nimport { IconMic } from \"./IconMic\";\nimport { SVGCamera, SVGCameraMute, SVGMicrophoneMute } from \"../../FlatIcons\";\n\nexport interface VideoAvatarUser {\n    name: string;\n    userUUID: string;\n    camera: boolean;\n    mic: boolean;\n    avatar: string;\n}\n\nexport interface VideoAvatarProps {\n    small?: boolean;\n    /** Avatar user UUID */\n    avatarUser: VideoAvatarUser;\n    /** Is current user room creator */\n    isCreator: boolean;\n    /** Current user UUID */\n    userUUID: string;\n    updateDeviceState(id: string, camera: boolean, mic: boolean): void;\n    getVolumeLevel?: () => number;\n\n    portal?: HTMLElement;\n    onDoubleClick?: () => void;\n    onDragStart?: () => void;\n    onDragEnd?: () => void;\n    isDropTarget?: boolean;\n}\n\nexport const VideoAvatar: React.FC<VideoAvatarProps> = ({\n    portal,\n    small,\n    avatarUser,\n    isCreator,\n    isDropTarget,\n    userUUID,\n    updateDeviceState,\n    getVolumeLevel,\n    onDoubleClick,\n    onDragStart,\n    onDragEnd,\n    children,\n}) => {\n    const isCameraCtrlDisable = !isCreator && avatarUser.userUUID !== userUUID;\n\n    const isMicCtrlDisable = !isCreator && avatarUser.userUUID !== userUUID;\n\n    const onDragStartImpl = (ev: React.DragEvent<HTMLDivElement>): void => {\n        const rect = ev.currentTarget.getBoundingClientRect();\n        const x = (ev.clientX - rect.left) / rect.width;\n        const y = (ev.clientY - rect.top) / rect.height;\n        ev.dataTransfer.setData(\"video-avatar\", JSON.stringify([avatarUser.userUUID, x, y]));\n        ev.dataTransfer.effectAllowed = \"move\";\n        onDragStart && onDragStart();\n    };\n\n    const view = (\n        <div\n            className={classnames(\"video-avatar\", {\n                \"is-small\": small && !portal,\n                \"is-drop-target\": isDropTarget,\n            })}\n            data-user-uuid={avatarUser.userUUID}\n            draggable={isCreator && !portal}\n            onDoubleClick={portal ? undefined : onDoubleClick}\n            onDragEnd={onDragEnd}\n            onDragStart={onDragStartImpl}\n        >\n            <div className=\"video-avatar-video\">{children}</div>\n            {(!children || !avatarUser.camera) && (\n                <div className=\"video-avatar-image-container\">\n                    <div\n                        className=\"video-avatar-image-blur-bg\"\n                        style={{ backgroundImage: `url(${avatarUser.avatar})` }}\n                    />\n                    <img\n                        alt={avatarUser.name}\n                        className=\"video-avatar-image\"\n                        draggable={false}\n                        src={avatarUser.avatar}\n                    />\n                </div>\n            )}\n            <div className=\"video-avatar-bottom\">\n                <h1 className=\"video-avatar-user-name\" title={avatarUser.name}>\n                    {avatarUser.name}\n                </h1>\n                <div\n                    className={classnames(\"video-avatar-media-ctrl\", {\n                        \"is-portal\": portal,\n                    })}\n                >\n                    <button\n                        className={classnames(\"video-avatar-media-ctrl-btn\", {\n                            \"is-muted\": !avatarUser.camera,\n                        })}\n                        disabled={isCameraCtrlDisable}\n                        onClick={() => {\n                            if (isCreator || userUUID === avatarUser.userUUID) {\n                                updateDeviceState(\n                                    avatarUser.userUUID,\n                                    !avatarUser.camera,\n                                    avatarUser.mic,\n                                );\n                            }\n                        }}\n                    >\n                        {avatarUser.camera ? <SVGCamera /> : <SVGCameraMute />}\n                    </button>\n                    <button\n                        className={classnames(\"video-avatar-media-ctrl-btn\", {\n                            \"is-muted\": !avatarUser.mic,\n                        })}\n                        disabled={isMicCtrlDisable}\n                        onClick={() => {\n                            if (isCreator || userUUID === avatarUser.userUUID) {\n                                updateDeviceState(\n                                    avatarUser.userUUID,\n                                    avatarUser.camera,\n                                    !avatarUser.mic,\n                                );\n                            }\n                        }}\n                    >\n                        {avatarUser.mic ? (\n                            <IconMic getVolumeLevel={getVolumeLevel} />\n                        ) : (\n                            <SVGMicrophoneMute />\n                        )}\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n\n    return portal ? (\n        <div\n            className={classnames(\"video-avatar\", \"video-avatar-holder\", {\n                \"is-small\": small,\n                \"is-drop-target\": isDropTarget,\n            })}\n            data-user-uuid={avatarUser.userUUID}\n        >\n            <span className=\"video-avatar-holder-name\">{avatarUser.name}</span>\n            {createPortal(view, portal)}\n        </div>\n    ) : (\n        view\n    );\n};\n","import React from \"react\";\n\nexport interface SVGPlaceHolderProps {\n    className?: string;\n    isDark?: boolean;\n}\n\nexport const SVGPlaceHolder: React.FC<SVGPlaceHolderProps> = ({ className, isDark }) => {\n    const stopColor = isDark ? \"#33353D\" : \"#D5D9E0\";\n\n    return (\n        <svg\n            className={className}\n            fill=\"none\"\n            height=\"80\"\n            viewBox=\"0 0 80 80\"\n            width=\"80\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n        >\n            <path\n                d=\"M0 80V71.7607C0 61.8652 6.62305 53.1938 16.1699 50.5898L19.873 49.5801C24.6387 48.2808 28.4375 44.6855 30 40L29.3926 39.3936C26.5801 36.5806 25 32.7651 25 28.7866V26.25C22.3535 23.9341 22.3535 19.8159 25 17.5V15C25 6.71582 31.7148 0 40 0C48.2852 0 55 6.71582 55 15V17.5C57.6465 19.8159 57.6465 23.9341 55 26.25V28.7866C55 32.7651 53.4199 36.5806 50.6074 39.3936L50 40C51.5625 44.6855 55.3613 48.2808 60.127 49.5801L63.8301 50.5898C73.377 53.1938 80 61.8652 80 71.7607V80H0Z\"\n                fill=\"url(#paint0_linear_4451_134)\"\n            />\n            <defs>\n                <linearGradient\n                    gradientUnits=\"userSpaceOnUse\"\n                    id=\"paint0_linear_4451_134\"\n                    x1=\"40\"\n                    x2=\"40\"\n                    y1=\"0\"\n                    y2=\"80\"\n                >\n                    <stop stopColor={stopColor} />\n                    <stop offset=\"1\" stopColor={stopColor} stopOpacity=\"0\" />\n                </linearGradient>\n            </defs>\n        </svg>\n    );\n};\n\nexport default SVGPlaceHolder;\n","import \"./style.less\";\n\nimport Placeholder from \"./icons/Placeholder\";\n\nimport classnames from \"classnames\";\nimport React, { FC, useContext } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { User } from \"../../../types/user\";\nimport { DarkModeContext } from \"../../FlatThemeProvider\";\n\nexport interface VideoAvatarAbsentProps {\n    avatarUser?: User | null;\n    small?: boolean;\n    /** Is current user room creator */\n    isCreator: boolean;\n    /** Is `avatarUser` room creator */\n    isAvatarUserCreator: boolean;\n\n    portal?: HTMLElement | null;\n    onDoubleClick?: () => void;\n    onDragStart?: () => void;\n    onDragEnd?: () => void;\n    isDropTarget?: boolean;\n}\n\nexport const VideoAvatarAbsent: FC<VideoAvatarAbsentProps> = ({\n    avatarUser,\n    small,\n    isCreator,\n    isAvatarUserCreator,\n    portal,\n    onDoubleClick,\n    onDragStart,\n    onDragEnd,\n    isDropTarget,\n}) => {\n    const t = useTranslate();\n    const isDark = useContext(DarkModeContext);\n\n    const onDragStartImpl = (ev: React.DragEvent<HTMLDivElement>): void => {\n        if (!avatarUser) {\n            return;\n        }\n        const rect = ev.currentTarget.getBoundingClientRect();\n        const x = (ev.clientX - rect.left) / rect.width;\n        const y = (ev.clientY - rect.top) / rect.height;\n        ev.dataTransfer.setData(\"video-avatar\", JSON.stringify([avatarUser.userUUID, x, y]));\n        ev.dataTransfer.effectAllowed = \"move\";\n        onDragStart && onDragStart();\n    };\n\n    const absentView = avatarUser ? (\n        <div\n            className={classnames(\"video-avatar\", {\n                \"is-small\": small && !portal,\n                \"is-drop-target\": isDropTarget,\n            })}\n            data-user-uuid={avatarUser.userUUID}\n            draggable={isCreator && !portal}\n            onDoubleClick={portal ? undefined : onDoubleClick}\n            onDragEnd={onDragEnd}\n            onDragStart={onDragStartImpl}\n        >\n            <div\n                className=\"video-avatar-image-blur-bg\"\n                style={{ backgroundImage: `url(${avatarUser.avatar})` }}\n            />\n            <img\n                alt={avatarUser.name}\n                className=\"video-avatar-image\"\n                draggable={false}\n                src={avatarUser.avatar}\n            />\n            <div className=\"video-avatar-bottom\">\n                <h1 className=\"video-avatar-user-name\" title={avatarUser.name}>\n                    {avatarUser.name}\n                </h1>\n            </div>\n            <div className=\"video-avatar-is-left\">{t(\"has-left\")}</div>\n        </div>\n    ) : null;\n\n    return portal ? (\n        <div\n            className={classnames(\"video-avatar-absent\", {\n                \"is-small\": small,\n                \"is-drop-target\": isDropTarget,\n            })}\n            data-user-uuid={avatarUser?.userUUID}\n        >\n            <div className=\"video-avatar-absent-block\">\n                <Placeholder className=\"video-avatar-absent-img\" isDark={isDark} />\n                <span className=\"video-avatar-absent-content\">\n                    {isAvatarUserCreator ? (\n                        t(\"teacher-left-temporarily\")\n                    ) : avatarUser ? (\n                        <>\n                            <span className=\"video-avatar-absent-name\">{avatarUser.name}</span>\n                            <span className=\"video-avatar-absent-desc\">\n                                {t(\"user-left-temporarily\")}\n                            </span>\n                        </>\n                    ) : (\n                        t(\"student-left-temporarily\")\n                    )}\n                </span>\n            </div>\n            {absentView && portal && createPortal(absentView, portal)}\n        </div>\n    ) : (\n        absentView\n    );\n};\n","import toNumber from './toNumber.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nexport default toFinite;\n","import toFinite from './toFinite.js';\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nexport default toInteger;\n","import toInteger from './toInteger.js';\n\n/**\n * Checks if `value` is an integer.\n *\n * **Note:** This method is based on\n * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n * @example\n *\n * _.isInteger(3);\n * // => true\n *\n * _.isInteger(Number.MIN_VALUE);\n * // => false\n *\n * _.isInteger(Infinity);\n * // => false\n *\n * _.isInteger('3');\n * // => false\n */\nfunction isInteger(value) {\n  return typeof value == 'number' && value == toInteger(value);\n}\n\nexport default isInteger;\n","import \"./style.less\";\n\nimport React, { useMemo } from \"react\";\nimport classNames from \"classnames\";\nimport { isInteger } from \"lodash-es\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { SVGHandUp } from \"../../FlatIcons\";\n\nexport interface RaiseHandProps {\n    isRaiseHand?: boolean;\n    disableHandRaising?: boolean;\n    onRaiseHandChange: () => void;\n}\n\nexport const RaiseHand: React.FC<RaiseHandProps> = ({\n    isRaiseHand,\n    disableHandRaising,\n    onRaiseHandChange,\n}) => {\n    const t = useTranslate();\n\n    return disableHandRaising ? null : (\n        <button className=\"raise-hand-btn\" title={t(\"raise-your-hand\")} onClick={onRaiseHandChange}>\n            <SVGHandUp active={isRaiseHand} />\n        </button>\n    );\n};\n\nexport interface RaisingHandProps {\n    count: number;\n    active?: boolean;\n    onClick: () => void;\n}\n\nexport const RaisingHand: React.FC<RaisingHandProps> = ({ count, active = false, onClick }) => {\n    const t = useTranslate();\n\n    const countLabel = useMemo(\n        () =>\n            isInteger(count) && count > 0 ? (\n                <span\n                    className={classNames(\"raise-hand-red-dot\", {\n                        \"is-large\": count > 9,\n                    })}\n                >\n                    {count < 10 ? count : \"9+\"}\n                </span>\n            ) : null,\n        [count],\n    );\n\n    return (\n        <button className=\"raise-hand-btn\" title={t(\"raise-your-hand\")} onClick={onClick}>\n            <SVGHandUp active={active} />\n            {countLabel}\n        </button>\n    );\n};\n","// src/event.ts\nfunction addEventListener(target, type, listener, options) {\n  target.addEventListener(type, listener, options);\n  return () => target.removeEventListener(type, listener, options);\n}\nvar listen = addEventListener;\n\n// src/node.ts\nfunction isHTMLElement(node) {\n  return node?.nodeType === Node.ELEMENT_NODE;\n}\nfunction isTextNode(node) {\n  return node?.nodeType === Node.TEXT_NODE;\n}\nvar createTextNode = /* @__PURE__ */ document.createTextNode.bind(document);\nfunction insertBefore(target, node, anchor) {\n  return target.insertBefore(node, anchor || null);\n}\nvar insert = insertBefore;\nfunction appendChild(target, child) {\n  return target.appendChild(child);\n}\nfunction removeChild(target, child) {\n  return target.removeChild(child);\n}\nfunction replaceChild(target, node, child) {\n  return target.replaceChild(node, child);\n}\nfunction cloneNode(node, deep) {\n  return node.cloneNode(deep);\n}\nfunction contains(node, other) {\n  return node.contains(other);\n}\nfunction detach(node) {\n  node.parentNode?.removeChild(node);\n  return node;\n}\n\n// src/element.ts\nvar createElement = /* @__PURE__ */ document.createElement.bind(document);\nvar element = createElement;\nvar createSvgElement = /* @__PURE__ */ document.createElementNS.bind(\n  document,\n  \"http://www.w3.org/2000/svg\"\n);\nvar svgElement = createSvgElement;\nfunction attr(el, name, value) {\n  if (value == null) {\n    el.removeAttribute(name);\n  } else if (el.getAttribute(name) !== value) {\n    el.setAttribute(name, value);\n  }\n}\nfunction append(el, ...nodes) {\n  el.append(...nodes);\n}\nfunction prepend(el, ...nodes) {\n  el.prepend(...nodes);\n}\nfunction querySelector(selectors, parentNode = document) {\n  return parentNode.querySelector(selectors);\n}\nfunction querySelectorAll(selectors, parentNode = document) {\n  return parentNode.querySelectorAll(selectors);\n}\nfunction toggleClassName(el, token, force) {\n  return el.classList.toggle(token, force);\n}\nfunction h(tag, attributes, ...children) {\n  const el = element(tag);\n  for (const key in attributes) {\n    el.setAttribute(key, attributes[key]);\n  }\n  el.append(...children);\n  return el;\n}\n\nexport { addEventListener, append, appendChild, attr, cloneNode, contains, createElement, createSvgElement, createTextNode, detach, element, h, insert, insertBefore, isHTMLElement, isTextNode, listen, prepend, querySelector, querySelectorAll, removeChild, replaceChild, svgElement, toggleClassName };\n","import \"./style.less\";\n\nimport React, { useEffect, useRef } from \"react\";\nimport classNames from \"classnames\";\nimport { listen } from \"@wopjs/dom\";\n\nconst preventEvent = (ev: React.UIEvent | Event): void => {\n    ev.stopPropagation();\n    if (ev.cancelable) {\n        ev.preventDefault();\n    }\n};\n\nexport interface AvatarWindowProps {\n    mode: \"normal\" | \"maximized\";\n    rect: Rectangle;\n    zIndex?: number;\n    readonly?: boolean;\n    onClick?: () => void;\n    onResize?: (newRectangle: Rectangle, handle?: ResizeHandle) => void;\n    onDoubleClick?: () => void;\n    onDragging?: (ev: PointerEvent) => void;\n    onDragEnd?: (ev: PointerEvent) => void;\n}\n\nexport interface Rectangle {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n}\n\nexport type ResizeHandle = \"\" | \"n\" | \"s\" | \"w\" | \"e\" | \"nw\" | \"ne\" | \"sw\" | \"se\";\n\nexport const AvatarWindow: React.FC<AvatarWindowProps> = ({\n    mode,\n    rect,\n    zIndex,\n    readonly,\n    children,\n    onClick,\n    onResize,\n    onDoubleClick,\n    onDragging,\n    onDragEnd,\n}) => {\n    const lastClick = useRef({ t: 0, x: -100, y: -100 });\n    const disposers = useRef<Array<() => void>>([]);\n\n    useEffect(\n        () => () => {\n            disposers.current.forEach(dispose => dispose());\n            disposers.current = [];\n        },\n        [],\n    );\n\n    const handleTrackStart = (ev: React.PointerEvent<HTMLDivElement>): void => {\n        if (!ev.isPrimary || readonly || ev.button !== 0) {\n            return;\n        }\n\n        const target = ev.target as HTMLElement;\n        // filter out events on buttons, which should be handled by the button itself\n        for (\n            let node: HTMLElement | null = target;\n            node && node !== ev.currentTarget;\n            node = node.parentElement\n        ) {\n            if (node.tagName === \"BUTTON\") {\n                return;\n            }\n        }\n\n        const now = Date.now();\n        if (now - lastClick.current.t <= 500) {\n            if (\n                Math.abs(lastClick.current.x - ev.clientX) <= 5 &&\n                Math.abs(lastClick.current.y - ev.clientY) <= 5\n            ) {\n                onDoubleClick?.();\n            }\n            return;\n        }\n        lastClick.current = { t: now, x: ev.clientX, y: ev.clientY };\n\n        const main = ev.currentTarget.parentElement as HTMLElement;\n        preventEvent(ev);\n        target.setPointerCapture(ev.pointerId);\n        main.classList.add(\"window-grabbing\");\n\n        const trackingHandle = target.dataset?.windowHandle as ResizeHandle | undefined;\n        const { pageX: trackStartPageX, pageY: trackStartPageY } = ev;\n\n        const handleTracking = (ev: PointerEvent): void => {\n            if (!ev.isPrimary || readonly) {\n                return;\n            }\n\n            preventEvent(ev);\n\n            const { pageX, pageY } = ev;\n            const offsetX = pageX - trackStartPageX;\n            const offsetY = pageY - trackStartPageY;\n\n            let { x: newX, y: newY, width: newWidth, height: newHeight } = rect;\n\n            switch (trackingHandle) {\n                case \"n\": {\n                    newY = rect.y + offsetY;\n                    newHeight = rect.height - offsetY;\n                    break;\n                }\n                case \"s\": {\n                    newHeight = rect.height + offsetY;\n                    break;\n                }\n                case \"w\": {\n                    newX = rect.x + offsetX;\n                    newWidth = rect.width - offsetX;\n                    break;\n                }\n                case \"e\": {\n                    newWidth = rect.width + offsetX;\n                    break;\n                }\n                case \"nw\": {\n                    newX = rect.x + offsetX;\n                    newY = rect.y + offsetY;\n                    newWidth = rect.width - offsetX;\n                    newHeight = rect.height - offsetY;\n                    break;\n                }\n                case \"ne\": {\n                    newY = rect.y + offsetY;\n                    newWidth = rect.width + offsetX;\n                    newHeight = rect.height - offsetY;\n                    break;\n                }\n                case \"sw\": {\n                    newX = rect.x + offsetX;\n                    newWidth = rect.width - offsetX;\n                    newHeight = rect.height + offsetY;\n                    break;\n                }\n                case \"se\": {\n                    newWidth = rect.width + offsetX;\n                    newHeight = rect.height + offsetY;\n                    break;\n                }\n                default: {\n                    newX = rect.x + offsetX;\n                    newY = rect.y + offsetY;\n                    break;\n                }\n            }\n\n            onDragging?.(ev);\n            onResize?.({ x: newX, y: newY, width: newWidth, height: newHeight }, trackingHandle);\n        };\n\n        const handleTrackEnd = (ev: PointerEvent): void => {\n            if (!ev.isPrimary) {\n                return;\n            }\n\n            target.releasePointerCapture(ev.pointerId);\n            preventEvent(ev);\n            onDragEnd?.(ev);\n\n            disposers.current.forEach(dispose => dispose());\n            disposers.current = [];\n        };\n\n        disposers.current.push(\n            () => main.classList.remove(\"window-grabbing\"),\n            listen(window, \"pointermove\", handleTracking, { passive: false }),\n            listen(window, \"pointerup\", handleTrackEnd, { passive: false }),\n            listen(window, \"pointercancel\", handleTrackEnd, { passive: false }),\n        );\n    };\n\n    return (\n        <div\n            className={classNames(\"window\", {\n                \"window-readonly\": readonly,\n                \"window-maximized\": mode === \"maximized\",\n            })}\n            draggable={!readonly && mode === \"maximized\"}\n            style={\n                mode === \"normal\"\n                    ? {\n                          position: \"absolute\",\n                          // Prevent a rendering issue on Chrome when set transform to sub-pixel values\n                          width: rect.width | 0,\n                          height: rect.height | 0,\n                          transform: `translate(${rect.x | 0}px,${rect.y | 0}px)`,\n                          zIndex: zIndex,\n                      }\n                    : undefined\n            }\n        >\n            <div className=\"window-main\" onClick={onClick} onPointerDown={handleTrackStart}>\n                {children}\n            </div>\n            <div className=\"window-resize-handles\" onPointerDown={handleTrackStart}>\n                <div className=\"window-n window-resize-handle\" data-window-handle=\"n\" />\n                <div className=\"window-s window-resize-handle\" data-window-handle=\"s\" />\n                <div className=\"window-w window-resize-handle\" data-window-handle=\"w\" />\n                <div className=\"window-e window-resize-handle\" data-window-handle=\"e\" />\n                <div className=\"window-nw window-resize-handle\" data-window-handle=\"nw\" />\n                <div className=\"window-ne window-resize-handle\" data-window-handle=\"ne\" />\n                <div className=\"window-sw window-resize-handle\" data-window-handle=\"sw\" />\n                <div className=\"window-se window-resize-handle\" data-window-handle=\"se\" />\n            </div>\n        </div>\n    );\n};\n\nconst clamp = (value: number, min: number, max: number): number =>\n    value < min ? min : value > max ? max : value;\n\nexport const fixRect = (\n    input: Rectangle,\n    handle: ResizeHandle | undefined,\n    ratio: number,\n    minWidth: number,\n    maxWidth: number,\n    maxHeight: number,\n): Rectangle => {\n    const { x, y, width, height } = input;\n\n    // Keep the ratio\n    const fixedWidth = height / ratio;\n    const fixedHeight = width * ratio;\n    let newRect: Rectangle;\n    if (!handle || handle === \"e\" || handle === \"w\") {\n        newRect = { x, y, width, height: fixedHeight };\n    } else if (handle === \"s\" || handle === \"n\") {\n        newRect = { x, y, width: fixedWidth, height };\n    } else if (fixedHeight < height) {\n        const newY = handle === \"ne\" || handle === \"nw\" ? y + height - fixedHeight : y;\n        newRect = { x, y: newY, width, height: fixedHeight };\n    } else {\n        const newX = handle === \"nw\" || handle === \"sw\" ? x + width - fixedWidth : x;\n        newRect = { x: newX, y, width: fixedWidth, height };\n    }\n\n    // Clamp size\n    if (!(minWidth <= newRect.width && newRect.width <= maxWidth && newRect.height <= maxHeight)) {\n        const newWidth = clamp(newRect.width, minWidth, Math.min(maxWidth, maxHeight / ratio));\n        const newHeight = newWidth * ratio;\n        if (handle === \"w\" || handle === \"sw\" || handle === \"nw\") {\n            newRect.x = x + width - newWidth;\n        }\n        if (handle === \"n\" || handle === \"ne\" || handle === \"nw\") {\n            newRect.y = y + height - newHeight;\n        }\n        newRect.width = newWidth;\n        newRect.height = newHeight;\n    }\n\n    // Clamp position\n    newRect.x = clamp(newRect.x, 0, maxWidth - newRect.width);\n    newRect.y = clamp(newRect.y, 0, maxHeight - newRect.height);\n\n    return newRect;\n};\n","import React from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\n\nimport { TopBarRightBtn } from \"../TopBar\";\nimport { SVGRecord, SVGRecordStop } from \"../../FlatIcons\";\n\nexport type CloudRecordBtnProps = {\n    loading?: boolean;\n    isRecording: boolean;\n    onClick: () => void;\n};\n\nexport const CloudRecordBtn: React.FC<CloudRecordBtnProps> = /* @__PURE__ */ observer(\n    ({ loading, isRecording, onClick }) => {\n        const t = useTranslate();\n\n        return (\n            <TopBarRightBtn\n                disabled={loading}\n                icon={isRecording ? <SVGRecordStop active /> : <SVGRecord />}\n                title={t(\"recording\")}\n                onClick={onClick}\n            />\n        );\n    },\n);\n","// This file is generated automatically by `scripts/build/fp.ts`. Please, don't change it.\nimport fn from \"../../intervalToDuration/index.js\";\nimport convertToFP from \"../_lib/convertToFP/index.js\";\nexport default convertToFP(fn, 1);","import \"./style.less\";\n\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { useIsUnMounted } from \"../../../utils/hooks\";\nimport { RoomStatus } from \"../../../types/room\";\nimport { intervalToDuration } from \"date-fns/fp\";\n\nexport type TimerProps = {\n    roomStatus: RoomStatus;\n    beginTime: number;\n};\n\nconst paddingHexCode = (number: number): string => {\n    return String(number).padStart(2, \"0\");\n};\n\nconst useClockTick = (beginTime: number, roomStatus: RoomStatus): string => {\n    const [timestamp, updateTimestamp] = useState<number>(Date.now());\n    const unmounted = useIsUnMounted();\n\n    useEffect(() => {\n        let timer = NaN;\n\n        if (unmounted.current) {\n            return;\n        }\n\n        if (roomStatus === RoomStatus.Started) {\n            const startTimer = (): void => {\n                updateTimestamp(Math.floor(Date.now() / 1000) * 1000);\n                timer = window.requestAnimationFrame(startTimer);\n            };\n            startTimer();\n        }\n\n        return () => {\n            window.cancelAnimationFrame(timer);\n        };\n    }, [roomStatus, unmounted]);\n\n    return useMemo(() => {\n        const {\n            days = 0,\n            hours = 0,\n            minutes = 0,\n            seconds = 0,\n        } = intervalToDuration({\n            start: beginTime,\n            end: timestamp,\n        });\n\n        const minutesAndSeconds = `${paddingHexCode(minutes)}:${paddingHexCode(seconds)}`;\n        const dayHours = hours + days * 24;\n\n        return dayHours > 0\n            ? `${paddingHexCode(dayHours)}:${minutesAndSeconds}`\n            : minutesAndSeconds;\n    }, [beginTime, timestamp]);\n};\n\nexport const Timer: React.FC<TimerProps> = ({ roomStatus = RoomStatus.Paused, beginTime }) => {\n    const timing = useClockTick(beginTime, roomStatus);\n\n    const t = useTranslate();\n\n    return (\n        <span className=\"timer-bar\">\n            <span className={`timer-${roomStatus}`}>{t(\"room-started\")}</span>\n            <span className=\"timer-text\">{timing}</span>\n        </span>\n    );\n};\n","import React, { useEffect, useRef } from \"react\";\nimport { useSafePromise } from \"../../utils/hooks\";\n\nexport interface ThumbnailProps {\n    image: string;\n    width: number;\n    height: number;\n}\n\n// helper component to convert a big image into small canvas\nexport const Thumbnail = /* @__PURE__ */ React.memo<ThumbnailProps>(function Thumbnail(props) {\n    const sp = useSafePromise();\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n    useEffect(() => {\n        sp(loadImage(props.image))\n            .then(image => {\n                const canvas = canvasRef.current;\n                if (canvas) {\n                    drawThumbnail(canvas, image, props.width, props.height);\n                }\n            })\n            .catch(console.error);\n    }, [props.height, props.image, props.width, sp]);\n\n    return <canvas ref={canvasRef} />;\n});\n\nfunction drawThumbnail(\n    canvas: HTMLCanvasElement,\n    image: HTMLImageElement,\n    width: number,\n    height: number,\n): void {\n    // note: code below also clears canvas so we don't need to call clearRect()\n    canvas.width = width;\n    canvas.height = height;\n    const context = canvas.getContext(\"2d\");\n    if (context) {\n        // draw image with keeping ratio\n        const ratio = image.width / image.height;\n        if (ratio > 1) {\n            const dh = height / ratio;\n            context.drawImage(image, 0, (height - dh) / 2, width, dh);\n        } else {\n            const dw = width * ratio;\n            context.drawImage(image, (width - dw) / 2, 0, dw, height);\n        }\n    }\n}\n\nfunction loadImage(src: string): Promise<HTMLImageElement> {\n    return new Promise((resolve, reject) => {\n        const image = new Image();\n        image.onload = () => resolve(image);\n        image.onerror = reject;\n        image.src = src;\n    });\n}\n","import \"./style.less\";\n\nimport React from \"react\";\nimport { Modal } from \"antd\";\nimport { useTranslate } from \"@netless/flat-i18n\";\n\nimport { SVGPlus } from \"../FlatIcons\";\nimport { Thumbnail } from \"./Thumbnail\";\n\nexport interface PresetImage {\n    src: string;\n    i18nKey: string;\n}\n\nexport interface PresetsModalProps {\n    visible: boolean;\n    images: PresetImage[];\n    onClick: (image: string) => void;\n    onClose: () => void;\n}\n\nconst ThumbnailWidth = 280;\nconst ThumbnailHeight = 200;\n\nexport const PresetsModal: React.FC<PresetsModalProps> = ({\n    visible,\n    images,\n    onClick,\n    onClose,\n}) => {\n    const t = useTranslate();\n\n    return (\n        <Modal\n            closable\n            footer={null}\n            open={visible}\n            title={t(\"presets.title\")}\n            width={640}\n            wrapClassName=\"presets-modal-container\"\n            onCancel={onClose}\n        >\n            {images.map(({ src, i18nKey }) => (\n                <div key={i18nKey} className=\"presets-modal-item\">\n                    <button\n                        className=\"presets-modal-btn\"\n                        title={t(i18nKey)}\n                        onClick={() => onClick(src)}\n                    >\n                        <Thumbnail height={ThumbnailHeight} image={src} width={ThumbnailWidth} />\n                        <div className=\"presets-modal-mask\">\n                            <SVGPlus />\n                        </div>\n                    </button>\n                    <div className=\"presets-modal-text\">{t(i18nKey)}</div>\n                </div>\n            ))}\n        </Modal>\n    );\n};\n","export default \"data:image/svg+xml;charset=utf8,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 40 40'%3e%3ccircle cx='20' cy='20' r='19.5' stroke='white'/%3e%3cpath fill='white' d='M8 8h24v24H8z' opacity='.01'/%3e%3cpath fill='white' d='M15 16.375h-1v1.25h1v-1.25ZM12.375 18v8h1.25v-8h-1.25ZM14 27.625h12v-1.25H14v1.25ZM27.625 26v-8h-1.25v8h1.25ZM26 16.375h-1v1.25h1v-1.25ZM27.625 18c0-.898-.727-1.625-1.625-1.625v1.25c.207 0 .375.168.375.375h1.25ZM26 27.625c.898 0 1.625-.727 1.625-1.625h-1.25a.375.375 0 0 1-.375.375v1.25ZM12.375 26c0 .898.727 1.625 1.625 1.625v-1.25a.375.375 0 0 1-.375-.375h-1.25ZM14 16.375c-.898 0-1.625.727-1.625 1.625h1.25c0-.207.168-.375.375-.375v-1.25Z'/%3e%3cpath stroke='white' stroke-linejoin='round' stroke-width='1.25' d='M20 13v9m-3-3 3 3 3-3'/%3e%3c/svg%3e\";","import \"./style.less\";\nimport downloadSVG from \"./icons/download.svg\";\n\nimport classNames from \"classnames\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { Modal, message, Spin } from \"antd\";\n\nimport { useSafePromise } from \"../../utils/hooks\";\nimport { LoadingOutlined } from \"@ant-design/icons\";\n\nfunction download(\n    canvas: HTMLCanvasElement,\n    filename = \"annotation.png\",\n    failText = \"Save image failed\",\n): void {\n    try {\n        const a = document.createElement(\"a\");\n        a.download = filename;\n        a.href = canvas.toDataURL();\n        a.click();\n    } catch (err) {\n        console.error(err);\n        message.error(failText);\n    }\n}\n\nexport interface SaveAnnotationModalProps {\n    visible: boolean;\n    onClose: () => void;\n    images: Array<Promise<HTMLCanvasElement | null>>;\n}\n\nexport const SaveAnnotationModal: React.FC<SaveAnnotationModalProps> = ({\n    visible,\n    onClose,\n    images,\n}) => {\n    const t = useTranslate();\n\n    return (\n        <Modal\n            closable\n            destroyOnClose\n            footer={null}\n            open={visible}\n            title={t(\"annotation.save-action\")}\n            width={640}\n            wrapClassName=\"save-annotation-modal-container\"\n            onCancel={onClose}\n        >\n            {images.map((image, index) => (\n                <Annotation\n                    key={index}\n                    failText={t(\"annotation.save-failed\")}\n                    filename={`annotation-${index + 1}.png`}\n                    footerText={String(index + 1)}\n                    image={image}\n                />\n            ))}\n        </Modal>\n    );\n};\n\ninterface AnnotationProps {\n    image: Promise<HTMLCanvasElement | null>;\n    filename?: string;\n    footerText?: string;\n    failText?: string;\n}\n\nconst Annotation = /* @__PURE__ */ React.memo(function Annotation({\n    image,\n    filename = \"annotation.png\",\n    footerText,\n    failText = \"Save image failed\",\n}: AnnotationProps) {\n    const sp = useSafePromise();\n    const t = useTranslate();\n    const ref = useRef<HTMLDivElement>(null);\n    const [loading, setLoading] = useState(true);\n    const [canvas, setCanvas] = useState<HTMLCanvasElement | null>(null);\n\n    useEffect(() => {\n        sp(image).then(canvas => {\n            setCanvas(canvas);\n            setLoading(false);\n        });\n    }, [image, sp]);\n\n    useEffect(() => {\n        const div = ref.current;\n        if (!div) {\n            return;\n        }\n        if (canvas) {\n            div.appendChild(canvas);\n        } else if (div.firstChild) {\n            div.removeChild(div.firstChild);\n        }\n    }, [canvas]);\n\n    const downloadImage = useCallback(() => {\n        if (canvas) {\n            download(canvas, filename, failText);\n        }\n    }, [canvas, failText, filename]);\n\n    return (\n        <div\n            className={classNames(\"save-annotation\", {\n                \"is-loading\": !canvas,\n            })}\n            title={t(\"save\")}\n            onClick={downloadImage}\n        >\n            {loading && (\n                <div className=\"save-annotation-loader\">\n                    <Spin indicator={<LoadingOutlined spin />} size=\"large\" />\n                </div>\n            )}\n            <div ref={ref} className=\"save-annotation-image\" />\n            <div className=\"save-annotation-mask\" />\n            <div className=\"save-annotation-actions\">\n                <img alt=\"download\" src={downloadSVG} title={t(\"save\")} />\n            </div>\n            <div className=\"save-annotation-footer\">{footerText}</div>\n        </div>\n    );\n});\n","import \"./style.less\";\n\nimport classNames from \"classnames\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { Button, Switch } from \"antd\";\nimport { observer } from \"mobx-react-lite\";\nimport { FlatI18nTFunction, useTranslate } from \"@netless/flat-i18n\";\nimport { User } from \"../../types/user\";\nimport { IconMic } from \"../ClassroomPage/VideoAvatar/IconMic\";\nimport { SVGCamera, SVGCameraMute, SVGHandUp, SVGMicrophoneMute } from \"../FlatIcons\";\n\nexport interface UsersPanelRoomInfo {\n    ownerName?: string;\n    ownerAvatarURL?: string;\n}\n\nexport interface UsersPanelProps {\n    ownerUUID: string;\n    userUUID: string;\n    users: User[];\n    roomInfo?: UsersPanelRoomInfo;\n    getDeviceState?: (userUUID: string) => { camera: boolean; mic: boolean };\n    getVolumeLevel?: (userUUID: string) => number;\n    onOffStageAll?: () => void;\n    onMuteAll?: () => void;\n    onStaging?: (userUUID: string, isOnStage: boolean) => void;\n    onWhiteboard?: (userUUID: string, enabled: boolean) => void;\n    onDeviceState?: (userUUID: string, camera: boolean, mic: boolean) => void;\n}\n\nexport const UsersPanel = /* @__PURE__ */ observer<UsersPanelProps>(function UsersPanel({\n    ownerUUID,\n    userUUID,\n    users,\n    roomInfo,\n    getDeviceState,\n    getVolumeLevel,\n    onOffStageAll,\n    onMuteAll,\n    onStaging,\n    onWhiteboard,\n    onDeviceState,\n}) {\n    const t = useTranslate();\n\n    const isCreator = ownerUUID === userUUID;\n\n    return (\n        <div className=\"users-panel\">\n            <div className=\"users-panel-headline\">\n                {roomInfo && (\n                    <>\n                        <span className=\"users-panel-headline-avatar\">\n                            <img src={roomInfo.ownerAvatarURL} />\n                        </span>\n                        <span className=\"users-panel-headline-name\">{t(\"teacher\")}: </span>\n                        <span className=\"users-panel-headline-name\">{roomInfo.ownerName}</span>\n                    </>\n                )}\n                <span className=\"users-panel-splitter\" />\n                {isCreator && (\n                    <>\n                        <Button className=\"users-panel-btn\" onClick={onOffStageAll}>\n                            {t(\"all-off-stage\")}\n                        </Button>\n                        <Button className=\"users-panel-btn\" onClick={onMuteAll}>\n                            {t(\"all-mute-mic\")}\n                        </Button>\n                    </>\n                )}\n            </div>\n            <div className=\"users-panel-list-wrapper\">\n                <table className=\"users-panel-list\">\n                    <thead>\n                        <tr>\n                            <th>\n                                {t(\"members\")} ({users.length})\n                            </th>\n                            <th>{t(\"staging\")}</th>\n                            <th>{t(\"whiteboard-access\")}</th>\n                            <th>{t(\"camera\")}</th>\n                            <th>{t(\"microphone\")}</th>\n                            <th>\n                                {t(\"raised-hand\")} ({users.filter(user => user.isRaiseHand).length})\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"users-panel-items\">\n                        {users.map(user => (\n                            <Row\n                                key={user.userUUID}\n                                getDeviceState={getDeviceState}\n                                getVolumeLevel={getVolumeLevel}\n                                isCreator={isCreator}\n                                t={t}\n                                user={user}\n                                userUUID={userUUID}\n                                onDeviceState={onDeviceState}\n                                onStaging={onStaging}\n                                onWhiteboard={onWhiteboard}\n                            />\n                        ))}\n                    </tbody>\n                </table>\n                {users.length === 0 && (\n                    <div className=\"users-panel-list-empty\">{t(\"no-students\")}</div>\n                )}\n            </div>\n        </div>\n    );\n});\n\ninterface RowProps {\n    t: FlatI18nTFunction;\n    isCreator: boolean;\n    userUUID: string;\n    user: User;\n    getDeviceState: UsersPanelProps[\"getDeviceState\"];\n    getVolumeLevel: UsersPanelProps[\"getVolumeLevel\"];\n    onStaging: UsersPanelProps[\"onStaging\"];\n    onWhiteboard: UsersPanelProps[\"onWhiteboard\"];\n    onDeviceState: UsersPanelProps[\"onDeviceState\"];\n}\n\nconst Row = /* @__PURE__ */ observer(function Row({\n    t,\n    isCreator,\n    userUUID,\n    user,\n    getDeviceState,\n    getVolumeLevel: getAnyVolumeLevel,\n    onStaging,\n    onWhiteboard,\n    onDeviceState,\n}: RowProps): React.ReactElement {\n    const [camera, setCamera] = useState(false);\n    const [mic, setMic] = useState(false);\n    const getVolumeLevel = useCallback(() => {\n        return getAnyVolumeLevel?.(user.userUUID) || 0;\n    }, [getAnyVolumeLevel, user.userUUID]);\n\n    useEffect(() => {\n        if (getDeviceState) {\n            const timer = setInterval(() => {\n                const { camera, mic } = getDeviceState(user.userUUID);\n                setCamera(camera);\n                setMic(mic);\n            }, 500);\n            return () => clearInterval(timer);\n        }\n        return;\n    }, [getDeviceState, user.userUUID]);\n\n    const isSelf = userUUID === user.userUUID;\n\n    return (\n        <tr className=\"users-panel-list-item\">\n            <td>\n                <span className=\"users-panel-list-avatar-name\">\n                    <span className=\"users-panel-list-avatar\">\n                        <img src={user.avatar} />\n                    </span>\n                    {user.hasLeft ? (\n                        <div className=\"users-panel-list-name-wrapper\">\n                            <span className=\"users-panel-list-name\">\n                                <span className=\"users-panel-list-name-content\">{user.name}</span>\n                                {isSelf && <span className=\"users-panel-is-self\">{t(\"me\")}</span>}\n                            </span>\n                            <span className=\"users-panel-list-has-left\">{t(\"has-left\")}</span>\n                        </div>\n                    ) : (\n                        <span className=\"users-panel-list-name\">\n                            <span className=\"users-panel-list-name-content\">{user.name}</span>\n                            {isSelf && <span className=\"users-panel-is-self\">{t(\"me\")}</span>}\n                        </span>\n                    )}\n                </span>\n            </td>\n            <td>\n                <Switch\n                    checked={user.hasLeft || user.isSpeak}\n                    disabled={!(isCreator || (isSelf && user.isSpeak))}\n                    onChange={checked => onStaging?.(user.userUUID, checked)}\n                />\n            </td>\n            <td>\n                <Switch\n                    checked={user.wbOperate}\n                    disabled={!(isCreator || (isSelf && user.wbOperate))}\n                    onChange={checked => onWhiteboard?.(user.userUUID, checked)}\n                />\n            </td>\n            <td>\n                {user.isSpeak && getDeviceState ? (\n                    <button\n                        className=\"users-panel-media-btn is-camera\"\n                        disabled={!(isSelf || isCreator)}\n                        onClick={() => onDeviceState?.(user.userUUID, !camera, mic)}\n                    >\n                        {camera ? <SVGCamera active /> : <SVGCameraMute />}\n                    </button>\n                ) : (\n                    <span className=\"users-panel-media-off\">--</span>\n                )}\n            </td>\n            <td>\n                {user.isSpeak && getDeviceState ? (\n                    <button\n                        className={classNames(\"users-panel-media-btn is-mic\", {\n                            \"is-muted\": !mic,\n                        })}\n                        disabled={!(isSelf || isCreator)}\n                        onClick={() => onDeviceState?.(user.userUUID, camera, !mic)}\n                    >\n                        {mic ? <IconMic getVolumeLevel={getVolumeLevel} /> : <SVGMicrophoneMute />}\n                    </button>\n                ) : (\n                    <span className=\"users-panel-media-off\">--</span>\n                )}\n            </td>\n            <td className=\"users-panel-btn-group\">\n                {user.isRaiseHand ? (\n                    isCreator ? (\n                        <>\n                            <Button\n                                className=\"users-panel-small-btn is-ok\"\n                                disabled={!isCreator}\n                                size=\"small\"\n                                type=\"link\"\n                                onClick={() => isCreator && onStaging?.(user.userUUID, true)}\n                            >\n                                {t(\"agree\")}\n                            </Button>\n                            <span\n                                className={classNames(\"users-panel-small-btn-splitter\", {\n                                    \"is-disabled\": !isCreator,\n                                })}\n                            >\n                                /\n                            </span>\n                            <Button\n                                className=\"users-panel-small-btn is-cancel\"\n                                disabled={!isCreator}\n                                size=\"small\"\n                                type=\"link\"\n                                onClick={() => isCreator && onStaging?.(user.userUUID, false)}\n                            >\n                                {t(\"cancel\")}\n                            </Button>\n                        </>\n                    ) : (\n                        <SVGHandUp className=\"users-panel-small-btn is-hand\" />\n                    )\n                ) : (\n                    <span className=\"users-panel-media-off\">--</span>\n                )}\n            </td>\n        </tr>\n    );\n});\n","import { action, makeAutoObservable, observable } from \"mobx\";\nimport { usersInfo, CloudRecordStartPayload } from \"@netless/flat-server-api\";\nimport { preferencesStore } from \"./preferences-store\";\n\nexport interface User {\n    userUUID: string;\n    rtcUID: string;\n    avatar: string;\n    name: string;\n    camera: boolean;\n    mic: boolean;\n    isSpeak: boolean;\n    wbOperate: boolean;\n    isRaiseHand: boolean;\n    hasLeft: boolean;\n}\n\nexport type RecordingConfig = Required<\n    CloudRecordStartPayload[\"agoraData\"][\"clientRequest\"]\n>[\"recordingConfig\"];\n\n/**\n * Manage users in a classroom\n */\nexport class UserStore {\n    public readonly roomUUID: string;\n    /** Current user UUID */\n    public readonly userUUID: string;\n    /** Room owner UUID */\n    public readonly ownerUUID: string;\n    /** cache all users info including users who have left the room */\n    public cachedUsers = observable.map<string, User>();\n    /** creator info */\n    public creator: User | null = null;\n    /** current user info */\n    public currentUser: User | null = null;\n    /** joiners who have speaking access */\n    public speakingJoiners = observable.array<User>([]);\n    /** joiners who are raising hands */\n    public handRaisingJoiners = observable.array<User>([]);\n    /** the rest joiners */\n    public otherJoiners = observable.array<User>([]);\n\n    public get joiners(): User[] {\n        return [...this.speakingJoiners, ...this.handRaisingJoiners, ...this.otherJoiners];\n    }\n\n    public get totalUserCount(): number {\n        return (\n            (this.creator ? 1 : 0) +\n            (this.speakingJoiners.length +\n                this.handRaisingJoiners.length +\n                this.otherJoiners.length)\n        );\n    }\n\n    public get isCreator(): boolean {\n        return this.ownerUUID === this.userUUID;\n    }\n\n    public isInRoom: (userUUID: string) => boolean;\n\n    public constructor(config: {\n        userUUID: string;\n        ownerUUID: string;\n        roomUUID: string;\n        isInRoom: (userUUID: string) => boolean;\n    }) {\n        this.roomUUID = config.roomUUID;\n        this.userUUID = config.userUUID;\n        this.ownerUUID = config.ownerUUID;\n        this.isInRoom = config.isInRoom;\n\n        makeAutoObservable(this);\n    }\n\n    public initUsers = async (userUUIDs: string[]): Promise<void> => {\n        this.otherJoiners.clear();\n        this.speakingJoiners.clear();\n        this.handRaisingJoiners.clear();\n        const users = await this.createUsers(userUUIDs);\n        users.forEach(user => {\n            this.sortUser(user);\n            this.cacheUser(user);\n        });\n    };\n\n    public addUser = async (userUUID: string): Promise<User> => {\n        if (this.cachedUsers.has(userUUID)) {\n            this.removeUser(userUUID);\n        }\n        const [user] = await this.createUsers([userUUID]);\n        this.cacheUser(user);\n        this.sortUser(user);\n        return user;\n    };\n\n    public removeUser = (userUUID: string): void => {\n        if (this.creator && this.creator.userUUID === userUUID) {\n            this.creator.hasLeft = true;\n            this.creator = null;\n        } else {\n            for (const { group } of this.joinerGroups) {\n                for (let i = 0; i < this[group].length; i++) {\n                    if (this[group][i].userUUID === userUUID) {\n                        this[group][i].hasLeft = true;\n                        this[group].splice(i, 1);\n                        break;\n                    }\n                }\n            }\n        }\n    };\n\n    /**\n     * Update users states and sort into different groups automatically.\n     * @param editUser Update user state. This callback will be applied on all users.\n     * Return `false` to stop traversing.\n     */\n    public updateUsers = (editUser: (user: User) => boolean | void): void => {\n        const editUserAction = action(\"editUser\", editUser);\n        const unSortedUsers: User[] = [];\n\n        let shouldStopEditUser = false;\n\n        if (this.creator) {\n            shouldStopEditUser = editUserAction(this.creator) === false;\n        }\n\n        for (const { group, shouldMoveOut } of this.joinerGroups) {\n            if (shouldStopEditUser) {\n                break;\n            }\n\n            for (let i = 0; i < this[group].length; i++) {\n                if (shouldStopEditUser) {\n                    break;\n                }\n\n                const user = this[group][i];\n                shouldStopEditUser = editUserAction(user) === false;\n                if (shouldMoveOut(user)) {\n                    this[group].splice(i, 1);\n                    i--;\n                    unSortedUsers.push(user);\n                }\n            }\n        }\n\n        // Sort each unsorted users into different group\n        unSortedUsers.forEach(this.sortUser);\n    };\n\n    /**\n     * Fetch info of users who have left the room.\n     * For RTM message title.\n     */\n    public syncExtraUsersInfo = async (userUUIDs: string[]): Promise<void> => {\n        const users = await this.createUsers(\n            userUUIDs.filter(userUUID => !this.cachedUsers.has(userUUID)),\n        );\n        for (const user of users) {\n            this.cacheUser(user);\n        }\n    };\n\n    /** Return a random joiner that is not current user */\n    public pickRandomJoiner = (): User | undefined => {\n        const startIndex = Math.floor(Math.random() * this.joiners.length);\n\n        // keep picking until a suitable user is found\n        for (let count = 0; count < this.joiners.length; count++) {\n            const joiner = this.joiners[(startIndex + count) % this.joiners.length];\n\n            if (joiner && joiner.userUUID !== this.userUUID) {\n                return joiner;\n            }\n        }\n\n        return;\n    };\n\n    /**\n     * Sort a user into groups.\n     * The user object should be an observable.\n     * */\n    private sortUser = (user: User): void => {\n        if (user.userUUID === this.userUUID) {\n            this.currentUser = user;\n        }\n\n        if (user.userUUID === this.ownerUUID) {\n            this.creator = user;\n        } else if (user.isSpeak) {\n            const index = this.speakingJoiners.findIndex(\n                ({ userUUID }) => userUUID === user.userUUID,\n            );\n            if (index >= 0) {\n                this.speakingJoiners.splice(index, 1);\n            }\n            this.speakingJoiners.push(user);\n        } else if (user.isRaiseHand) {\n            const index = this.handRaisingJoiners.findIndex(\n                ({ userUUID }) => userUUID === user.userUUID,\n            );\n            if (index >= 0) {\n                this.handRaisingJoiners.splice(index, 1);\n            }\n            this.handRaisingJoiners.push(user);\n        } else {\n            this.otherJoiners.push(user);\n        }\n    };\n\n    private cacheUser(user: User): void {\n        this.cachedUsers.set(user.userUUID, user);\n    }\n\n    /**\n     * Fetch users info and return an observable user list\n     */\n    private async createUsers(userUUIDs: string[]): Promise<User[]> {\n        userUUIDs = [...new Set(userUUIDs)];\n\n        if (userUUIDs.length <= 0) {\n            return [];\n        }\n\n        const users = await usersInfo({ roomUUID: this.roomUUID, usersUUID: userUUIDs });\n\n        return userUUIDs.map(userUUID =>\n            // must convert to observable first so that it may be reused by other logic\n            observable.object<User>({\n                userUUID,\n                rtcUID: String(users[userUUID].rtcUID),\n                avatar: users[userUUID].avatarURL,\n                name: users[userUUID].name,\n                camera: userUUID === this.userUUID ? preferencesStore.autoCameraOn : false,\n                mic: userUUID === this.userUUID ? preferencesStore.autoMicOn : false,\n                isSpeak: userUUID === this.userUUID && this.isCreator,\n                wbOperate: userUUID === this.userUUID && this.isCreator,\n                isRaiseHand: false,\n                hasLeft: !this.isInRoom(userUUID),\n            }),\n        );\n    }\n\n    private readonly joinerGroups = [\n        { group: \"speakingJoiners\", shouldMoveOut: (user: User): boolean => !user.isSpeak },\n        { group: \"handRaisingJoiners\", shouldMoveOut: (user: User): boolean => !user.isRaiseHand },\n        {\n            group: \"otherJoiners\",\n            shouldMoveOut: (user: User): boolean => user.isRaiseHand || user.isSpeak,\n        },\n    ] as const;\n}\n","import { IServiceTextChat } from \"@netless/flat-services\";\nimport { ChatMsg } from \"flat-components\";\nimport { makeAutoObservable, observable, runInAction } from \"mobx\";\nimport { SideEffectManager } from \"side-effect-manager\";\n\nexport interface ChatStoreConfig {\n    roomUUID: string;\n    ownerUUID: string;\n    rtm: IServiceTextChat;\n    isShowUserGuide: boolean;\n}\n\nexport class ChatStore {\n    private readonly sideEffect = new SideEffectManager();\n\n    public readonly messages = observable.array<ChatMsg>([]);\n\n    public readonly rtm: IServiceTextChat;\n\n    public constructor(config: ChatStoreConfig) {\n        this.rtm = config.rtm;\n        makeAutoObservable<this, \"sideEffect\">(this, {\n            rtm: observable.ref,\n            sideEffect: false,\n        });\n\n        if (config.isShowUserGuide && this.messages.every(m => m.type !== \"user-guide\")) {\n            runInAction(() => {\n                this.messages.push({\n                    type: \"user-guide\",\n                    uuid: \"user-guide\",\n                    timestamp: Date.now(),\n                    roomUUID: config.roomUUID,\n                    senderID: config.ownerUUID,\n                });\n            });\n        }\n\n        this.sideEffect.addDisposer(\n            this.rtm.events.on(\"room-message\", message => {\n                this.newMessage({\n                    type: \"room-message\",\n                    ...message,\n                });\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            this.rtm.events.on(\"notice\", message => {\n                this.newMessage({\n                    type: \"notice\",\n                    ...message,\n                });\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            this.rtm.events.on(\"ban\", message => {\n                this.newMessage({\n                    type: \"ban\",\n                    ...message,\n                });\n            }),\n        );\n    }\n\n    public destroy(): void {\n        this.sideEffect.flushAll();\n    }\n\n    /** Add the new message to message list */\n    private newMessage = (message: ChatMsg): void => {\n        const timestamp = Date.now();\n        let insertPoint = 0;\n        while (\n            insertPoint < this.messages.length &&\n            this.messages[insertPoint].timestamp <= timestamp\n        ) {\n            insertPoint++;\n        }\n        this.messages.splice(insertPoint, 0, message);\n        this.onNewMessage(message);\n    };\n\n    /** For upstream to sync messages */\n    public onNewMessage(_message: ChatMsg): void {\n        // do nothing\n    }\n}\n","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* global Worker, URL, TransformStream */\n\nimport {\n\tCodec,\n\tMESSAGE_EVENT_TYPE,\n\tMESSAGE_START,\n\tMESSAGE_PULL,\n\tMESSAGE_DATA,\n\tMESSAGE_ACK_DATA,\n\tMESSAGE_CLOSE\n} from \"./codec-interface.js\";\n\nlet workersSupported;\nlet classicWorkersSupported = true;\nlet transferStreamsSupported = true;\n\nexport {\n\tCodecWorker\n};\n\nclass CodecWorker {\n\n\tconstructor(workerData, stream, workerOptions, onTaskFinished) {\n\t\tconst { readable, writable } = stream;\n\t\tconst { options, config, streamOptions, useWebWorkers, transferStreams, scripts } = workerOptions;\n\t\tObject.assign(workerData, {\n\t\t\tbusy: true,\n\t\t\treadable,\n\t\t\twritable,\n\t\t\toptions: Object.assign({}, options),\n\t\t\tscripts,\n\t\t\ttransferStreams,\n\t\t\tterminate() {\n\t\t\t\tif (workerData.worker && !workerData.busy) {\n\t\t\t\t\tworkerData.worker.terminate();\n\t\t\t\t\tworkerData.interface = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonTaskFinished() {\n\t\t\t\tworkerData.busy = false;\n\t\t\t\tonTaskFinished(workerData);\n\t\t\t}\n\t\t});\n\t\tconst { signal, onstart, onprogress, size, onend } = streamOptions;\n\t\tlet chunkOffset = 0;\n\t\tconst transformer = {};\n\t\tif (onstart) {\n\t\t\ttransformer.start = () => callHandler(onstart, size);\n\t\t}\n\t\ttransformer.transform = async (chunk, controller) => {\n\t\t\tchunkOffset += chunk.length;\n\t\t\tif (onprogress) {\n\t\t\t\tawait callHandler(onprogress, chunkOffset, size);\n\t\t\t}\n\t\t\tcontroller.enqueue(chunk);\n\t\t};\n\t\ttransformer.flush = () => {\n\t\t\treadable.size = chunkOffset;\n\t\t\tif (onend) {\n\t\t\t\tcallHandler(onend, chunkOffset);\n\t\t\t}\n\t\t};\n\t\tworkerData.readable = readable.pipeThrough(new TransformStream(transformer, { highWaterMark: 1, size: () => config.chunkSize }), { signal });\n\t\tif (workersSupported === undefined) {\n\t\t\tworkersSupported = typeof Worker != \"undefined\";\n\t\t}\n\t\treturn useWebWorkers && workersSupported ? createWebWorkerInterface(workerData, config) : createWorkerInterface(workerData, config);\n\t}\n}\n\nasync function callHandler(handler, ...parameters) {\n\ttry {\n\t\tawait handler(...parameters);\n\t} catch (_error) {\n\t\t// ignored\n\t}\n}\n\nfunction createWorkerInterface(workerData, config) {\n\tconst interfaceCodec = new Codec(workerData.readable, workerData.writable, workerData.options, config);\n\tconst { onTaskFinished } = workerData;\n\tconst codec = {\n\t\tasync run() {\n\t\t\ttry {\n\t\t\t\treturn await interfaceCodec.run();\n\t\t\t} finally {\n\t\t\t\tonTaskFinished();\n\t\t\t}\n\t\t}\n\t};\n\treturn codec;\n}\n\nfunction createWebWorkerInterface(workerData, { baseURL, chunkSize }) {\n\tconst workerOptions = { type: \"module\" };\n\tObject.assign(workerData, {\n\t\tstreams: {},\n\t\tresult: new Promise((resolve, reject) => {\n\t\t\tworkerData.resolveResult = resolve;\n\t\t\tworkerData.rejectResult = reject;\n\t\t})\n\t});\n\tif (!workerData.interface) {\n\t\tif (!classicWorkersSupported) {\n\t\t\tworkerData.worker = getWorker(workerOptions);\n\t\t} else {\n\t\t\ttry {\n\t\t\t\tworkerData.worker = getWorker({});\n\t\t\t} catch (_error) {\n\t\t\t\tclassicWorkersSupported = false;\n\t\t\t\tworkerData.worker = getWorker(workerOptions);\n\t\t\t}\n\t\t}\n\t\tworkerData.worker.addEventListener(MESSAGE_EVENT_TYPE, onMessage, false);\n\t\tworkerData.interface = {\n\t\t\trun() {\n\t\t\t\tconst { readable, writable, options } = workerData;\n\t\t\t\tconst scripts = workerData.scripts.slice(1);\n\t\t\t\tconst message = { type: MESSAGE_START, scripts, options, config: { chunkSize } };\n\t\t\t\tif (workerData.transferStreams && transferStreamsSupported) {\n\t\t\t\t\tconst streamsTransferred = sendMessage({ ...message, readable, writable });\n\t\t\t\t\tif (!streamsTransferred) {\n\t\t\t\t\t\ttransferStreamsSupported = false;\n\t\t\t\t\t\tinitStreams(readable, writable);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsendMessage(message);\n\t\t\t\t\tinitStreams(readable, writable);\n\t\t\t\t}\n\t\t\t\treturn workerData.result;\n\t\t\t}\n\t\t};\n\t}\n\treturn workerData.interface;\n\n\tfunction initStreams(readable, writable) {\n\t\tObject.assign(workerData.streams, {\n\t\t\treader: readable.getReader(),\n\t\t\twriter: writable.getWriter()\n\t\t});\n\t}\n\n\tfunction getWorker(options) {\n\t\tlet url, scriptUrl;\n\t\turl = workerData.scripts[0];\n\t\tif (typeof url == \"function\") {\n\t\t\turl = url();\n\t\t}\n\t\ttry {\n\t\t\tscriptUrl = new URL(url, baseURL);\n\t\t} catch (_error) {\n\t\t\tscriptUrl = url;\n\t\t}\n\t\treturn new Worker(scriptUrl, options);\n\t}\n\n\tfunction sendMessage(message) {\n\t\tconst { worker, writer, onTaskFinished } = workerData;\n\t\ttry {\n\t\t\tlet { data, readable, writable } = message;\n\t\t\tconst transferrables = [];\n\t\t\tif (data) {\n\t\t\t\tconst { buffer, length } = data;\n\t\t\t\tif (length != buffer.byteLength) {\n\t\t\t\t\tdata = new Uint8Array(data);\n\t\t\t\t}\n\t\t\t\tmessage.data = data.buffer;\n\t\t\t\ttransferrables.push(message.data);\n\t\t\t}\n\t\t\tif (readable) {\n\t\t\t\ttransferrables.push(readable);\n\t\t\t}\n\t\t\tif (writable) {\n\t\t\t\ttransferrables.push(writable);\n\t\t\t}\n\t\t\tif (transferrables.length) {\n\t\t\t\ttry {\n\t\t\t\t\tworker.postMessage(message, transferrables);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tmessage.readable = message.writable = null;\n\t\t\t\t\tworker.postMessage(message);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tworker.postMessage(message);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tif (writer) {\n\t\t\t\twriter.releaseLock();\n\t\t\t}\n\t\t\tonTaskFinished();\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync function onMessage(event) {\n\t\tconst message = event.data;\n\t\tconst { resolveResult, rejectResult, onTaskFinished } = workerData;\n\t\tconst { reader, writer } = workerData.streams;\n\t\tconst { type, data, messageId, result } = message;\n\t\tconst reponseError = message.error;\n\t\ttry {\n\t\t\tif (reponseError) {\n\t\t\t\tconst { message, stack, code, name } = reponseError;\n\t\t\t\tconst error = new Error(message);\n\t\t\t\tObject.assign(error, { stack, code, name });\n\t\t\t\tclose(error);\n\t\t\t} else {\n\t\t\t\tif (type == MESSAGE_PULL) {\n\t\t\t\t\tconst { value, done } = await reader.read();\n\t\t\t\t\tsendMessage({ type: MESSAGE_DATA, data: value, done, messageId });\n\t\t\t\t}\n\t\t\t\tif (type == MESSAGE_DATA) {\n\t\t\t\t\tawait writer.ready;\n\t\t\t\t\tawait writer.write(new Uint8Array(data));\n\t\t\t\t\tsendMessage({ type: MESSAGE_ACK_DATA, messageId });\n\t\t\t\t}\n\t\t\t\tif (type == MESSAGE_CLOSE) {\n\t\t\t\t\tclose(null, result);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tclose(error);\n\t\t}\n\n\t\tfunction close(error, result) {\n\t\t\tif (error) {\n\t\t\t\trejectResult(error);\n\t\t\t} else {\n\t\t\t\tresolveResult(result);\n\t\t\t}\n\t\t\tif (writer) {\n\t\t\t\twriter.releaseLock();\n\t\t\t}\n\t\t\tonTaskFinished();\n\t\t}\n\t}\n}","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* global setTimeout, clearTimeout */\n\nimport {\n\tCODEC_INFLATE,\n\tCODEC_DEFLATE,\n\tERR_INVALID_SIGNATURE,\n\tERR_INVALID_PASSWORD\n} from \"./codec-interface.js\";\nimport { CodecWorker } from \"./codec-pool-worker.js\";\n\nlet pool = [];\nconst pendingRequests = [];\n\nexport {\n\trunWorker,\n\tterminateWorkers,\n\tCODEC_DEFLATE,\n\tCODEC_INFLATE,\n\tERR_INVALID_SIGNATURE,\n\tERR_INVALID_PASSWORD\n};\n\nlet indexWorker = 0;\n\nasync function runWorker(stream, workerOptions) {\n\tconst { options, config } = workerOptions;\n\tconst { transferStreams, useWebWorkers, useCompressionStream, codecType, compressed, signed, encrypted } = options;\n\tconst { workerScripts } = config;\n\tworkerOptions.transferStreams = transferStreams || transferStreams === undefined;\n\tconst streamCopy = !compressed && !signed && !encrypted && !workerOptions.transferStreams;\n\tworkerOptions.useWebWorkers = !streamCopy && (useWebWorkers || (useWebWorkers === undefined && config.useWebWorkers));\n\tworkerOptions.scripts = workerOptions.useWebWorkers && workerScripts ? workerScripts[codecType] : [];\n\toptions.useCompressionStream = useCompressionStream || (useCompressionStream === undefined && config.useCompressionStream);\n\tlet worker;\n\tif (pool.length < config.maxWorkers) {\n\t\tconst workerData = { indexWorker };\n\t\tindexWorker++;\n\t\tpool.push(workerData);\n\t\tworker = new CodecWorker(workerData, stream, workerOptions, onTaskFinished);\n\t} else {\n\t\tconst workerData = pool.find(workerData => !workerData.busy);\n\t\tif (workerData) {\n\t\t\tclearTerminateTimeout(workerData);\n\t\t\tworker = new CodecWorker(workerData, stream, workerOptions, onTaskFinished);\n\t\t} else {\n\t\t\tworker = await new Promise(resolve => pendingRequests.push({ resolve, stream, workerOptions }));\n\t\t}\n\t}\n\treturn worker.run();\n\n\tfunction onTaskFinished(workerData) {\n\t\tif (pendingRequests.length) {\n\t\t\tconst [{ resolve, stream, workerOptions }] = pendingRequests.splice(0, 1);\n\t\t\tresolve(new CodecWorker(workerData, stream, workerOptions, onTaskFinished));\n\t\t} else if (workerData.worker) {\n\t\t\tconst { terminateWorkerTimeout } = config;\n\t\t\tclearTerminateTimeout(workerData);\n\t\t\tif (Number.isFinite(terminateWorkerTimeout) && terminateWorkerTimeout >= 0) {\n\t\t\t\tworkerData.terminateTimeout = setTimeout(() => {\n\t\t\t\t\tpool = pool.filter(data => data != workerData);\n\t\t\t\t\tworkerData.terminate();\n\t\t\t\t}, terminateWorkerTimeout);\n\t\t\t}\n\t\t} else {\n\t\t\tpool = pool.filter(data => data != workerData);\n\t\t}\n\t}\n}\n\nfunction clearTerminateTimeout(workerData) {\n\tconst { terminateTimeout } = workerData;\n\tif (terminateTimeout) {\n\t\tclearTimeout(terminateTimeout);\n\t\tworkerData.terminateTimeout = null;\n\t}\n}\n\nfunction terminateWorkers() {\n\tpool.forEach(workerData => {\n\t\tclearTerminateTimeout(workerData);\n\t\tworkerData.terminate();\n\t});\n}","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* global Blob, atob, btoa, XMLHttpRequest, URL, fetch, ReadableStream, WritableStream, FileReader, TransformStream, Response */\n\nconst ERR_HTTP_STATUS = \"HTTP error \";\nconst ERR_HTTP_RANGE = \"HTTP Range not supported\";\n\nconst CONTENT_TYPE_TEXT_PLAIN = \"text/plain\";\nconst HTTP_HEADER_CONTENT_LENGTH = \"Content-Length\";\nconst HTTP_HEADER_CONTENT_RANGE = \"Content-Range\";\nconst HTTP_HEADER_ACCEPT_RANGES = \"Accept-Ranges\";\nconst HTTP_HEADER_RANGE = \"Range\";\nconst HTTP_METHOD_HEAD = \"HEAD\";\nconst HTTP_METHOD_GET = \"GET\";\nconst HTTP_RANGE_UNIT = \"bytes\";\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nimport { getConfiguration } from \"./configuration.js\";\n\nclass Stream {\n\n\tconstructor() {\n\t\tthis.size = 0;\n\t}\n\n\tinit() {\n\t\tthis.initialized = true;\n\t}\n}\n\nclass Reader extends Stream {\n\n\tget readable() {\n\t\tconst reader = this;\n\t\tconst { chunkSize = DEFAULT_CHUNK_SIZE } = reader;\n\t\tconst readable = new ReadableStream({\n\t\t\tstart() {\n\t\t\t\tthis.chunkOffset = 0;\n\t\t\t},\n\t\t\tasync pull(controller) {\n\t\t\t\tconst { offset = 0, size } = readable;\n\t\t\t\tconst { chunkOffset } = this;\n\t\t\t\tcontroller.enqueue(await reader.readUint8Array(offset + chunkOffset, Math.min(chunkSize, size - chunkOffset)));\n\t\t\t\tif (chunkOffset + chunkSize > size) {\n\t\t\t\t\tcontroller.close();\n\t\t\t\t} else {\n\t\t\t\t\tthis.chunkOffset += chunkSize;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn readable;\n\t}\n}\n\nclass Writer extends Stream {\n\n\tconstructor() {\n\t\tsuper();\n\t\tconst writer = this;\n\t\tconst writable = new WritableStream({\n\t\t\twrite(chunk) {\n\t\t\t\treturn writer.writeUint8Array(chunk);\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(writer, \"writable\", {\n\t\t\tget() {\n\t\t\t\treturn writable;\n\t\t\t}\n\t\t});\n\t}\n\n\twriteUint8Array() {\n\t\t// abstract\n\t}\n}\n\nclass Data64URIReader extends Reader {\n\n\tconstructor(dataURI) {\n\t\tsuper();\n\t\tconst reader = this;\n\t\treader.dataURI = dataURI;\n\t\tlet dataEnd = dataURI.length;\n\t\twhile (dataURI.charAt(dataEnd - 1) == \"=\") {\n\t\t\tdataEnd--;\n\t\t}\n\t\treader.dataStart = dataURI.indexOf(\",\") + 1;\n\t\treader.size = Math.floor((dataEnd - reader.dataStart) * 0.75);\n\t}\n\n\treadUint8Array(offset, length) {\n\t\tconst dataArray = new Uint8Array(length);\n\t\tconst start = Math.floor(offset / 3) * 4;\n\t\tconst dataStart = this.dataStart;\n\t\tconst bytes = atob(this.dataURI.substring(start + dataStart, Math.ceil((offset + length) / 3) * 4 + dataStart));\n\t\tconst delta = offset - Math.floor(start / 4) * 3;\n\t\tfor (let indexByte = delta; indexByte < delta + length; indexByte++) {\n\t\t\tdataArray[indexByte - delta] = bytes.charCodeAt(indexByte);\n\t\t}\n\t\treturn dataArray;\n\t}\n}\n\nclass Data64URIWriter extends Writer {\n\n\tconstructor(contentType) {\n\t\tsuper();\n\t\tthis.data = \"data:\" + (contentType || \"\") + \";base64,\";\n\t\tthis.pending = [];\n\t}\n\n\twriteUint8Array(array) {\n\t\tconst writer = this;\n\t\tlet indexArray = 0;\n\t\tlet dataString = writer.pending;\n\t\tconst delta = writer.pending.length;\n\t\twriter.pending = \"\";\n\t\tfor (indexArray = 0; indexArray < (Math.floor((delta + array.length) / 3) * 3) - delta; indexArray++) {\n\t\t\tdataString += String.fromCharCode(array[indexArray]);\n\t\t}\n\t\tfor (; indexArray < array.length; indexArray++) {\n\t\t\twriter.pending += String.fromCharCode(array[indexArray]);\n\t\t}\n\t\tif (dataString.length > 2) {\n\t\t\twriter.data += btoa(dataString);\n\t\t} else {\n\t\t\twriter.pending = dataString;\n\t\t}\n\t}\n\n\tgetData() {\n\t\treturn this.data + btoa(this.pending);\n\t}\n}\n\nclass BlobReader extends Reader {\n\n\tconstructor(blob) {\n\t\tsuper();\n\t\tthis.blob = blob;\n\t\tthis.size = blob.size;\n\t}\n\n\tasync readUint8Array(offset, length) {\n\t\tconst reader = this;\n\t\treturn new Uint8Array(await reader.blob.slice(offset, offset + length).arrayBuffer());\n\t}\n}\n\nclass BlobWriter extends Stream {\n\n\tconstructor(contentType) {\n\t\tsuper();\n\t\tconst writer = this;\n\t\tconst transformStream = new TransformStream();\n\t\tconst headers = [];\n\t\tif (contentType) {\n\t\t\theaders.push([\"content-type\", contentType]);\n\t\t}\n\t\tObject.defineProperty(writer, \"writable\", {\n\t\t\tget() {\n\t\t\t\treturn transformStream.writable;\n\t\t\t}\n\t\t});\n\t\twriter.blob = new Response(transformStream.readable, { headers }).blob();\n\t}\n\n\tgetData() {\n\t\treturn this.blob;\n\t}\n}\n\nclass TextReader extends BlobReader {\n\n\tconstructor(text) {\n\t\tsuper(new Blob([text], { type: CONTENT_TYPE_TEXT_PLAIN }));\n\t}\n}\n\nclass TextWriter extends BlobWriter {\n\n\tconstructor(encoding) {\n\t\tsuper(encoding);\n\t\tObject.assign(this, {\n\t\t\tencoding,\n\t\t\tutf8: !encoding || encoding.toLowerCase() == \"utf-8\"\n\t\t});\n\t}\n\n\tasync getData() {\n\t\tconst {\n\t\t\tencoding,\n\t\t\tutf8\n\t\t} = this;\n\t\tconst blob = await super.getData();\n\t\tif (blob.text && utf8) {\n\t\t\treturn blob.text();\n\t\t} else {\n\t\t\tconst reader = new FileReader();\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\treader.onload = ({ target }) => resolve(target.result);\n\t\t\t\treader.onerror = () => reject(reader.error);\n\t\t\t\treader.readAsText(blob, encoding);\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass FetchReader extends Reader {\n\n\tconstructor(url, options) {\n\t\tsuper();\n\t\tconst reader = this;\n\t\treader.url = url;\n\t\treader.preventHeadRequest = options.preventHeadRequest;\n\t\treader.useRangeHeader = options.useRangeHeader;\n\t\treader.forceRangeRequests = options.forceRangeRequests;\n\t\treader.options = options = Object.assign({}, options);\n\t\tdelete options.preventHeadRequest;\n\t\tdelete options.useRangeHeader;\n\t\tdelete options.forceRangeRequests;\n\t\tdelete options.useXHR;\n\t}\n\n\tasync init() {\n\t\tsuper.init();\n\t\tawait initHttpReader(this, sendFetchRequest, getFetchRequestData);\n\t}\n\n\treadUint8Array(index, length) {\n\t\treturn readUint8ArrayHttpReader(this, index, length, sendFetchRequest, getFetchRequestData);\n\t}\n}\n\nclass XHRReader extends Reader {\n\n\tconstructor(url, options) {\n\t\tsuper();\n\t\tconst reader = this;\n\t\treader.url = url;\n\t\treader.preventHeadRequest = options.preventHeadRequest;\n\t\treader.useRangeHeader = options.useRangeHeader;\n\t\treader.forceRangeRequests = options.forceRangeRequests;\n\t\treader.options = options;\n\t}\n\n\tasync init() {\n\t\tsuper.init();\n\t\tawait initHttpReader(this, sendXMLHttpRequest, getXMLHttpRequestData);\n\t}\n\n\treadUint8Array(index, length) {\n\t\treturn readUint8ArrayHttpReader(this, index, length, sendXMLHttpRequest, getXMLHttpRequestData);\n\t}\n}\n\nasync function initHttpReader(httpReader, sendRequest, getRequestData) {\n\tif (isHttpFamily(httpReader.url) && (httpReader.useRangeHeader || httpReader.forceRangeRequests)) {\n\t\tconst response = await sendRequest(HTTP_METHOD_GET, httpReader, getRangeHeaders(httpReader));\n\t\tif (!httpReader.forceRangeRequests && response.headers.get(HTTP_HEADER_ACCEPT_RANGES) != HTTP_RANGE_UNIT) {\n\t\t\tthrow new Error(ERR_HTTP_RANGE);\n\t\t} else {\n\t\t\tlet contentSize;\n\t\t\tconst contentRangeHeader = response.headers.get(HTTP_HEADER_CONTENT_RANGE);\n\t\t\tif (contentRangeHeader) {\n\t\t\t\tconst splitHeader = contentRangeHeader.trim().split(/\\s*\\/\\s*/);\n\t\t\t\tif (splitHeader.length) {\n\t\t\t\t\tconst headerValue = splitHeader[1];\n\t\t\t\t\tif (headerValue && headerValue != \"*\") {\n\t\t\t\t\t\tcontentSize = Number(headerValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (contentSize === undefined) {\n\t\t\t\tawait getContentLength(httpReader, sendRequest, getRequestData);\n\t\t\t} else {\n\t\t\t\thttpReader.size = contentSize;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tawait getContentLength(httpReader, sendRequest, getRequestData);\n\t}\n}\n\nasync function readUint8ArrayHttpReader(httpReader, index, length, sendRequest, getRequestData) {\n\tif (httpReader.useRangeHeader || httpReader.forceRangeRequests) {\n\t\tconst response = await sendRequest(HTTP_METHOD_GET, httpReader, getRangeHeaders(httpReader, index, length));\n\t\tif (response.status != 206) {\n\t\t\tthrow new Error(ERR_HTTP_RANGE);\n\t\t}\n\t\treturn new Uint8Array(await response.arrayBuffer());\n\t} else {\n\t\tif (!httpReader.data) {\n\t\t\tawait getRequestData(httpReader, httpReader.options);\n\t\t}\n\t\treturn new Uint8Array(httpReader.data.subarray(index, index + length));\n\t}\n}\n\nfunction getRangeHeaders(httpReader, index = 0, length = 1) {\n\treturn Object.assign({}, getHeaders(httpReader), { [HTTP_HEADER_RANGE]: HTTP_RANGE_UNIT + \"=\" + index + \"-\" + (index + length - 1) });\n}\n\nfunction getHeaders(httpReader) {\n\tconst headers = httpReader.options.headers;\n\tif (headers) {\n\t\tif (Symbol.iterator in headers) {\n\t\t\treturn Object.fromEntries(headers);\n\t\t} else {\n\t\t\treturn headers;\n\t\t}\n\t}\n}\n\nasync function getFetchRequestData(httpReader) {\n\tawait getRequestData(httpReader, sendFetchRequest);\n}\n\nasync function getXMLHttpRequestData(httpReader) {\n\tawait getRequestData(httpReader, sendXMLHttpRequest);\n}\n\nasync function getRequestData(httpReader, sendRequest) {\n\tconst response = await sendRequest(HTTP_METHOD_GET, httpReader, getHeaders(httpReader));\n\thttpReader.data = new Uint8Array(await response.arrayBuffer());\n\tif (!httpReader.size) {\n\t\thttpReader.size = httpReader.data.length;\n\t}\n}\n\nasync function getContentLength(httpReader, sendRequest, getRequestData) {\n\tif (httpReader.preventHeadRequest) {\n\t\tawait getRequestData(httpReader, httpReader.options);\n\t} else {\n\t\tconst response = await sendRequest(HTTP_METHOD_HEAD, httpReader, getHeaders(httpReader));\n\t\tconst contentLength = response.headers.get(HTTP_HEADER_CONTENT_LENGTH);\n\t\tif (contentLength) {\n\t\t\thttpReader.size = Number(contentLength);\n\t\t} else {\n\t\t\tawait getRequestData(httpReader, httpReader.options);\n\t\t}\n\t}\n}\n\nasync function sendFetchRequest(method, { options, url }, headers) {\n\tconst response = await fetch(url, Object.assign({}, options, { method, headers }));\n\tif (response.status < 400) {\n\t\treturn response;\n\t} else {\n\t\tthrow response.status == 416 ? new Error(ERR_HTTP_RANGE) : new Error(ERR_HTTP_STATUS + (response.statusText || response.status));\n\t}\n}\n\nfunction sendXMLHttpRequest(method, { url }, headers) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst request = new XMLHttpRequest();\n\t\trequest.addEventListener(\"load\", () => {\n\t\t\tif (request.status < 400) {\n\t\t\t\tconst headers = [];\n\t\t\t\trequest.getAllResponseHeaders().trim().split(/[\\r\\n]+/).forEach(header => {\n\t\t\t\t\tconst splitHeader = header.trim().split(/\\s*:\\s*/);\n\t\t\t\t\tsplitHeader[0] = splitHeader[0].trim().replace(/^[a-z]|-[a-z]/g, value => value.toUpperCase());\n\t\t\t\t\theaders.push(splitHeader);\n\t\t\t\t});\n\t\t\t\tresolve({\n\t\t\t\t\tstatus: request.status,\n\t\t\t\t\tarrayBuffer: () => request.response,\n\t\t\t\t\theaders: new Map(headers)\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treject(request.status == 416 ? new Error(ERR_HTTP_RANGE) : new Error(ERR_HTTP_STATUS + (request.statusText || request.status)));\n\t\t\t}\n\t\t}, false);\n\t\trequest.addEventListener(\"error\", event => reject(event.detail.error), false);\n\t\trequest.open(method, url);\n\t\tif (headers) {\n\t\t\tfor (const entry of Object.entries(headers)) {\n\t\t\t\trequest.setRequestHeader(entry[0], entry[1]);\n\t\t\t}\n\t\t}\n\t\trequest.responseType = \"arraybuffer\";\n\t\trequest.send();\n\t});\n}\n\nclass HttpReader extends Reader {\n\n\tconstructor(url, options = {}) {\n\t\tsuper();\n\t\tconst reader = this;\n\t\treader.url = url;\n\t\treader.reader = options.useXHR ? new XHRReader(url, options) : new FetchReader(url, options);\n\t}\n\n\tset size(value) {\n\t\t// ignored\n\t}\n\n\tget size() {\n\t\treturn this.reader.size;\n\t}\n\n\tasync init() {\n\t\tsuper.init();\n\t\tawait this.reader.init();\n\t}\n\n\treadUint8Array(index, length) {\n\t\treturn this.reader.readUint8Array(index, length);\n\t}\n}\n\nclass HttpRangeReader extends HttpReader {\n\n\tconstructor(url, options = {}) {\n\t\toptions.useRangeHeader = true;\n\t\tsuper(url, options);\n\t}\n}\n\n\nclass Uint8ArrayReader extends Reader {\n\n\tconstructor(array) {\n\t\tsuper();\n\t\tthis.array = array;\n\t\tthis.size = array.length;\n\t}\n\n\treadUint8Array(index, length) {\n\t\treturn this.array.slice(index, index + length);\n\t}\n}\n\nclass Uint8ArrayWriter extends Writer {\n\n\tinit(initSize = 0) {\n\t\tsuper.init();\n\t\tconst writer = this;\n\t\twriter.offset = 0;\n\t\twriter.array = new Uint8Array(initSize);\n\t}\n\n\twriteUint8Array(array) {\n\t\tconst writer = this;\n\t\tif (writer.offset + array.length > writer.array.length) {\n\t\t\tconst previousArray = writer.array;\n\t\t\twriter.array = new Uint8Array(previousArray.length + array.length);\n\t\t\twriter.array.set(previousArray);\n\t\t}\n\t\twriter.array.set(array, writer.offset);\n\t\twriter.offset += array.length;\n\t}\n\n\tgetData() {\n\t\treturn this.array;\n\t}\n}\n\nfunction isHttpFamily(url) {\n\tconst { baseURL } = getConfiguration();\n\tconst { protocol } = new URL(url, baseURL);\n\treturn protocol == \"http:\" || protocol == \"https:\";\n}\n\nasync function initStream(stream, initSize) {\n\tif (stream.init && !stream.initialized) {\n\t\tawait stream.init(initSize);\n\t}\n}\n\nexport {\n\tinitStream,\n\tReader,\n\tWriter,\n\tTextReader,\n\tTextWriter,\n\tData64URIReader,\n\tData64URIWriter,\n\tBlobReader,\n\tBlobWriter,\n\tUint8ArrayReader,\n\tUint8ArrayWriter,\n\tHttpReader,\n\tHttpRangeReader,\n\tERR_HTTP_RANGE\n};","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nconst MAX_32_BITS = 0xffffffff;\nconst MAX_16_BITS = 0xffff;\nconst COMPRESSION_METHOD_DEFLATE = 0x08;\nconst COMPRESSION_METHOD_STORE = 0x00;\nconst COMPRESSION_METHOD_AES = 0x63;\n\nconst LOCAL_FILE_HEADER_SIGNATURE = 0x04034b50;\nconst DATA_DESCRIPTOR_RECORD_SIGNATURE = 0x08074b50;\nconst CENTRAL_FILE_HEADER_SIGNATURE = 0x02014b50;\nconst END_OF_CENTRAL_DIR_SIGNATURE = 0x06054b50;\nconst ZIP64_END_OF_CENTRAL_DIR_SIGNATURE = 0x06064b50;\nconst ZIP64_END_OF_CENTRAL_DIR_LOCATOR_SIGNATURE = 0x07064b50;\nconst END_OF_CENTRAL_DIR_LENGTH = 22;\nconst ZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH = 20;\nconst ZIP64_END_OF_CENTRAL_DIR_LENGTH = 56;\nconst ZIP64_END_OF_CENTRAL_DIR_TOTAL_LENGTH = END_OF_CENTRAL_DIR_LENGTH + ZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH + ZIP64_END_OF_CENTRAL_DIR_LENGTH;\n\nconst ZIP64_TOTAL_NUMBER_OF_DISKS = 1;\n\nconst EXTRAFIELD_TYPE_ZIP64 = 0x0001;\nconst EXTRAFIELD_TYPE_AES = 0x9901;\nconst EXTRAFIELD_TYPE_NTFS = 0x000a;\nconst EXTRAFIELD_TYPE_NTFS_TAG1 = 0x0001;\nconst EXTRAFIELD_TYPE_EXTENDED_TIMESTAMP = 0x5455;\nconst EXTRAFIELD_TYPE_UNICODE_PATH = 0x7075;\nconst EXTRAFIELD_TYPE_UNICODE_COMMENT = 0x6375;\n\nconst BITFLAG_ENCRYPTED = 0x01;\nconst BITFLAG_LEVEL = 0x06;\nconst BITFLAG_DATA_DESCRIPTOR = 0x0008;\nconst BITFLAG_LANG_ENCODING_FLAG = 0x0800;\nconst FILE_ATTR_MSDOS_DIR_MASK = 0x10;\n\nconst VERSION_DEFLATE = 0x14;\nconst VERSION_ZIP64 = 0x2D;\nconst VERSION_AES = 0x33;\n\nconst DIRECTORY_SIGNATURE = \"/\";\n\nconst MAX_DATE = new Date(2107, 11, 31);\nconst MIN_DATE = new Date(1980, 0, 1);\n\nexport {\n\tMAX_32_BITS,\n\tMAX_16_BITS,\n\tCOMPRESSION_METHOD_DEFLATE,\n\tCOMPRESSION_METHOD_STORE,\n\tCOMPRESSION_METHOD_AES,\n\tLOCAL_FILE_HEADER_SIGNATURE,\n\tDATA_DESCRIPTOR_RECORD_SIGNATURE,\n\tCENTRAL_FILE_HEADER_SIGNATURE,\n\tEND_OF_CENTRAL_DIR_SIGNATURE,\n\tZIP64_END_OF_CENTRAL_DIR_LOCATOR_SIGNATURE,\n\tZIP64_END_OF_CENTRAL_DIR_SIGNATURE,\n\tEXTRAFIELD_TYPE_ZIP64,\n\tEXTRAFIELD_TYPE_AES,\n\tEXTRAFIELD_TYPE_NTFS,\n\tEXTRAFIELD_TYPE_NTFS_TAG1,\n\tEXTRAFIELD_TYPE_EXTENDED_TIMESTAMP,\n\tEXTRAFIELD_TYPE_UNICODE_PATH,\n\tEXTRAFIELD_TYPE_UNICODE_COMMENT,\n\tEND_OF_CENTRAL_DIR_LENGTH,\n\tZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH,\n\tZIP64_END_OF_CENTRAL_DIR_LENGTH,\n\tZIP64_END_OF_CENTRAL_DIR_TOTAL_LENGTH,\n\tZIP64_TOTAL_NUMBER_OF_DISKS,\n\tBITFLAG_ENCRYPTED,\n\tBITFLAG_LEVEL,\n\tBITFLAG_DATA_DESCRIPTOR,\n\tBITFLAG_LANG_ENCODING_FLAG,\n\tFILE_ATTR_MSDOS_DIR_MASK,\n\tVERSION_DEFLATE,\n\tVERSION_ZIP64,\n\tVERSION_AES,\n\tDIRECTORY_SIGNATURE,\n\tMIN_DATE,\n\tMAX_DATE\n};","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* global TextDecoder */\n\nimport { decodeCP437 } from \"./cp437-decode.js\";\n\nexport {\n\tdecodeText\n};\n\nfunction decodeText(value, encoding) {\n\tif (encoding && encoding.trim().toLowerCase() == \"cp437\") {\n\t\treturn decodeCP437(value);\n\t} else {\n\t\treturn new TextDecoder(encoding).decode(value);\n\t}\n}","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nconst PROPERTY_NAMES = [\n\t\"filename\", \"rawFilename\", \"directory\", \"encrypted\", \"compressedSize\", \"uncompressedSize\",\n\t\"lastModDate\", \"rawLastModDate\", \"comment\", \"rawComment\", \"signature\", \"extraField\",\n\t\"rawExtraField\", \"bitFlag\", \"extraFieldZip64\", \"extraFieldUnicodePath\", \"extraFieldUnicodeComment\",\n\t\"extraFieldAES\", \"filenameUTF8\", \"commentUTF8\", \"offset\", \"zip64\", \"compressionMethod\",\n\t\"extraFieldNTFS\", \"lastAccessDate\", \"creationDate\", \"extraFieldExtendedTimestamp\",\n\t\"version\", \"versionMadeBy\", \"msDosCompatible\", \"internalFileAttribute\", \"externalFileAttribute\"];\n\nclass Entry {\n\n\tconstructor(data) {\n\t\tPROPERTY_NAMES.forEach(name => this[name] = data[name]);\n\t}\n\n}\n\nexport {\n\tEntry\n};","/*\n Copyright (c) 2022 Gildas Lormeau. All rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are met:\n\n 1. Redistributions of source code must retain the above copyright notice,\n this list of conditions and the following disclaimer.\n\n 2. Redistributions in binary form must reproduce the above copyright \n notice, this list of conditions and the following disclaimer in \n the documentation and/or other materials provided with the distribution.\n\n 3. The names of the authors may not be used to endorse or promote products\n derived from this software without specific prior written permission.\n\n THIS SOFTWARE IS PROVIDED ''AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,\n INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,\n INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,\n INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* global BigInt, Response, ReadableStream, WritableStream */\n\nimport {\n\tMAX_32_BITS,\n\tMAX_16_BITS,\n\tCOMPRESSION_METHOD_DEFLATE,\n\tCOMPRESSION_METHOD_STORE,\n\tCOMPRESSION_METHOD_AES,\n\tLOCAL_FILE_HEADER_SIGNATURE,\n\tCENTRAL_FILE_HEADER_SIGNATURE,\n\tEND_OF_CENTRAL_DIR_SIGNATURE,\n\tZIP64_END_OF_CENTRAL_DIR_LOCATOR_SIGNATURE,\n\tZIP64_END_OF_CENTRAL_DIR_SIGNATURE,\n\tEXTRAFIELD_TYPE_ZIP64,\n\tEXTRAFIELD_TYPE_UNICODE_PATH,\n\tEXTRAFIELD_TYPE_UNICODE_COMMENT,\n\tEXTRAFIELD_TYPE_AES,\n\tEXTRAFIELD_TYPE_NTFS,\n\tEXTRAFIELD_TYPE_NTFS_TAG1,\n\tEXTRAFIELD_TYPE_EXTENDED_TIMESTAMP,\n\tEND_OF_CENTRAL_DIR_LENGTH,\n\tZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH,\n\tZIP64_END_OF_CENTRAL_DIR_LENGTH,\n\tBITFLAG_ENCRYPTED,\n\tBITFLAG_LEVEL,\n\tBITFLAG_DATA_DESCRIPTOR,\n\tBITFLAG_LANG_ENCODING_FLAG,\n\tFILE_ATTR_MSDOS_DIR_MASK,\n\tDIRECTORY_SIGNATURE\n} from \"./constants.js\";\nimport {\n\tgetConfiguration,\n\tgetChunkSize\n} from \"./configuration.js\";\nimport {\n\trunWorker,\n\tCODEC_INFLATE,\n\tERR_INVALID_SIGNATURE,\n\tERR_INVALID_PASSWORD\n} from \"./codec-pool.js\";\nimport {\n\tinitStream,\n\tBlobReader\n} from \"./io.js\";\nimport { decodeText } from \"./util/decode-text.js\";\nimport { Crc32 } from \"./streams/codecs/crc32.js\";\nimport { Entry } from \"./zip-entry.js\";\n\nconst ERR_BAD_FORMAT = \"File format is not recognized\";\nconst ERR_EOCDR_NOT_FOUND = \"End of central directory not found\";\nconst ERR_EOCDR_ZIP64_NOT_FOUND = \"End of Zip64 central directory not found\";\nconst ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND = \"End of Zip64 central directory locator not found\";\nconst ERR_CENTRAL_DIRECTORY_NOT_FOUND = \"Central directory header not found\";\nconst ERR_LOCAL_FILE_HEADER_NOT_FOUND = \"Local file header not found\";\nconst ERR_EXTRAFIELD_ZIP64_NOT_FOUND = \"Zip64 extra field not found\";\nconst ERR_ENCRYPTED = \"File contains encrypted entry\";\nconst ERR_UNSUPPORTED_ENCRYPTION = \"Encryption method not supported\";\nconst ERR_UNSUPPORTED_COMPRESSION = \"Compression method not supported\";\nconst CHARSET_UTF8 = \"utf-8\";\nconst CHARSET_CP437 = \"cp437\";\nconst ZIP64_PROPERTIES = [\"uncompressedSize\", \"compressedSize\", \"offset\"];\n\nclass ZipReader {\n\n\tconstructor(reader, options = {}) {\n\t\tif (reader instanceof ReadableStream) {\n\t\t\treader = {\n\t\t\t\treadable: reader\n\t\t\t};\n\t\t}\n\t\tObject.assign(this, {\n\t\t\treader,\n\t\t\toptions,\n\t\t\tconfig: getConfiguration()\n\t\t});\n\t}\n\n\tasync* getEntriesGenerator(options = {}) {\n\t\tconst zipReader = this;\n\t\tlet { reader } = zipReader;\n\t\tconst { config } = zipReader;\n\t\tawait initStream(reader);\n\t\tif (reader.size === undefined || !reader.readUint8Array) {\n\t\t\tconst blob = await new Response(reader.readable).blob();\n\t\t\treader = new BlobReader(blob);\n\t\t}\n\t\tif (reader.size < END_OF_CENTRAL_DIR_LENGTH) {\n\t\t\tthrow new Error(ERR_BAD_FORMAT);\n\t\t}\n\t\treader.chunkSize = getChunkSize(config);\n\t\tconst endOfDirectoryInfo = await seekSignature(reader, END_OF_CENTRAL_DIR_SIGNATURE, reader.size, END_OF_CENTRAL_DIR_LENGTH, MAX_16_BITS * 16);\n\t\tif (!endOfDirectoryInfo) {\n\t\t\tthrow new Error(ERR_EOCDR_NOT_FOUND);\n\t\t}\n\t\tconst endOfDirectoryView = getDataView(endOfDirectoryInfo);\n\t\tlet directoryDataLength = getUint32(endOfDirectoryView, 12);\n\t\tlet directoryDataOffset = getUint32(endOfDirectoryView, 16);\n\t\tconst commentOffset = endOfDirectoryInfo.offset;\n\t\tconst commentLength = getUint16(endOfDirectoryView, 20);\n\t\tconst appendedDataOffset = commentOffset + END_OF_CENTRAL_DIR_LENGTH + commentLength;\n\t\tlet filesLength = getUint16(endOfDirectoryView, 8);\n\t\tlet prependedDataLength = 0;\n\t\tlet startOffset = 0;\n\t\tif (directoryDataOffset == MAX_32_BITS || directoryDataLength == MAX_32_BITS || filesLength == MAX_16_BITS) {\n\t\t\tconst endOfDirectoryLocatorArray = await readUint8Array(reader, endOfDirectoryInfo.offset - ZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH, ZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH);\n\t\t\tconst endOfDirectoryLocatorView = getDataView(endOfDirectoryLocatorArray);\n\t\t\tif (getUint32(endOfDirectoryLocatorView, 0) != ZIP64_END_OF_CENTRAL_DIR_LOCATOR_SIGNATURE) {\n\t\t\t\tthrow new Error(ERR_EOCDR_ZIP64_NOT_FOUND);\n\t\t\t}\n\t\t\tdirectoryDataOffset = getBigUint64(endOfDirectoryLocatorView, 8);\n\t\t\tlet endOfDirectoryArray = await readUint8Array(reader, directoryDataOffset, ZIP64_END_OF_CENTRAL_DIR_LENGTH);\n\t\t\tlet endOfDirectoryView = getDataView(endOfDirectoryArray);\n\t\t\tconst expectedDirectoryDataOffset = endOfDirectoryInfo.offset - ZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH - ZIP64_END_OF_CENTRAL_DIR_LENGTH;\n\t\t\tif (getUint32(endOfDirectoryView, 0) != ZIP64_END_OF_CENTRAL_DIR_SIGNATURE && directoryDataOffset != expectedDirectoryDataOffset) {\n\t\t\t\tconst originalDirectoryDataOffset = directoryDataOffset;\n\t\t\t\tdirectoryDataOffset = expectedDirectoryDataOffset;\n\t\t\t\tprependedDataLength = directoryDataOffset - originalDirectoryDataOffset;\n\t\t\t\tendOfDirectoryArray = await readUint8Array(reader, directoryDataOffset, ZIP64_END_OF_CENTRAL_DIR_LENGTH);\n\t\t\t\tendOfDirectoryView = getDataView(endOfDirectoryArray);\n\t\t\t}\n\t\t\tif (getUint32(endOfDirectoryView, 0) != ZIP64_END_OF_CENTRAL_DIR_SIGNATURE) {\n\t\t\t\tthrow new Error(ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND);\n\t\t\t}\n\t\t\tfilesLength = getBigUint64(endOfDirectoryView, 32);\n\t\t\tdirectoryDataLength = getBigUint64(endOfDirectoryView, 40);\n\t\t\tdirectoryDataOffset -= directoryDataLength;\n\t\t}\n\t\tif (directoryDataOffset < 0 || directoryDataOffset >= reader.size) {\n\t\t\tthrow new Error(ERR_BAD_FORMAT);\n\t\t}\n\t\tlet offset = 0;\n\t\tlet directoryArray = await readUint8Array(reader, directoryDataOffset, directoryDataLength);\n\t\tlet directoryView = getDataView(directoryArray);\n\t\tif (directoryDataLength) {\n\t\t\tconst expectedDirectoryDataOffset = endOfDirectoryInfo.offset - directoryDataLength;\n\t\t\tif (getUint32(directoryView, offset) != CENTRAL_FILE_HEADER_SIGNATURE && directoryDataOffset != expectedDirectoryDataOffset) {\n\t\t\t\tconst originalDirectoryDataOffset = directoryDataOffset;\n\t\t\t\tdirectoryDataOffset = expectedDirectoryDataOffset;\n\t\t\t\tprependedDataLength = directoryDataOffset - originalDirectoryDataOffset;\n\t\t\t\tdirectoryArray = await readUint8Array(reader, directoryDataOffset, directoryDataLength);\n\t\t\t\tdirectoryView = getDataView(directoryArray);\n\t\t\t}\n\t\t}\n\t\tif (directoryDataOffset < 0 || directoryDataOffset >= reader.size) {\n\t\t\tthrow new Error(ERR_BAD_FORMAT);\n\t\t}\n\t\tconst filenameEncoding = getOptionValue(zipReader, options, \"filenameEncoding\");\n\t\tconst commentEncoding = getOptionValue(zipReader, options, \"commentEncoding\");\n\t\tfor (let indexFile = 0; indexFile < filesLength; indexFile++) {\n\t\t\tconst fileEntry = new ZipEntry(reader, config, zipReader.options);\n\t\t\tif (getUint32(directoryView, offset) != CENTRAL_FILE_HEADER_SIGNATURE) {\n\t\t\t\tthrow new Error(ERR_CENTRAL_DIRECTORY_NOT_FOUND);\n\t\t\t}\n\t\t\treadCommonHeader(fileEntry, directoryView, offset + 6);\n\t\t\tconst languageEncodingFlag = Boolean(fileEntry.bitFlag.languageEncodingFlag);\n\t\t\tconst filenameOffset = offset + 46;\n\t\t\tconst extraFieldOffset = filenameOffset + fileEntry.filenameLength;\n\t\t\tconst commentOffset = extraFieldOffset + fileEntry.extraFieldLength;\n\t\t\tconst versionMadeBy = getUint16(directoryView, offset + 4);\n\t\t\tconst msDosCompatible = (versionMadeBy & 0) == 0;\n\t\t\tconst rawFilename = directoryArray.subarray(filenameOffset, extraFieldOffset);\n\t\t\tconst commentLength = getUint16(directoryView, offset + 32);\n\t\t\tconst endOffset = commentOffset + commentLength;\n\t\t\tconst rawComment = directoryArray.subarray(commentOffset, endOffset);\n\t\t\tconst filenameUTF8 = languageEncodingFlag;\n\t\t\tconst commentUTF8 = languageEncodingFlag;\n\t\t\tconst directory = msDosCompatible && ((getUint8(directoryView, offset + 38) & FILE_ATTR_MSDOS_DIR_MASK) == FILE_ATTR_MSDOS_DIR_MASK);\n\t\t\tconst offsetFileEntry = getUint32(directoryView, offset + 42) + prependedDataLength;\n\t\t\tObject.assign(fileEntry, {\n\t\t\t\tversionMadeBy,\n\t\t\t\tmsDosCompatible,\n\t\t\t\tcompressedSize: 0,\n\t\t\t\tuncompressedSize: 0,\n\t\t\t\tcommentLength,\n\t\t\t\tdirectory,\n\t\t\t\toffset: offsetFileEntry,\n\t\t\t\tinternalFileAttribute: getUint16(directoryView, offset + 36),\n\t\t\t\texternalFileAttribute: getUint32(directoryView, offset + 38),\n\t\t\t\trawFilename,\n\t\t\t\tfilenameUTF8,\n\t\t\t\tcommentUTF8,\n\t\t\t\trawExtraField: directoryArray.subarray(extraFieldOffset, commentOffset)\n\t\t\t});\n\t\t\tconst [filename, comment] = await Promise.all([\n\t\t\t\tdecodeText(rawFilename, filenameUTF8 ? CHARSET_UTF8 : filenameEncoding || CHARSET_CP437),\n\t\t\t\tdecodeText(rawComment, commentUTF8 ? CHARSET_UTF8 : commentEncoding || CHARSET_CP437)\n\t\t\t]);\n\t\t\tObject.assign(fileEntry, {\n\t\t\t\trawComment,\n\t\t\t\tfilename,\n\t\t\t\tcomment,\n\t\t\t\tdirectory: directory || filename.endsWith(DIRECTORY_SIGNATURE)\n\t\t\t});\n\t\t\tstartOffset = Math.max(offsetFileEntry, startOffset);\n\t\t\tawait readCommonFooter(fileEntry, fileEntry, directoryView, offset + 6);\n\t\t\tconst entry = new Entry(fileEntry);\n\t\t\tentry.getData = (writer, options) => fileEntry.getData(writer, entry, options);\n\t\t\toffset = endOffset;\n\t\t\tconst { onprogress } = options;\n\t\t\tif (onprogress) {\n\t\t\t\ttry {\n\t\t\t\t\tawait onprogress(indexFile + 1, filesLength, new Entry(fileEntry));\n\t\t\t\t} catch (_error) {\n\t\t\t\t\t// ignored\n\t\t\t\t}\n\t\t\t}\n\t\t\tyield entry;\n\t\t}\n\t\tconst extractPrependedData = getOptionValue(zipReader, options, \"extractPrependedData\");\n\t\tconst extractAppendedData = getOptionValue(zipReader, options, \"extractAppendedData\");\n\t\tif (extractPrependedData) {\n\t\t\tzipReader.prependedData = startOffset > 0 ? await readUint8Array(reader, 0, startOffset) : new Uint8Array();\n\t\t}\n\t\tzipReader.comment = commentLength ? await readUint8Array(reader, commentOffset + END_OF_CENTRAL_DIR_LENGTH, commentLength) : new Uint8Array();\n\t\tif (extractAppendedData) {\n\t\t\tzipReader.appendedData = appendedDataOffset < reader.size ? await readUint8Array(reader, appendedDataOffset, reader.size - appendedDataOffset) : new Uint8Array();\n\t\t}\n\t\treturn true;\n\t}\n\n\tasync getEntries(options = {}) {\n\t\tconst entries = [];\n\t\tfor await (const entry of this.getEntriesGenerator(options)) {\n\t\t\tentries.push(entry);\n\t\t}\n\t\treturn entries;\n\t}\n\n\tasync close() {\n\t}\n}\n\nexport {\n\tZipReader,\n\tERR_BAD_FORMAT,\n\tERR_EOCDR_NOT_FOUND,\n\tERR_EOCDR_ZIP64_NOT_FOUND,\n\tERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND,\n\tERR_CENTRAL_DIRECTORY_NOT_FOUND,\n\tERR_LOCAL_FILE_HEADER_NOT_FOUND,\n\tERR_EXTRAFIELD_ZIP64_NOT_FOUND,\n\tERR_ENCRYPTED,\n\tERR_UNSUPPORTED_ENCRYPTION,\n\tERR_UNSUPPORTED_COMPRESSION,\n\tERR_INVALID_SIGNATURE,\n\tERR_INVALID_PASSWORD\n};\n\nclass ZipEntry {\n\n\tconstructor(reader, config, options) {\n\t\tObject.assign(this, {\n\t\t\treader,\n\t\t\tconfig,\n\t\t\toptions\n\t\t});\n\t}\n\n\tasync getData(writer, fileEntry, options = {}) {\n\t\tconst zipEntry = this;\n\t\tconst {\n\t\t\treader,\n\t\t\toffset,\n\t\t\textraFieldAES,\n\t\t\tcompressionMethod,\n\t\t\tconfig,\n\t\t\tbitFlag,\n\t\t\tsignature,\n\t\t\trawLastModDate,\n\t\t\tuncompressedSize,\n\t\t\tcompressedSize\n\t\t} = zipEntry;\n\t\tconst localDirectory = zipEntry.localDirectory = {};\n\t\tlet dataArray = await readUint8Array(reader, offset, 30);\n\t\tconst dataView = getDataView(dataArray);\n\t\tlet password = getOptionValue(zipEntry, options, \"password\");\n\t\tpassword = password && password.length && password;\n\t\tif (extraFieldAES) {\n\t\t\tif (extraFieldAES.originalCompressionMethod != COMPRESSION_METHOD_AES) {\n\t\t\t\tthrow new Error(ERR_UNSUPPORTED_COMPRESSION);\n\t\t\t}\n\t\t}\n\t\tif (compressionMethod != COMPRESSION_METHOD_STORE && compressionMethod != COMPRESSION_METHOD_DEFLATE) {\n\t\t\tthrow new Error(ERR_UNSUPPORTED_COMPRESSION);\n\t\t}\n\t\tif (getUint32(dataView, 0) != LOCAL_FILE_HEADER_SIGNATURE) {\n\t\t\tthrow new Error(ERR_LOCAL_FILE_HEADER_NOT_FOUND);\n\t\t}\n\t\treadCommonHeader(localDirectory, dataView, 4);\n\t\tdataArray = await readUint8Array(reader, offset, 30 + localDirectory.filenameLength + localDirectory.extraFieldLength);\n\t\tlocalDirectory.rawExtraField = dataArray.subarray(30 + localDirectory.filenameLength);\n\t\tawait readCommonFooter(zipEntry, localDirectory, dataView, 4);\n\t\tObject.assign(fileEntry, {\n\t\t\tlastAccessDate: localDirectory.lastAccessDate,\n\t\t\tcreationDate: localDirectory.creationDate\n\t\t});\n\t\tconst encrypted = zipEntry.encrypted && localDirectory.encrypted;\n\t\tconst zipCrypto = encrypted && !extraFieldAES;\n\t\tif (encrypted) {\n\t\t\tif (!zipCrypto && extraFieldAES.strength === undefined) {\n\t\t\t\tthrow new Error(ERR_UNSUPPORTED_ENCRYPTION);\n\t\t\t} else if (!password) {\n\t\t\t\tthrow new Error(ERR_ENCRYPTED);\n\t\t\t}\n\t\t}\n\t\tconst dataOffset = offset + 30 + localDirectory.filenameLength + localDirectory.extraFieldLength;\n\t\tconst readable = reader.readable;\n\t\treadable.offset = dataOffset;\n\t\tconst size = readable.size = compressedSize;\n\t\tif (writer instanceof WritableStream) {\n\t\t\twriter = {\n\t\t\t\twritable: writer\n\t\t\t};\n\t\t}\n\t\tconst { writable } = writer;\n\t\tif (writable.size === undefined) {\n\t\t\twritable.size = 0;\n\t\t}\n\t\tconst signal = getOptionValue(zipEntry, options, \"signal\");\n\t\tconst preventClose = getOptionValue(zipEntry, options, \"preventClose\");\n\t\tawait initStream(writer, uncompressedSize);\n\t\tconst { onstart, onprogress, onend } = options;\n\t\tconst workerOptions = {\n\t\t\toptions: {\n\t\t\t\tcodecType: CODEC_INFLATE,\n\t\t\t\tpassword,\n\t\t\t\tzipCrypto,\n\t\t\t\tencryptionStrength: extraFieldAES && extraFieldAES.strength,\n\t\t\t\tsigned: getOptionValue(zipEntry, options, \"checkSignature\"),\n\t\t\t\tpasswordVerification: zipCrypto && (bitFlag.dataDescriptor ? ((rawLastModDate >>> 8) & 0xFF) : ((signature >>> 24) & 0xFF)),\n\t\t\t\tsignature,\n\t\t\t\tcompressed: compressionMethod != 0,\n\t\t\t\tencrypted,\n\t\t\t\tuseWebWorkers: getOptionValue(zipEntry, options, \"useWebWorkers\"),\n\t\t\t\tuseCompressionStream: getOptionValue(zipEntry, options, \"useCompressionStream\"),\n\t\t\t\ttransferStreams: getOptionValue(zipEntry, options, \"transferStreams\"),\n\t\t\t\tpreventClose\n\t\t\t},\n\t\t\tconfig,\n\t\t\tstreamOptions: { signal, size, onstart, onprogress, onend }\n\t\t};\n\t\twritable.size += (await runWorker({ readable, writable }, workerOptions)).size;\n\t\tif (!preventClose) {\n\t\t\ttry {\n\t\t\t\tawait writable.close();\n\t\t\t} catch (_error) {\n\t\t\t\t// ignored\n\t\t\t}\n\t\t}\n\t\treturn writer.getData ? writer.getData() : writable;\n\t}\n}\n\nfunction readCommonHeader(directory, dataView, offset) {\n\tconst rawBitFlag = directory.rawBitFlag = getUint16(dataView, offset + 2);\n\tconst encrypted = (rawBitFlag & BITFLAG_ENCRYPTED) == BITFLAG_ENCRYPTED;\n\tconst rawLastModDate = getUint32(dataView, offset + 6);\n\tObject.assign(directory, {\n\t\tencrypted,\n\t\tversion: getUint16(dataView, offset),\n\t\tbitFlag: {\n\t\t\tlevel: (rawBitFlag & BITFLAG_LEVEL) >> 1,\n\t\t\tdataDescriptor: (rawBitFlag & BITFLAG_DATA_DESCRIPTOR) == BITFLAG_DATA_DESCRIPTOR,\n\t\t\tlanguageEncodingFlag: (rawBitFlag & BITFLAG_LANG_ENCODING_FLAG) == BITFLAG_LANG_ENCODING_FLAG\n\t\t},\n\t\trawLastModDate,\n\t\tlastModDate: getDate(rawLastModDate),\n\t\tfilenameLength: getUint16(dataView, offset + 22),\n\t\textraFieldLength: getUint16(dataView, offset + 24)\n\t});\n}\n\nasync function readCommonFooter(fileEntry, directory, dataView, offset) {\n\tconst { rawExtraField } = directory;\n\tconst extraField = directory.extraField = new Map();\n\tconst rawExtraFieldView = getDataView(new Uint8Array(rawExtraField));\n\tlet offsetExtraField = 0;\n\ttry {\n\t\twhile (offsetExtraField < rawExtraField.length) {\n\t\t\tconst type = getUint16(rawExtraFieldView, offsetExtraField);\n\t\t\tconst size = getUint16(rawExtraFieldView, offsetExtraField + 2);\n\t\t\textraField.set(type, {\n\t\t\t\ttype,\n\t\t\t\tdata: rawExtraField.slice(offsetExtraField + 4, offsetExtraField + 4 + size)\n\t\t\t});\n\t\t\toffsetExtraField += 4 + size;\n\t\t}\n\t} catch (_error) {\n\t\t// ignored\n\t}\n\tconst compressionMethod = getUint16(dataView, offset + 4);\n\tObject.assign(directory, {\n\t\tsignature: getUint32(dataView, offset + 10),\n\t\tuncompressedSize: getUint32(dataView, offset + 18),\n\t\tcompressedSize: getUint32(dataView, offset + 14)\n\t});\n\tconst extraFieldZip64 = extraField.get(EXTRAFIELD_TYPE_ZIP64);\n\tif (extraFieldZip64) {\n\t\treadExtraFieldZip64(extraFieldZip64, directory);\n\t\tdirectory.extraFieldZip64 = extraFieldZip64;\n\t}\n\tconst extraFieldUnicodePath = extraField.get(EXTRAFIELD_TYPE_UNICODE_PATH);\n\tif (extraFieldUnicodePath) {\n\t\tawait readExtraFieldUnicode(extraFieldUnicodePath, \"filename\", \"rawFilename\", directory, fileEntry);\n\t\tdirectory.extraFieldUnicodePath = extraFieldUnicodePath;\n\t}\n\tconst extraFieldUnicodeComment = extraField.get(EXTRAFIELD_TYPE_UNICODE_COMMENT);\n\tif (extraFieldUnicodeComment) {\n\t\tawait readExtraFieldUnicode(extraFieldUnicodeComment, \"comment\", \"rawComment\", directory, fileEntry);\n\t\tdirectory.extraFieldUnicodeComment = extraFieldUnicodeComment;\n\t}\n\tconst extraFieldAES = extraField.get(EXTRAFIELD_TYPE_AES);\n\tif (extraFieldAES) {\n\t\treadExtraFieldAES(extraFieldAES, directory, compressionMethod);\n\t\tdirectory.extraFieldAES = extraFieldAES;\n\t} else {\n\t\tdirectory.compressionMethod = compressionMethod;\n\t}\n\tconst extraFieldNTFS = extraField.get(EXTRAFIELD_TYPE_NTFS);\n\tif (extraFieldNTFS) {\n\t\treadExtraFieldNTFS(extraFieldNTFS, directory);\n\t\tdirectory.extraFieldNTFS = extraFieldNTFS;\n\t}\n\tconst extraFieldExtendedTimestamp = extraField.get(EXTRAFIELD_TYPE_EXTENDED_TIMESTAMP);\n\tif (extraFieldExtendedTimestamp) {\n\t\treadExtraFieldExtendedTimestamp(extraFieldExtendedTimestamp, directory);\n\t\tdirectory.extraFieldExtendedTimestamp = extraFieldExtendedTimestamp;\n\t}\n}\n\nfunction readExtraFieldZip64(extraFieldZip64, directory) {\n\tdirectory.zip64 = true;\n\tconst extraFieldView = getDataView(extraFieldZip64.data);\n\textraFieldZip64.values = [];\n\tfor (let indexValue = 0; indexValue < Math.floor(extraFieldZip64.data.length / 8); indexValue++) {\n\t\textraFieldZip64.values.push(getBigUint64(extraFieldView, 0 + indexValue * 8));\n\t}\n\tconst missingProperties = ZIP64_PROPERTIES.filter(propertyName => directory[propertyName] == MAX_32_BITS);\n\tfor (let indexMissingProperty = 0; indexMissingProperty < missingProperties.length; indexMissingProperty++) {\n\t\textraFieldZip64[missingProperties[indexMissingProperty]] = extraFieldZip64.values[indexMissingProperty];\n\t}\n\tZIP64_PROPERTIES.forEach(propertyName => {\n\t\tif (directory[propertyName] == MAX_32_BITS) {\n\t\t\tif (extraFieldZip64[propertyName] !== undefined) {\n\t\t\t\tdirectory[propertyName] = extraFieldZip64[propertyName];\n\t\t\t} else {\n\t\t\t\tthrow new Error(ERR_EXTRAFIELD_ZIP64_NOT_FOUND);\n\t\t\t}\n\t\t}\n\t});\n}\n\nasync function readExtraFieldUnicode(extraFieldUnicode, propertyName, rawPropertyName, directory, fileEntry) {\n\tconst extraFieldView = getDataView(extraFieldUnicode.data);\n\tconst crc32 = new Crc32();\n\tcrc32.append(fileEntry[rawPropertyName]);\n\tconst dataViewSignature = getDataView(new Uint8Array(4));\n\tdataViewSignature.setUint32(0, crc32.get(), true);\n\tObject.assign(extraFieldUnicode, {\n\t\tversion: getUint8(extraFieldView, 0),\n\t\tsignature: getUint32(extraFieldView, 1),\n\t\t[propertyName]: await decodeText(extraFieldUnicode.data.subarray(5)),\n\t\tvalid: !fileEntry.bitFlag.languageEncodingFlag && extraFieldUnicode.signature == getUint32(dataViewSignature, 0)\n\t});\n\tif (extraFieldUnicode.valid) {\n\t\tdirectory[propertyName] = extraFieldUnicode[propertyName];\n\t\tdirectory[propertyName + \"UTF8\"] = true;\n\t}\n}\n\nfunction readExtraFieldAES(extraFieldAES, directory, compressionMethod) {\n\tconst extraFieldView = getDataView(extraFieldAES.data);\n\tconst strength = getUint8(extraFieldView, 4);\n\tObject.assign(extraFieldAES, {\n\t\tvendorVersion: getUint8(extraFieldView, 0),\n\t\tvendorId: getUint8(extraFieldView, 2),\n\t\tstrength,\n\t\toriginalCompressionMethod: compressionMethod,\n\t\tcompressionMethod: getUint16(extraFieldView, 5)\n\t});\n\tdirectory.compressionMethod = extraFieldAES.compressionMethod;\n}\n\nfunction readExtraFieldNTFS(extraFieldNTFS, directory) {\n\tconst extraFieldView = getDataView(extraFieldNTFS.data);\n\tlet offsetExtraField = 4;\n\tlet tag1Data;\n\ttry {\n\t\twhile (offsetExtraField < extraFieldNTFS.data.length && !tag1Data) {\n\t\t\tconst tagValue = getUint16(extraFieldView, offsetExtraField);\n\t\t\tconst attributeSize = getUint16(extraFieldView, offsetExtraField + 2);\n\t\t\tif (tagValue == EXTRAFIELD_TYPE_NTFS_TAG1) {\n\t\t\t\ttag1Data = extraFieldNTFS.data.slice(offsetExtraField + 4, offsetExtraField + 4 + attributeSize);\n\t\t\t}\n\t\t\toffsetExtraField += 4 + attributeSize;\n\t\t}\n\t} catch (_error) {\n\t\t// ignored\n\t}\n\ttry {\n\t\tif (tag1Data && tag1Data.length == 24) {\n\t\t\tconst tag1View = getDataView(tag1Data);\n\t\t\tconst rawLastModDate = tag1View.getBigUint64(0, true);\n\t\t\tconst rawLastAccessDate = tag1View.getBigUint64(8, true);\n\t\t\tconst rawCreationDate = tag1View.getBigUint64(16, true);\n\t\t\tObject.assign(extraFieldNTFS, {\n\t\t\t\trawLastModDate,\n\t\t\t\trawLastAccessDate,\n\t\t\t\trawCreationDate\n\t\t\t});\n\t\t\tconst lastModDate = getDateNTFS(rawLastModDate);\n\t\t\tconst lastAccessDate = getDateNTFS(rawLastAccessDate);\n\t\t\tconst creationDate = getDateNTFS(rawCreationDate);\n\t\t\tconst extraFieldData = { lastModDate, lastAccessDate, creationDate };\n\t\t\tObject.assign(extraFieldNTFS, extraFieldData);\n\t\t\tObject.assign(directory, extraFieldData);\n\t\t}\n\t} catch (_error) {\n\t\t// ignored\n\t}\n}\n\nfunction readExtraFieldExtendedTimestamp(extraFieldExtendedTimestamp, directory) {\n\tconst extraFieldView = getDataView(extraFieldExtendedTimestamp.data);\n\tconst flags = getUint8(extraFieldView, 0);\n\tconst timeProperties = [];\n\tconst timeRawProperties = [];\n\tif ((flags & 0x1) == 0x1) {\n\t\ttimeProperties.push(\"lastModDate\");\n\t\ttimeRawProperties.push(\"rawLastModDate\");\n\t}\n\tif ((flags & 0x2) == 0x2) {\n\t\ttimeProperties.push(\"lastAccessDate\");\n\t\ttimeRawProperties.push(\"rawLastAccessDate\");\n\t}\n\tif ((flags & 0x4) == 0x4) {\n\t\ttimeProperties.push(\"creationDate\");\n\t\ttimeRawProperties.push(\"rawCreationDate\");\n\t}\n\tlet offset = 1;\n\ttimeProperties.forEach((propertyName, indexProperty) => {\n\t\tif (extraFieldExtendedTimestamp.data.length >= offset + 4) {\n\t\t\tconst time = getUint32(extraFieldView, offset);\n\t\t\tdirectory[propertyName] = extraFieldExtendedTimestamp[propertyName] = new Date(time * 1000);\n\t\t\tconst rawPropertyName = timeRawProperties[indexProperty];\n\t\t\textraFieldExtendedTimestamp[rawPropertyName] = time;\n\t\t}\n\t\toffset += 4;\n\t});\n}\n\nasync function seekSignature(reader, signature, startOffset, minimumBytes, maximumLength) {\n\tconst signatureArray = new Uint8Array(4);\n\tconst signatureView = getDataView(signatureArray);\n\tsetUint32(signatureView, 0, signature);\n\tconst maximumBytes = minimumBytes + maximumLength;\n\treturn (await seek(minimumBytes)) || await seek(Math.min(maximumBytes, startOffset));\n\n\tasync function seek(length) {\n\t\tconst offset = startOffset - length;\n\t\tconst bytes = await readUint8Array(reader, offset, length);\n\t\tfor (let indexByte = bytes.length - minimumBytes; indexByte >= 0; indexByte--) {\n\t\t\tif (bytes[indexByte] == signatureArray[0] && bytes[indexByte + 1] == signatureArray[1] &&\n\t\t\t\tbytes[indexByte + 2] == signatureArray[2] && bytes[indexByte + 3] == signatureArray[3]) {\n\t\t\t\treturn {\n\t\t\t\t\toffset: offset + indexByte,\n\t\t\t\t\tbuffer: bytes.slice(indexByte, indexByte + minimumBytes).buffer\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getOptionValue(zipReader, options, name) {\n\treturn options[name] === undefined ? zipReader.options[name] : options[name];\n}\n\nfunction getDate(timeRaw) {\n\tconst date = (timeRaw & 0xffff0000) >> 16, time = timeRaw & 0x0000ffff;\n\ttry {\n\t\treturn new Date(1980 + ((date & 0xFE00) >> 9), ((date & 0x01E0) >> 5) - 1, date & 0x001F, (time & 0xF800) >> 11, (time & 0x07E0) >> 5, (time & 0x001F) * 2, 0);\n\t} catch (_error) {\n\t\t// ignored\n\t}\n}\n\nfunction getDateNTFS(timeRaw) {\n\treturn new Date((Number((timeRaw / BigInt(10000)) - BigInt(11644473600000))));\n}\n\nfunction getUint8(view, offset) {\n\treturn view.getUint8(offset);\n}\n\nfunction getUint16(view, offset) {\n\treturn view.getUint16(offset, true);\n}\n\nfunction getUint32(view, offset) {\n\treturn view.getUint32(offset, true);\n}\n\nfunction getBigUint64(view, offset) {\n\treturn Number(view.getBigUint64(offset, true));\n}\n\nfunction setUint32(view, offset, value) {\n\tview.setUint32(offset, value, true);\n}\n\nfunction getDataView(array) {\n\treturn new DataView(array.buffer);\n}\n\nfunction readUint8Array(reader, offset, size) {\n\treturn reader.readUint8Array(offset, size);\n}","import { BlobReader, BlobWriter, ZipReader } from \"@zip.js/zip.js\";\nimport { getZipData } from \"../courseware-converting\";\nimport { cachePPTConvert, contentType } from \"./utils\";\n\ntype PPTInfo = {\n    baseURL: string;\n    pptType: \"static\" | \"dynamic\";\n    taskUUID: string;\n};\n\nclass CoursewarePreloader {\n    public downloaders = new Map<string, Blob>();\n\n    public async preload(pptSrc: string): Promise<void> {\n        const pptInfo = CoursewarePreloader.parsePPTURLInfo(pptSrc);\n        const { baseURL, pptType, taskUUID } = pptInfo;\n\n        if (this.downloaders.has(taskUUID)) {\n            return;\n        }\n\n        const zipData = await getZipData(pptInfo);\n\n        this.downloaders.set(taskUUID, zipData);\n\n        const resourceUrlPrefix = `${baseURL}/${pptType}Convert`;\n\n        return CoursewarePreloader.unzip(zipData, resourceUrlPrefix);\n    }\n\n    public static parsePPTURLInfo(pptSrc: string): PPTInfo {\n        const pptFiles = /^(\\S+)\\/(static|dynamic)Convert\\/([0-9a-f]{32})\\//.exec(pptSrc);\n        if (!pptFiles) {\n            throw new Error(\"parse ppt url failed.\");\n        }\n        const [, baseURL, pptType, taskUUID] = pptFiles;\n\n        return {\n            baseURL: baseURL.replace(/^pptx:\\/\\//, \"https://\"),\n            pptType: pptType as \"static\" | \"dynamic\",\n            taskUUID,\n        };\n    }\n\n    private static async unzip(zipData: Blob, resourceUrlPrefix: string): Promise<void> {\n        const reader = new ZipReader(new BlobReader(zipData));\n        const entries = await reader.getEntries();\n\n        for (const entry of entries) {\n            if (!entry.getData) {\n                continue;\n            }\n\n            // can't know if some .mp4 file in the cache is broken\n            // so we don't put in the cache\n            if (entry.filename.endsWith(\".mp4\")) {\n                continue;\n            }\n\n            const blob: Blob = await entry.getData(new BlobWriter());\n            const resourceUrl = `${resourceUrlPrefix}/${entry.filename}`;\n            await this.cacheEntry(resourceUrl, blob);\n        }\n    }\n\n    private static async cacheEntry(resourceUrl: string, blob: Blob): Promise<void> {\n        const flatCache = await cachePPTConvert();\n\n        const response = new Response(blob, {\n            headers: {\n                \"Content-Type\": contentType(resourceUrl),\n            },\n        });\n        void flatCache.put(resourceUrl, response);\n    }\n}\n\nexport const coursewarePreloader = new CoursewarePreloader();\n","import \"video.js/dist/video-js.css\";\n\nimport type { FastboardApp } from \"@netless/fastboard\";\nimport { FlatI18n } from \"@netless/flat-i18n\";\nimport { WindowManager } from \"@netless/window-manager\";\nimport { message } from \"antd\";\nimport { debounce } from \"lodash-es\";\nimport { makeAutoObservable, observable, runInAction } from \"mobx\";\nimport { AnimationMode, Room, RoomPhase, ViewMode } from \"white-web-sdk\";\nimport {\n    RoomType,\n    Region,\n    CloudFile,\n    FileConvertStep,\n    FileResourceType,\n} from \"@netless/flat-server-api\";\nimport { CloudStorageStore } from \"../cloud-storage-store\";\nimport { coursewarePreloader } from \"../utils/courseware-preloader\";\nimport { globalStore } from \"../global-store\";\nimport { ClassroomReplayEventData } from \"../classroom-store/event\";\nimport { FlatServices, IServiceWhiteboard } from \"@netless/flat-services\";\nimport { SideEffectManager } from \"side-effect-manager\";\nimport { preferencesStore } from \"../preferences-store\";\nimport { WHITEBOARD_RATIO } from \"../constants\";\n\nexport class WhiteboardStore {\n    public readonly sideEffect = new SideEffectManager();\n\n    public whiteboard: IServiceWhiteboard;\n    public fastboardAPP: FastboardApp<ClassroomReplayEventData> | null = null;\n    public room: Room | null = null;\n    public phase: RoomPhase = RoomPhase.Connecting;\n    public viewMode: ViewMode | null = null;\n    public windowManager: WindowManager | null = null;\n    public isWritable: boolean;\n    public allowDrawing: boolean;\n    public isShowPreviewPanel = false;\n    public isFileOpen = false;\n    public isKicked = false;\n    public isRightSideClose = false;\n    public currentSceneIndex = 0;\n    public scenesCount = 0;\n\n    /** is room Creator */\n    public readonly isCreator: boolean;\n    public readonly getRoomType: () => RoomType;\n    public readonly onDrop: (file: File) => void;\n\n    public readonly cloudStorageStore: CloudStorageStore;\n\n    public constructor(config: {\n        whiteboard: IServiceWhiteboard;\n        isCreator: boolean;\n        isWritable: boolean;\n        getRoomType: () => RoomType;\n        onDrop: (file: File) => void;\n    }) {\n        this.whiteboard = config.whiteboard;\n        this.isCreator = config.isCreator;\n        this.isWritable = config.isWritable;\n        this.allowDrawing = config.isWritable;\n        this.getRoomType = config.getRoomType;\n        this.onDrop = config.onDrop;\n\n        makeAutoObservable<this, \"preloadPPTResource\" | \"sideEffect\">(this, {\n            room: observable.ref,\n            preloadPPTResource: false,\n            fastboardAPP: false,\n            sideEffect: false,\n            whiteboard: false,\n        });\n\n        this.whiteboard.setIsWritable(this.isWritable);\n        this.whiteboard.setAllowDrawing(this.isWritable);\n\n        this.cloudStorageStore = new CloudStorageStore({\n            compact: true,\n            insertCourseware: this.insertCourseware,\n        });\n\n        this.sideEffect.push([\n            config.whiteboard.events.on(\"kicked\", () => {\n                // Kick in-room joiners when creator cancels room\n                // from the homepage list menu\n                // Room creator do not need to listen to this event\n                // as they are in control of exiting room.\n                // Listening to this may interrupt the stop room process.\n                if (!this.isCreator) {\n                    runInAction(() => {\n                        this.isKicked = true;\n                    });\n                }\n            }),\n            config.whiteboard.$Val.phase$.subscribe(() => {\n                const room = this.getRoom();\n                if (room) {\n                    runInAction(() => {\n                        this.phase = room.phase;\n                    });\n                }\n            }),\n        ]);\n    }\n\n    public updateFastboardAPP = (whiteboardApp: FastboardApp<ClassroomReplayEventData>): void => {\n        this.fastboardAPP = whiteboardApp;\n    };\n\n    public updateRoom = (room: Room): void => {\n        this.room = room;\n    };\n\n    public updateWindowManager = (manager: WindowManager): void => {\n        this.windowManager = manager;\n    };\n\n    public updateWritable = (isWritable: boolean): void => {\n        this.isWritable = isWritable;\n        this.whiteboard.setIsWritable(isWritable);\n    };\n\n    public updateAllowDrawing = (allowDrawing: boolean): void => {\n        this.allowDrawing = allowDrawing;\n        this.whiteboard.setAllowDrawing(allowDrawing);\n    };\n\n    public setFileOpen = (open: boolean): void => {\n        this.isFileOpen = open;\n    };\n\n    public toggleFileOpen = (): void => {\n        this.isFileOpen = !this.isFileOpen;\n    };\n\n    public showPreviewPanel = (): void => {\n        this.isShowPreviewPanel = true;\n    };\n\n    public setPreviewPanel = (show: boolean): void => {\n        this.isShowPreviewPanel = show;\n    };\n\n    public setRightSideClose = (close: boolean): void => {\n        this.isRightSideClose = close;\n    };\n\n    public async joinWhiteboardRoom(): Promise<FastboardApp<ClassroomReplayEventData>> {\n        if (!globalStore.userUUID) {\n            throw new Error(\"Missing userUUID\");\n        }\n\n        if (!globalStore.whiteboardRoomUUID || !globalStore.whiteboardRoomToken) {\n            throw new Error(\"Missing Whiteboard UUID and Token\");\n        }\n\n        await this.whiteboard.joinRoom({\n            roomID: globalStore.whiteboardRoomUUID,\n            roomToken: globalStore.whiteboardRoomToken,\n            region: globalStore.region ?? Region.CN_HZ,\n            uid: globalStore.userUUID,\n            nickName: globalStore.userInfo?.name ?? globalStore.userUUID,\n            classroomType: this.getRoomType(),\n            options: {\n                strokeTail: preferencesStore.strokeTail,\n                ratio: WHITEBOARD_RATIO,\n            },\n        });\n\n        // @TODO remove me after refactoring\n        const fastboardAPP = await (this.whiteboard as any)._app$.value;\n\n        this.updateFastboardAPP(fastboardAPP);\n\n        const { room, manager } = fastboardAPP;\n\n        this.updateRoom(room);\n\n        this.updateWindowManager(manager);\n\n        this.scrollToTopOnce();\n\n        if (process.env.DEV) {\n            (window as any).room = room;\n            (window as any).manager = manager;\n        }\n\n        return fastboardAPP;\n    }\n\n    private scrollToTopOnce(): void {\n        const { room, windowManager } = this;\n        if (!room || !windowManager) {\n            return;\n        }\n        if (!room.isWritable) {\n            return;\n        }\n        if (!room.state.globalState || !(room.state.globalState as any).scrollToTop) {\n            room.setGlobalState({ scrollToTop: true });\n            windowManager.moveCamera({ centerY: -950, animationMode: AnimationMode.Immediately });\n        }\n    }\n\n    public async destroy(): Promise<void> {\n        this.sideEffect.flushAll();\n        this.preloadPPTResource.cancel();\n        await this.whiteboard.destroy();\n\n        if (process.env.DEV) {\n            (window as any).room = null;\n            (window as any).manager = null;\n        }\n        console.log(`Whiteboard unloaded: ${globalStore.whiteboardRoomUUID}`);\n    }\n\n    private preloadPPTResource = debounce(async (pptSrc: string): Promise<void> => {\n        await coursewarePreloader.preload(pptSrc);\n    }, 2000);\n\n    public insertCourseware = async (file: CloudFile): Promise<void> => {\n        if (\n            (file.meta.whiteboardConvert || file.meta.whiteboardProjector)?.convertStep ===\n            FileConvertStep.Converting\n        ) {\n            void message.warn(FlatI18n.t(\"in-the-process-of-transcoding-tips\"));\n            return;\n        }\n\n        if (file.resourceType !== FileResourceType.Directory) {\n            void message.info(FlatI18n.t(\"inserting-courseware-tips\"));\n        }\n\n        const fileService = await FlatServices.getInstance().requestService(\"file\");\n        if (!fileService) {\n            void message.error(FlatI18n.t(\"unable-to-insert-courseware\"));\n            return;\n        }\n\n        await fileService.insert(file);\n\n        if (this.cloudStorageStore.onCoursewareInserted) {\n            this.cloudStorageStore.onCoursewareInserted();\n        }\n    };\n\n    public getSaveAnnotationImages(): Array<Promise<HTMLCanvasElement | null>> {\n        return this.whiteboard.exportAnnotations();\n    }\n\n    // @TODO remove me after refactoring\n    private getRoom(): Room | null {\n        return (this.whiteboard as any)._app$.value?.room ?? null;\n    }\n}\n","export enum ClassModeType {\n    Lecture = \"Lecture\",\n    Interaction = \"Interaction\",\n}\n\nexport enum RoomStatusLoadingType {\n    Null,\n    Starting,\n    Pausing,\n    Stopping,\n}\n","import type { Storage } from \"@netless/fastboard\";\n\nimport { SideEffectManager } from \"side-effect-manager\";\nimport { action, autorun, makeAutoObservable, observable, reaction, runInAction } from \"mobx\";\nimport {\n    pauseClass,\n    startClass,\n    stopClass,\n    generateRTCToken,\n    RoomStatus,\n    RoomType,\n    checkRTMCensor,\n} from \"@netless/flat-server-api\";\nimport { FlatI18n } from \"@netless/flat-i18n\";\nimport { errorTips, message } from \"flat-components\";\nimport { RoomItem, roomStore } from \"../room-store\";\nimport { User, UserStore } from \"../user-store\";\nimport { WhiteboardStore } from \"../whiteboard-store\";\nimport { globalStore } from \"../global-store\";\nimport { ClassModeType, RoomStatusLoadingType } from \"./constants\";\nimport { ChatStore } from \"./chat-store\";\nimport {\n    IServiceRecording,\n    IServiceShareScreenInfo,\n    IServiceTextChat,\n    IServiceVideoChat,\n    IServiceVideoChatMode,\n    IServiceVideoChatRole,\n    IServiceWhiteboard,\n} from \"@netless/flat-services\";\nimport { preferencesStore } from \"../preferences-store\";\n\nexport * from \"./constants\";\nexport * from \"./chat-store\";\n\nexport interface ClassroomStoreConfig {\n    roomUUID: string;\n    ownerUUID: string;\n    rtc: IServiceVideoChat;\n    rtm: IServiceTextChat;\n    whiteboard: IServiceWhiteboard;\n    recording: IServiceRecording;\n}\n\nexport type DeviceStateStorageState = Record<string, { camera: boolean; mic: boolean }>;\nexport type ClassroomStorageState = {\n    ban: boolean;\n    raiseHandUsers: string[];\n    shareScreen: boolean;\n};\nexport type OnStageUsersStorageState = Record<string, boolean>;\nexport type WhiteboardStorageState = Record<string, boolean>;\nexport type UserWindowsStorageState = {\n    grid: null | string[];\n};\n// stored in UserWindowsStorageState too, but TypeScript does not support union records\nexport type UserWindow = {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n    z: number;\n};\n\nexport class ClassroomStore {\n    private readonly sideEffect = new SideEffectManager();\n\n    public readonly roomUUID: string;\n    public readonly ownerUUID: string;\n    /** User uuid of the current user */\n    public readonly userUUID: string;\n    /** room class mode */\n    public classMode: ClassModeType;\n    /** is creator temporary banned room for joiner operations */\n    public isBan = false;\n    /** is Cloud Recording on */\n    public isRecording = false;\n    /** is toggling cloud recording */\n    public isRecordingLoading = false;\n    /** is user login on other device */\n    public isRemoteLogin = false;\n    /** is being requested for turning on device */\n    public isRequestingCamera = false;\n    public isRequestingMic = false;\n\n    public isCloudStoragePanelVisible = false;\n    public isHandRaisingPanelVisible = false;\n    public isUsersPanelVisible = false;\n\n    public isDraggingAvatar = false;\n    public droppingUserUUID: string | null = null;\n\n    public roomStatusLoading = RoomStatusLoadingType.Null;\n\n    /** is RTC joined room */\n    public isJoinedRTC = false;\n\n    /** is current user sharing screen */\n    public isScreenSharing = false;\n    /** is other users sharing screen */\n    public isRemoteScreenSharing = false;\n    /** (electron only) */\n    public shareScreenInfo: IServiceShareScreenInfo[] = [];\n\n    public selectedScreenInfo: IServiceShareScreenInfo | null = null;\n\n    public shareScreenPickerVisible = false;\n\n    public networkQuality = {\n        delay: 0,\n        uplink: 0,\n        downlink: 0,\n    };\n\n    /** will never be empty array [] */\n    public userWindowsGrid: string[] | null = null;\n    public readonly userWindows = observable.map<string, UserWindow>();\n    public readonly userWindowsPortal = observable.map<string, HTMLDivElement>();\n\n    public deviceStateStorage?: Storage<DeviceStateStorageState>;\n    public classroomStorage?: Storage<ClassroomStorageState>;\n    public onStageUsersStorage?: Storage<OnStageUsersStorageState>;\n    /** users that can operate the whiteboard */\n    public whiteboardStorage?: Storage<WhiteboardStorageState>;\n    public userWindowsStorage?: Storage<UserWindowsStorageState>;\n\n    public readonly users: UserStore;\n\n    public readonly onStageUserUUIDs = observable.array<string>();\n\n    public readonly rtc: IServiceVideoChat;\n    public readonly rtm: IServiceTextChat;\n    public readonly chatStore: ChatStore;\n    public readonly whiteboardStore: WhiteboardStore;\n    public readonly recording: IServiceRecording;\n\n    public constructor(config: ClassroomStoreConfig) {\n        if (!globalStore.userUUID) {\n            throw new Error(\"Missing user uuid\");\n        }\n\n        (window as any).classroomStore = this;\n\n        this.roomUUID = config.roomUUID;\n        this.ownerUUID = config.ownerUUID;\n        this.userUUID = globalStore.userUUID;\n        this.classMode = ClassModeType.Lecture;\n        this.rtc = config.rtc;\n        this.rtm = config.rtm;\n        this.recording = config.recording;\n\n        this.chatStore = new ChatStore({\n            roomUUID: this.roomUUID,\n            ownerUUID: this.ownerUUID,\n            rtm: this.rtm,\n            isShowUserGuide: globalStore.isShowGuide,\n        });\n\n        this.users = new UserStore({\n            roomUUID: this.roomUUID,\n            ownerUUID: this.ownerUUID,\n            userUUID: this.userUUID,\n            isInRoom: userUUID => this.rtm.members.has(userUUID),\n        });\n\n        this.whiteboardStore = new WhiteboardStore({\n            isCreator: this.isCreator,\n            isWritable: this.isCreator,\n            getRoomType: () => this.roomInfo?.roomType || RoomType.BigClass,\n            whiteboard: config.whiteboard,\n            onDrop: this.onDrop,\n        });\n\n        makeAutoObservable<this, \"sideEffect\">(this, {\n            rtc: observable.ref,\n            rtm: observable.ref,\n            sideEffect: false,\n            deviceStateStorage: false,\n            classroomStorage: false,\n            onStageUsersStorage: false,\n            shareScreenInfo: observable.ref,\n        });\n\n        this.sideEffect.addDisposer(\n            this.recording.$Val.isRecording$.subscribe(isRecording => {\n                runInAction(() => {\n                    this.isRecording = isRecording;\n                });\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            reaction(\n                () => this.isRecording,\n                (isRecording: boolean) => {\n                    if (isRecording) {\n                        void message.success(FlatI18n.t(\"start-recording\"));\n                    }\n                },\n            ),\n        );\n\n        this.sideEffect.addDisposer(\n            this.rtm.events.on(\n                \"remote-login\",\n                action(\"remote-login\", () => {\n                    this.isRemoteLogin = true;\n                }),\n            ),\n        );\n\n        if (!this.isCreator) {\n            this.sideEffect.addDisposer(\n                this.rtm.events.on(\"update-room-status\", event => {\n                    if (event.roomUUID === this.roomUUID && event.senderID === this.ownerUUID) {\n                        this.updateRoomStatus(event.status);\n                    }\n                }),\n            );\n\n            this.sideEffect.addDisposer(\n                this.rtm.events.on(\"request-device\", event => {\n                    if (event.roomUUID === this.roomUUID && event.senderID === this.ownerUUID) {\n                        this.toggleRequestingDevice(\n                            event.deviceState.camera,\n                            event.deviceState.mic,\n                        );\n                    }\n                }),\n            );\n\n            this.sideEffect.addDisposer(\n                this.rtm.events.on(\"notify-device-off\", event => {\n                    if (event.roomUUID === this.roomUUID && event.senderID === this.ownerUUID) {\n                        if (event.deviceState.camera === false) {\n                            message.info(FlatI18n.t(\"teacher-has-turn-off-camera\"));\n                        }\n                        if (event.deviceState.mic === false) {\n                            message.info(FlatI18n.t(\"teacher-has-turn-off-mic\"));\n                        }\n                    }\n                }),\n            );\n        }\n\n        if (this.isCreator) {\n            this.sideEffect.addDisposer(\n                this.rtm.events.on(\"raise-hand\", message => {\n                    if (this.classroomStorage?.isWritable && this.roomUUID === message.roomUUID) {\n                        const isRaisingHand = this.classroomStorage.state.raiseHandUsers.some(\n                            userUUID => userUUID === message.userUUID,\n                        );\n                        if (message.raiseHand) {\n                            if (!isRaisingHand) {\n                                this.classroomStorage.setState({\n                                    raiseHandUsers: [\n                                        ...this.classroomStorage.state.raiseHandUsers,\n                                        message.userUUID,\n                                    ],\n                                });\n                            }\n                        } else {\n                            if (isRaisingHand) {\n                                this.classroomStorage.setState({\n                                    raiseHandUsers:\n                                        this.classroomStorage.state.raiseHandUsers.filter(\n                                            userUUID => userUUID !== message.userUUID,\n                                        ),\n                                });\n                            }\n                        }\n                    }\n                }),\n            );\n            this.sideEffect.addDisposer(\n                this.rtm.events.on(\"request-device-response\", event => {\n                    if (event.roomUUID === this.roomUUID) {\n                        const name = this.users.cachedUsers.get(event.userUUID)?.name;\n                        if (event.deviceState.camera === false) {\n                            message.info(FlatI18n.t(\"refuse-to-turn-on-camera\", { name }));\n                        }\n                        if (event.deviceState.mic === false) {\n                            message.info(FlatI18n.t(\"refuse-to-turn-on-mic\", { name }));\n                        }\n                    }\n                }),\n            );\n            this.sideEffect.addDisposer(\n                reaction(\n                    () => this.isScreenSharing || this.isRemoteScreenSharing,\n                    (shareScreen: boolean) => {\n                        if (this.classroomStorage?.isWritable) {\n                            this.classroomStorage.setState({\n                                shareScreen,\n                            });\n                        }\n                    },\n                ),\n            );\n        }\n    }\n\n    public get roomType(): RoomType {\n        return this.roomInfo?.roomType ?? RoomType.BigClass;\n    }\n\n    public get roomInfo(): RoomItem | undefined {\n        return roomStore.rooms.get(this.roomUUID);\n    }\n\n    public get isCreator(): boolean {\n        return this.ownerUUID === this.userUUID;\n    }\n\n    public get roomStatus(): RoomStatus {\n        if (this.whiteboardStore.isKicked) {\n            return RoomStatus.Stopped;\n        }\n        return this.roomInfo?.roomStatus ?? RoomStatus.Idle;\n    }\n\n    public get firstOnStageUser(): User | undefined {\n        return this.onStageUserUUIDs.length > 0\n            ? this.users.cachedUsers.get(this.onStageUserUUIDs[0])\n            : undefined;\n    }\n\n    public get offlineJoiners(): User[] {\n        const result: User[] = [];\n        for (const user of this.users.cachedUsers.values()) {\n            if (this.onStageUserUUIDs.includes(user.userUUID) && user.hasLeft) {\n                result.push(user);\n            }\n        }\n        return result;\n    }\n\n    public get userWindowsMode(): \"normal\" | \"maximized\" {\n        return this.userWindowsGrid ? \"maximized\" : \"normal\";\n    }\n\n    private emptyArrayAsNull<T>(a: T[] | null): T[] | null {\n        return a && a.length > 0 ? a : null;\n    }\n\n    public async init(): Promise<void> {\n        await roomStore.syncOrdinaryRoomInfo(this.roomUUID);\n\n        if (process.env.NODE_ENV === \"development\") {\n            if (this.roomInfo && this.roomInfo.ownerUUID !== this.ownerUUID) {\n                (this.ownerUUID as string) = this.roomInfo.ownerUUID;\n                if (process.env.DEV) {\n                    console.error(new Error(\"ClassRoom Error: ownerUUID mismatch!\"));\n                }\n            }\n        }\n\n        await this.initRTC();\n\n        await this.rtm.joinRoom({\n            roomUUID: this.roomUUID,\n            ownerUUID: this.ownerUUID,\n            uid: this.userUUID,\n            token: globalStore.rtmToken,\n        });\n\n        const fastboard = await this.whiteboardStore.joinWhiteboardRoom();\n\n        await this.users.initUsers([...this.rtm.members]);\n\n        const deviceStateStorage = fastboard.syncedStore.connectStorage<DeviceStateStorageState>(\n            \"deviceState\",\n            {},\n        );\n        const classroomStorage = fastboard.syncedStore.connectStorage<ClassroomStorageState>(\n            \"classroom\",\n            {\n                ban: false,\n                raiseHandUsers: [],\n                shareScreen: false,\n            },\n        );\n        const onStageUsersStorage = fastboard.syncedStore.connectStorage<OnStageUsersStorageState>(\n            \"onStageUsers\",\n            {},\n        );\n        const whiteboardStorage = fastboard.syncedStore.connectStorage<WhiteboardStorageState>(\n            \"whiteboard\",\n            {},\n        );\n        const userWindowsStorage = fastboard.syncedStore.connectStorage<UserWindowsStorageState>(\n            \"userWindows\",\n            { grid: null },\n        );\n        this.deviceStateStorage = deviceStateStorage;\n        this.classroomStorage = classroomStorage;\n        this.onStageUsersStorage = onStageUsersStorage;\n        this.whiteboardStorage = whiteboardStorage;\n        this.userWindowsStorage = userWindowsStorage;\n\n        if (this.isCreator) {\n            this.updateDeviceState(\n                this.userUUID,\n                Boolean(preferencesStore.autoCameraOn),\n                Boolean(preferencesStore.autoMicOn),\n            );\n        } else {\n            this.whiteboardStore.updateWritable(\n                Boolean(\n                    onStageUsersStorage.state[this.userUUID] ||\n                        whiteboardStorage.state[this.userUUID],\n                ),\n            );\n            this.whiteboardStore.updateAllowDrawing(whiteboardStorage.state[this.userUUID]);\n        }\n\n        this.updateIsBan(classroomStorage.state.ban);\n\n        this.chatStore.onNewMessage = message => {\n            if (this.isRecording) {\n                fastboard.syncedStore.dispatchEvent(\"new-message\", message);\n            }\n        };\n\n        const raiseHandUsers = new Set<string>();\n        const updateRaiseHandUsers = (userUUIDs: ReadonlyArray<string> = []): void => {\n            raiseHandUsers.clear();\n            userUUIDs.forEach(userUUID => {\n                raiseHandUsers.add(userUUID);\n            });\n        };\n        updateRaiseHandUsers(classroomStorage.state.raiseHandUsers);\n\n        this.users.updateUsers(user => {\n            if (user.userUUID === this.ownerUUID || onStageUsersStorage.state[user.userUUID]) {\n                user.isSpeak = true;\n                user.isRaiseHand = false;\n                const deviceState = deviceStateStorage.state[user.userUUID];\n                if (deviceState) {\n                    user.camera = deviceState.camera;\n                    user.mic = deviceState.mic;\n                }\n            } else {\n                user.isSpeak = false;\n                user.mic = false;\n                user.camera = false;\n                user.isRaiseHand = raiseHandUsers.has(user.userUUID);\n            }\n            user.wbOperate = !!whiteboardStorage.state[user.userUUID];\n        });\n\n        this.sideEffect.addDisposer(\n            this.rtm.events.on(\"member-joined\", async ({ userUUID }) => {\n                await this.users.addUser(userUUID);\n                this.users.updateUsers(user => {\n                    if (user.userUUID === userUUID) {\n                        if (userUUID === this.ownerUUID || onStageUsersStorage.state[userUUID]) {\n                            user.isSpeak = true;\n                            user.wbOperate = !!whiteboardStorage.state[userUUID];\n                            user.isRaiseHand = false;\n                            const deviceState = deviceStateStorage.state[user.userUUID];\n                            if (deviceState) {\n                                user.camera = deviceState.camera;\n                                user.mic = deviceState.mic;\n                            } else {\n                                user.camera = false;\n                                user.mic = false;\n                            }\n                            return false;\n                        }\n                        // not on stage, but has whiteboard access\n                        if (whiteboardStorage.state[userUUID]) {\n                            user.wbOperate = true;\n                            return false;\n                        }\n                    }\n                    return true;\n                });\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            this.rtm.events.on(\"member-left\", ({ userUUID }) => {\n                this.users.removeUser(userUUID);\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            classroomStorage.on(\"stateChanged\", diff => {\n                if (diff.raiseHandUsers) {\n                    updateRaiseHandUsers(diff.raiseHandUsers.newValue);\n                    this.users.updateUsers(user => {\n                        user.isRaiseHand = raiseHandUsers.has(user.userUUID);\n                    });\n                }\n                if (diff.ban) {\n                    this.updateIsBan(diff.ban.newValue);\n                    if (this.isCreator) {\n                        this.rtm.sendRoomCommand(\"ban\", {\n                            roomUUID: this.roomUUID,\n                            status: diff.ban.newValue,\n                        });\n                    }\n                }\n            }),\n        );\n\n        const updateUserStagingState = async (): Promise<void> => {\n            const wasJoinerOnStage = this.onStageUserUUIDs.includes(this.userUUID);\n            const onStageUsers = Object.keys(onStageUsersStorage.state).filter(\n                userUUID => onStageUsersStorage.state[userUUID],\n            );\n            await this.users.syncExtraUsersInfo(onStageUsers);\n            runInAction(() => {\n                this.onStageUserUUIDs.replace(onStageUsers);\n            });\n            this.users.updateUsers(user => {\n                if (user.userUUID === this.ownerUUID) {\n                    return;\n                }\n                if (onStageUsersStorage.state[user.userUUID]) {\n                    user.isSpeak = true;\n                    user.isRaiseHand = false;\n                    const deviceState = deviceStateStorage.state[user.userUUID];\n                    if (deviceState) {\n                        user.camera = deviceState.camera;\n                        user.mic = deviceState.mic;\n                    } else {\n                        user.camera = false;\n                        user.mic = false;\n                    }\n                } else {\n                    user.isSpeak = false;\n                    user.mic = false;\n                    user.camera = false;\n                }\n            });\n\n            if (!this.isCreator) {\n                const isJoinerOnStage = Boolean(onStageUsersStorage.state[this.userUUID]);\n                this.whiteboardStore.updateWritable(\n                    Boolean(isJoinerOnStage || whiteboardStorage.state[this.userUUID]),\n                );\n                this.whiteboardStore.updateAllowDrawing(whiteboardStorage.state[this.userUUID]);\n\n                // @FIXME add reliable way to ensure writable is set\n                if (isJoinerOnStage && !fastboard.syncedStore.isRoomWritable) {\n                    await new Promise<void>(resolve => {\n                        const disposer = fastboard.syncedStore.addRoomWritableChangeListener(\n                            isWritable => {\n                                if (isWritable) {\n                                    disposer();\n                                    resolve();\n                                }\n                            },\n                        );\n                    });\n                }\n\n                if (!wasJoinerOnStage && isJoinerOnStage) {\n                    this.updateDeviceState(\n                        this.userUUID,\n                        preferencesStore.autoCameraOn,\n                        preferencesStore.autoMicOn,\n                    );\n                }\n\n                if (wasJoinerOnStage !== isJoinerOnStage) {\n                    message.info(FlatI18n.t(isJoinerOnStage ? \"stage-on\" : \"stage-off\"));\n                }\n            }\n        };\n        updateUserStagingState();\n\n        const initialUserWindows = new Map<string, UserWindow>();\n        for (const key in userWindowsStorage.state) {\n            if (key !== \"grid\") {\n                const userWindow: UserWindow | null = (userWindowsStorage.state as any)[key];\n                if (userWindow) {\n                    initialUserWindows.set(key, userWindow);\n                }\n            }\n        }\n        runInAction(() => {\n            this.userWindowsGrid = this.emptyArrayAsNull(userWindowsStorage.state.grid);\n            this.userWindows.replace(initialUserWindows);\n        });\n\n        this.sideEffect.addDisposer(onStageUsersStorage.on(\"stateChanged\", updateUserStagingState));\n        this.sideEffect.addDisposer(\n            whiteboardStorage.on(\"stateChanged\", () => {\n                this.users.updateUsers(user => {\n                    user.wbOperate =\n                        user.userUUID === this.ownerUUID ||\n                        !!whiteboardStorage.state[user.userUUID];\n                });\n                this.whiteboardStore.updateWritable(\n                    Boolean(\n                        this.isCreator ||\n                            onStageUsersStorage.state[this.userUUID] ||\n                            whiteboardStorage.state[this.userUUID],\n                    ),\n                );\n                this.whiteboardStore.updateAllowDrawing(\n                    this.isCreator || whiteboardStorage.state[this.userUUID],\n                );\n            }),\n        );\n        this.sideEffect.addDisposer(\n            userWindowsStorage.on(\"stateChanged\", diff => {\n                runInAction(() => {\n                    for (const key in diff) {\n                        if (key === \"grid\") {\n                            this.userWindowsGrid = this.emptyArrayAsNull(diff[key]!.newValue);\n                        } else {\n                            const userWindow: UserWindow | undefined = (diff as any)[key].newValue;\n                            if (userWindow) {\n                                this.userWindows.set(key, userWindow);\n                            } else {\n                                this.userWindows.delete(key);\n                            }\n                        }\n                    }\n                });\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            autorun(() => {\n                const users: Array<{ uid: string; avatar: string; isOwner: boolean }> = [];\n                const owner = this.users.cachedUsers.get(this.ownerUUID);\n                if (owner) {\n                    users.push({\n                        uid: owner.rtcUID,\n                        avatar: owner.avatar,\n                        isOwner: true,\n                    });\n                }\n                this.onStageUserUUIDs.forEach(userUUID => {\n                    const user = this.users.cachedUsers.get(userUUID);\n                    if (user) {\n                        users.push({\n                            uid: user.rtcUID,\n                            avatar: user.avatar,\n                            isOwner: userUUID === this.ownerUUID,\n                        });\n                    }\n                });\n                // sort creator to the first, then small uid to large uid\n                users.sort((a, b) =>\n                    a.isOwner ? -1 : b.isOwner ? 1 : (+a.uid | 0) - (+b.uid | 0),\n                );\n                this.updateRecordingLayout(users);\n            }),\n        );\n\n        this.sideEffect.addDisposer(\n            deviceStateStorage.on(\"stateChanged\", () => {\n                this.users.updateUsers(user => {\n                    const deviceState = deviceStateStorage.state[user.userUUID];\n                    if (deviceState) {\n                        user.camera = deviceState.camera;\n                        user.mic = deviceState.mic;\n                    } else {\n                        user.mic = false;\n                        user.camera = false;\n                    }\n                });\n            }),\n        );\n\n        if (this.roomType === RoomType.OneToOne) {\n            if (this.isCreator && this.roomStatus === RoomStatus.Idle) {\n                void this.startClass();\n            }\n\n            if (this.isCreator && fastboard.syncedStore.isRoomWritable) {\n                await fastboard.syncedStore.nextFrame();\n                this.sideEffect.addDisposer(\n                    autorun(reaction => {\n                        if (this.onStageUserUUIDs.length > 0) {\n                            reaction.dispose();\n                            return;\n                        }\n                        if (this.users.joiners.length === 1) {\n                            this.onStaging(this.users.joiners[0].userUUID, true);\n                        }\n                    }),\n                );\n            }\n        }\n\n        if (\n            this.roomType === RoomType.SmallClass &&\n            !this.isCreator &&\n            !onStageUsersStorage.state[this.userUUID] &&\n            this.assertStageNotFull(false) &&\n            !globalStore.wasOnStage(this.roomUUID)\n        ) {\n            globalStore.pushOnStageRoomUUID(this.roomUUID);\n            if (!fastboard.syncedStore.isRoomWritable) {\n                this.whiteboardStore.updateWritable(true);\n                // @FIXME add reliable way to ensure writable is set\n                await new Promise<void>(resolve => {\n                    const disposer = fastboard.syncedStore.addRoomWritableChangeListener(\n                        isWritable => {\n                            if (isWritable) {\n                                disposer();\n                                resolve();\n                            }\n                        },\n                    );\n                });\n            }\n            this.onStageUsersStorage.setState({ [this.userUUID]: true });\n        }\n\n        if (this.isCreator) {\n            await this.recording.joinRoom({\n                roomID: this.roomUUID,\n                classroomType: this.roomType,\n            });\n\n            if (preferencesStore.autoRecording && !this.isRecording) {\n                await this.toggleRecording();\n            }\n        }\n    }\n\n    public async destroy(): Promise<void> {\n        this.sideEffect.flushAll();\n\n        await this.stopRecording();\n\n        this.deviceStateStorage = undefined;\n        this.onStageUsersStorage = undefined;\n        this.classroomStorage = undefined;\n        this.whiteboardStorage = undefined;\n        this.userWindowsStorage = undefined;\n    }\n\n    public startClass = (): Promise<void> => this.switchRoomStatus(RoomStatus.Started);\n\n    public pauseClass = (): Promise<void> => this.switchRoomStatus(RoomStatus.Paused);\n\n    public stopClass = (): Promise<void> => this.switchRoomStatus(RoomStatus.Stopped);\n\n    public hangClass = async (): Promise<void> => {\n        // delay resolve for better UX\n        await new Promise(resolve => setTimeout(resolve, 200));\n    };\n\n    public toggleCloudStoragePanel = (visible: boolean): void => {\n        this.isCloudStoragePanelVisible = visible;\n    };\n\n    public toggleUsersPanel = (visible = !this.isUsersPanelVisible): void => {\n        this.isUsersPanelVisible = visible;\n    };\n\n    public onDragStart = (): void => {\n        this.isDraggingAvatar = true;\n    };\n\n    public onDragEnd = (): void => {\n        this.isDraggingAvatar = false;\n    };\n\n    public getPortal = (userUUID: string): HTMLDivElement | undefined => {\n        return this.userWindowsPortal.get(userUUID);\n    };\n\n    public setPortal = (userUUID: string, portal: HTMLDivElement | null | undefined): void => {\n        if (portal) {\n            this.userWindowsPortal.set(userUUID, portal);\n        } else {\n            this.userWindowsPortal.delete(userUUID);\n        }\n    };\n\n    public windowedUserUUIDs = (): string[] => {\n        if (!this.userWindowsStorage) {\n            return [];\n        }\n        const windows = this.userWindowsStorage.state as unknown as Record<string, UserWindow>;\n        const result: string[] = [];\n        for (const key in windows) {\n            if (key !== \"grid\" && windows[key]) {\n                result.push(key);\n            }\n        }\n        return result;\n    };\n\n    public maxZOfUserWindows = (exclude?: string): number => {\n        if (!this.userWindowsStorage) {\n            return 0;\n        }\n        const windows = this.userWindowsStorage.state as unknown as Record<string, UserWindow>;\n        let maxZ = 0;\n        for (const key in windows) {\n            if (key !== \"grid\" && key !== exclude && windows[key]) {\n                maxZ = Math.max(maxZ, windows[key].z);\n            }\n        }\n        return maxZ;\n    };\n\n    public userHasLeft = (userUUID: string): boolean => {\n        return this.users.cachedUsers.get(userUUID)?.hasLeft ?? true;\n    };\n\n    public toggleUserWindowsMode = (mode?: \"normal\" | \"maximized\"): void => {\n        if (this.isCreator && this.userWindowsStorage) {\n            const targetMode = mode || (this.userWindowsMode === \"normal\" ? \"maximized\" : \"normal\");\n            if (targetMode === \"normal\") {\n                this.userWindowsStorage.setState({ grid: null });\n            } else {\n                this.userWindowsStorage.setState({ grid: this.windowedUserUUIDs() });\n            }\n        }\n    };\n\n    public createAvatarWindow = (userUUID: string, window: Omit<UserWindow, \"z\">): void => {\n        if (this.isCreator && this.userWindowsStorage) {\n            if (this.emptyArrayAsNull(this.userWindowsStorage.state.grid)) {\n                this.createMaximizedAvatarWindow(userUUID);\n            } else {\n                const maxZ = this.maxZOfUserWindows();\n                this.userWindowsStorage.setState({ [userUUID]: { ...window, z: maxZ + 1 } });\n            }\n        }\n    };\n\n    public createMaximizedAvatarWindow = (userUUID: string): void => {\n        if (this.isCreator && this.userWindowsStorage) {\n            let grid = this.userWindowsStorage.state.grid;\n            if (!grid || grid.length === 0) {\n                grid = this.windowedUserUUIDs();\n            }\n            if (!grid.includes(userUUID)) {\n                grid = [...grid, userUUID];\n            }\n            this.userWindowsStorage.setState({ grid });\n        }\n    };\n\n    private isWindowEqual(a: UserWindow, b: UserWindow): boolean {\n        return (\n            a.z === b.z &&\n            Math.abs(a.x - b.x) < 1e-3 &&\n            Math.abs(a.y - b.y) < 1e-3 &&\n            Math.abs(a.width - b.width) < 1e-3 &&\n            Math.abs(a.height - b.height) < 1e-3\n        );\n    }\n\n    public updateAvatarWindow = (userUUID: string, window: UserWindow): void => {\n        if (this.isCreator && this.userWindowsStorage && !this.userWindowsGrid) {\n            const maxZ = this.maxZOfUserWindows(userUUID);\n            const newValue = { ...window, z: maxZ + 1 };\n            const oldValue = (this.userWindowsStorage.state as any)[userUUID];\n            if (!this.isWindowEqual(oldValue, newValue)) {\n                this.userWindowsStorage.setState({ [userUUID]: newValue });\n            }\n        }\n    };\n\n    public deleteAvatarWindow = (userUUID: string): void => {\n        // joiners can delete themselves\n        if (this.userWindowsStorage?.isWritable) {\n            this.userWindowsStorage.setState({ [userUUID]: undefined });\n            let grid = this.userWindowsStorage.state.grid;\n            if (grid && grid.includes(userUUID)) {\n                grid = grid.filter(uuid => uuid !== userUUID);\n                if (grid.length === 0) {\n                    grid = null;\n                }\n                this.userWindowsStorage.setState({ grid });\n            }\n        }\n    };\n\n    public setDroppingUserUUID = (userUUID: string | null): void => {\n        this.droppingUserUUID = userUUID;\n    };\n\n    public isDropTarget = (userUUID: string): boolean => {\n        return this.droppingUserUUID === userUUID;\n    };\n\n    public onDrop = (file: File): void => {\n        this.toggleCloudStoragePanel(true);\n        const cloudStorage = this.whiteboardStore.cloudStorageStore;\n        cloudStorage.setPanelExpand(true);\n        cloudStorage.uploadTaskManager.addTasks([file], cloudStorage.parentDirectoryPath);\n    };\n\n    public onMessageSend = async (text: string): Promise<void> => {\n        if (this.isBan && !this.isCreator) {\n            return;\n        }\n        if (process.env.FLAT_REGION === \"CN\" && !(await checkRTMCensor({ text })).valid) {\n            return;\n        }\n        await this.rtm.sendRoomMessage(text);\n    };\n\n    public toggleRecording = async ({ onStop }: { onStop?: () => void } = {}): Promise<void> => {\n        this.isRecordingLoading = true;\n        try {\n            if (this.isRecording) {\n                await this.stopRecording();\n                onStop?.();\n            } else {\n                await this.startRecording();\n            }\n        } catch (e) {\n            errorTips(e as Error);\n        }\n        runInAction(() => {\n            this.isRecordingLoading = false;\n        });\n    };\n\n    public updateRecordingLayout = (users: Array<{ uid: string; avatar: string }>): void => {\n        if (this.isRecording) {\n            void this.recording.updateLayout(users);\n        }\n    };\n\n    public updateClassMode = (classMode?: ClassModeType): void => {\n        this.classMode =\n            classMode ??\n            (this.roomInfo?.roomType === RoomType.SmallClass\n                ? ClassModeType.Interaction\n                : ClassModeType.Lecture);\n    };\n\n    public updateRoomStatus = (roomStatus: RoomStatus): void => {\n        if (this.roomInfo && this.roomInfo.roomStatus !== roomStatus) {\n            this.roomInfo.roomStatus = roomStatus;\n            if (this.isCreator) {\n                this.rtm.sendRoomCommand(\"update-room-status\", {\n                    roomUUID: this.roomUUID,\n                    status: roomStatus,\n                });\n            }\n        }\n    };\n\n    public updateShareScreen = (local: boolean, remote: boolean): void => {\n        this.isScreenSharing = local;\n        this.isRemoteScreenSharing = remote;\n    };\n\n    public refreshShareScreenInfo = async (): Promise<void> => {\n        this.selectShareScreenInfo(null);\n        this.shareScreenInfo = [];\n        const shareScreenInfo = await this.rtc.shareScreen.getScreenInfo();\n        runInAction(() => {\n            this.shareScreenInfo = shareScreenInfo;\n        });\n    };\n\n    public toggleShareScreenPicker = (force = !this.shareScreenPickerVisible): void => {\n        this.shareScreenPickerVisible = force;\n    };\n\n    public selectShareScreenInfo = (info: IServiceShareScreenInfo | null): void => {\n        this.selectedScreenInfo = info;\n        this.rtc.shareScreen.setScreenInfo(info);\n    };\n\n    public toggleShareScreen = (force = !this.isScreenSharing): void => {\n        this.rtc.shareScreen.enable(force);\n        this.toggleShareScreenPicker(false);\n    };\n\n    public acceptRaiseHand = (userUUID: string): void => {\n        if (this.isCreator && this.classroomStorage?.isWritable) {\n            if (this.classroomStorage.state.raiseHandUsers.includes(userUUID)) {\n                this.onStaging(userUUID, true);\n            }\n        }\n    };\n\n    public onCancelAllHandRaising = (): void => {\n        if (this.isCreator && this.classroomStorage?.isWritable) {\n            this.classroomStorage.setState({ raiseHandUsers: [] });\n        }\n    };\n\n    /** When current user (who is a joiner) raises hand */\n    public onToggleHandRaising = (): void => {\n        if (this.isCreator || this.users.currentUser?.isSpeak) {\n            return;\n        }\n\n        if (this.users.currentUser) {\n            void this.rtm.sendPeerCommand(\n                \"raise-hand\",\n                { roomUUID: this.roomUUID, raiseHand: !this.users.currentUser.isRaiseHand },\n                this.ownerUUID,\n            );\n        }\n    };\n\n    public onToggleHandRaisingPanel = (force = !this.isHandRaisingPanelVisible): void => {\n        this.isHandRaisingPanelVisible = force;\n    };\n\n    public onToggleBan = (): void => {\n        if (this.isCreator && this.classroomStorage?.isWritable) {\n            this.classroomStorage.setState({ ban: !this.classroomStorage.state.ban });\n        }\n    };\n\n    private updateIsBan(ban: boolean): void {\n        this.isBan = ban;\n    }\n\n    public onStaging = (userUUID: string, onStage: boolean): void => {\n        if (\n            this.classMode === ClassModeType.Interaction ||\n            userUUID === this.ownerUUID ||\n            !this.onStageUsersStorage?.isWritable\n        ) {\n            return;\n        }\n        if (!onStage && (!this.isCreator || userUUID !== this.userUUID)) {\n            this.updateDeviceState(userUUID, false, false);\n            this.deleteAvatarWindow(userUUID);\n        }\n        if (this.isCreator) {\n            if (!onStage || this.assertStageNotFull()) {\n                this.onStageUsersStorage.setState({ [userUUID]: onStage });\n            } else {\n                // assert failed\n                return;\n            }\n        } else {\n            // joiner can only turn off speaking\n            if (!onStage && userUUID === this.userUUID) {\n                this.onStageUsersStorage.setState({ [userUUID]: false });\n            }\n        }\n        if (this.classroomStorage?.state.raiseHandUsers.includes(userUUID)) {\n            const raiseHandUsers = this.classroomStorage.state.raiseHandUsers;\n            this.classroomStorage.setState({\n                raiseHandUsers: raiseHandUsers.filter(id => id !== userUUID),\n            });\n        }\n    };\n\n    private assertStageNotFull(showWarning = true): boolean {\n        const limit = this.roomType === RoomType.SmallClass ? 16 : 1;\n        if (this.onStageUserUUIDs.length < limit) {\n            return true;\n        }\n        const i18nKey =\n            \"warn-staging-limit.\" +\n            (this.roomType === RoomType.SmallClass ? \"small-class\" : \"other\");\n        showWarning && message.warn({ content: FlatI18n.t(i18nKey), style: { whiteSpace: \"pre\" } });\n        return false;\n    }\n\n    public offStageAll = async (): Promise<void> => {\n        if (this.classMode === ClassModeType.Interaction || !this.onStageUsersStorage?.isWritable) {\n            return;\n        }\n        if (this.isCreator) {\n            this.onStageUsersStorage.resetState();\n            this.whiteboardStorage?.resetState();\n            this.userWindowsStorage?.resetState();\n            message.info(FlatI18n.t(\"all-off-stage-toast\"));\n        }\n    };\n\n    public muteAll = async (): Promise<void> => {\n        if (this.isCreator && this.deviceStateStorage && this.deviceStateStorage.isWritable) {\n            const state = this.deviceStateStorage.state;\n            const payload: Partial<DeviceStateStorageState> = {};\n            for (const userUUID in state) {\n                if (userUUID !== this.userUUID && state[userUUID].mic) {\n                    payload[userUUID] = { ...state[userUUID], mic: false };\n                }\n            }\n            this.deviceStateStorage.setState(payload);\n            message.info(FlatI18n.t(\"all-mute-mic-toast\"));\n        }\n    };\n\n    public authorizeWhiteboard = async (userUUID: string, enabled: boolean): Promise<void> => {\n        if (\n            this.classMode === ClassModeType.Interaction ||\n            userUUID === this.ownerUUID ||\n            !this.whiteboardStorage?.isWritable\n        ) {\n            return;\n        }\n        if (this.isCreator) {\n            this.whiteboardStorage.setState({ [userUUID]: enabled });\n        } else {\n            // joiner can only turn off drawing\n            if (!enabled && userUUID === this.userUUID) {\n                this.whiteboardStorage.setState({ [userUUID]: false });\n            }\n        }\n    };\n\n    /** joiner updates own camera and mic state */\n    public updateDeviceState = (userUUID: string, camera: boolean, mic: boolean): void => {\n        if (this.deviceStateStorage?.isWritable && (this.userUUID === userUUID || this.isCreator)) {\n            const deviceState = this.deviceStateStorage.state[userUUID] || {\n                camera: false,\n                mic: false,\n            };\n            if (camera === deviceState.camera && mic === deviceState.mic) {\n                return;\n            }\n            let shouldNotify = false;\n            // creator can request joiner to turn on camera and mic\n            if (this.isCreator && userUUID !== this.userUUID) {\n                if (camera && !deviceState.camera) {\n                    void this.rtm.sendPeerCommand(\n                        \"request-device\",\n                        { roomUUID: this.roomUUID, camera },\n                        userUUID,\n                    );\n                    message.info(FlatI18n.t(\"sent-invitation\"));\n                    return;\n                }\n                if (mic && !deviceState.mic) {\n                    void this.rtm.sendPeerCommand(\n                        \"request-device\",\n                        { roomUUID: this.roomUUID, mic },\n                        userUUID,\n                    );\n                    message.info(FlatI18n.t(\"sent-invitation\"));\n                    return;\n                }\n                shouldNotify = true;\n            }\n            // creator can turn off joiner's camera and mic\n            this.deviceStateStorage.setState({\n                [userUUID]: camera || mic ? { camera, mic } : undefined,\n            });\n            if (shouldNotify) {\n                if (!camera && deviceState.camera) {\n                    message.info(FlatI18n.t(\"has-turn-off-camera\"));\n                    void this.rtm.sendPeerCommand(\n                        \"notify-device-off\",\n                        { roomUUID: this.roomUUID, camera },\n                        userUUID,\n                    );\n                }\n                if (!mic && deviceState.mic) {\n                    message.info(FlatI18n.t(\"has-turn-off-mic\"));\n                    void this.rtm.sendPeerCommand(\n                        \"notify-device-off\",\n                        { roomUUID: this.roomUUID, mic },\n                        userUUID,\n                    );\n                }\n            }\n        }\n    };\n\n    public toggleRequestingDevice(camera: boolean | undefined, mic: boolean | undefined): void {\n        if (camera !== undefined) {\n            this.isRequestingCamera = camera;\n        }\n        if (mic !== undefined) {\n            this.isRequestingMic = mic;\n        }\n    }\n\n    public replyRequestingDevice(device: \"camera\" | \"mic\", enabled: boolean): void {\n        if (!this.isCreator) {\n            void this.rtm.sendPeerCommand(\n                \"request-device-response\",\n                { roomUUID: this.roomUUID, [device]: enabled },\n                this.ownerUUID,\n            );\n        }\n    }\n\n    private async switchRoomStatus(roomStatus: RoomStatus): Promise<void> {\n        if (!this.isCreator || this.roomStatusLoading !== RoomStatusLoadingType.Null) {\n            return;\n        }\n\n        if (!this.roomInfo) {\n            throw new Error(\"Room not ready!\");\n        }\n\n        try {\n            switch (roomStatus) {\n                case RoomStatus.Started: {\n                    this.updateRoomStatusLoading(RoomStatusLoadingType.Starting);\n                    await startClass(this.roomUUID);\n                    await roomStore.syncOrdinaryRoomInfo(this.roomUUID);\n                    const roomUUID = this.roomUUID;\n                    const periodicUUID = globalStore.periodicUUID;\n                    if (periodicUUID) {\n                        await roomStore.syncPeriodicSubRoomInfo({ periodicUUID, roomUUID });\n                    }\n                    break;\n                }\n                case RoomStatus.Paused: {\n                    this.updateRoomStatusLoading(RoomStatusLoadingType.Pausing);\n                    await pauseClass(this.roomUUID);\n                    break;\n                }\n                case RoomStatus.Stopped: {\n                    this.updateRoomStatusLoading(RoomStatusLoadingType.Stopping);\n                    await stopClass(this.roomUUID);\n                    break;\n                }\n                default: {\n                    break;\n                }\n            }\n\n            // update room status finally\n            // so that the component won't unmount before sending commands\n            this.updateRoomStatus(roomStatus);\n        } catch (e) {\n            errorTips(e as Error);\n            console.error(e);\n        }\n        this.updateRoomStatusLoading(RoomStatusLoadingType.Null);\n    }\n\n    private updateRoomStatusLoading = (loading: RoomStatusLoadingType): void => {\n        this.roomStatusLoading = loading;\n    };\n\n    private async startRecording(): Promise<void> {\n        await this.recording.startRecording();\n    }\n\n    private async stopRecording(): Promise<void> {\n        await this.recording.stopRecording();\n    }\n\n    private async initRTC(): Promise<void> {\n        this.sideEffect.addDisposer(\n            this.rtc.events.on(\n                \"network\",\n                action(\"checkNetworkQuality\", networkQuality => {\n                    this.networkQuality = networkQuality;\n                }),\n            ),\n        );\n\n        this.sideEffect.addDisposer(\n            this.rtc.shareScreen.events.on(\n                \"local-changed\",\n                action(\"localShareScreen\", enabled => {\n                    this.isScreenSharing = enabled;\n                }),\n            ),\n        );\n\n        this.sideEffect.addDisposer(\n            this.rtc.shareScreen.events.on(\n                \"remote-changed\",\n                action(\"remoteShareScreen\", enabled => {\n                    this.isRemoteScreenSharing = enabled;\n                }),\n            ),\n        );\n\n        if (globalStore.rtcUID) {\n            await this.rtc.joinRoom({\n                roomUUID: this.roomUUID,\n                uid: String(globalStore.rtcUID),\n                token: globalStore.rtcToken,\n                mode:\n                    this.roomInfo?.roomType === RoomType.BigClass\n                        ? IServiceVideoChatMode.Broadcast\n                        : IServiceVideoChatMode.Communication,\n                role:\n                    this.isCreator ||\n                    (globalStore.userUUID && this.onStageUsersStorage?.state[globalStore.userUUID])\n                        ? IServiceVideoChatRole.Host\n                        : IServiceVideoChatRole.Audience,\n                refreshToken: generateRTCToken,\n                shareScreenUID: String(globalStore.rtcShareScreen?.uid || -1),\n                shareScreenToken: globalStore.rtcShareScreen?.token || \"\",\n            });\n\n            runInAction(() => {\n                this.isJoinedRTC = true;\n            });\n        }\n    }\n}\n","import React from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { ChatPanel as ChatPanelImpl } from \"flat-components\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\n\nexport interface ChatPanelProps {\n    classRoomStore: ClassroomStore;\n}\n\n// @TODO add rtm\nconst noop = async (): Promise<void> => void 0;\n\nexport const ChatPanel = observer<ChatPanelProps>(function ChatPanel({ classRoomStore }) {\n    return (\n        <ChatPanelImpl\n            getUserByUUID={(userUUID: string) => classRoomStore.users.cachedUsers.get(userUUID)}\n            isBan={classRoomStore.isBan}\n            isCreator={classRoomStore.isCreator}\n            loadMoreRows={noop}\n            messages={classRoomStore.chatStore.messages}\n            openCloudStorage={() => classRoomStore.toggleCloudStoragePanel(true)}\n            totalUserCount={classRoomStore.users.totalUserCount}\n            unreadCount={classRoomStore.users.handRaisingJoiners.length || null}\n            userUUID={classRoomStore.userUUID}\n            onBanChange={classRoomStore.onToggleBan}\n            onClickTotalUsersCount={() => classRoomStore.toggleUsersPanel(true)}\n            onMessageSend={classRoomStore.onMessageSend}\n        />\n    );\n});\n\nexport default ChatPanel;\n","import { RoomStoppedModal } from \"flat-components\";\nimport { observer } from \"mobx-react-lite\";\nimport React, { useCallback } from \"react\";\nimport { RoomStatus } from \"@netless/flat-server-api\";\nimport { RouteNameType, usePushHistory } from \"../../utils/routes\";\n\nexport interface RoomStatusStoppedModalProps {\n    isCreator: boolean;\n    isRemoteLogin: boolean;\n    roomStatus: RoomStatus;\n}\n\n/**\n * Show an info modal on joiner side when room status becomes stopped\n */\nexport const RoomStatusStoppedModal = observer<RoomStatusStoppedModalProps>(\n    function RoomStatusStoppedModal({ isCreator, isRemoteLogin, roomStatus }) {\n        const pushHistory = usePushHistory();\n\n        const onExit = useCallback(() => {\n            pushHistory(RouteNameType.HomePage);\n        }, [pushHistory]);\n\n        return (\n            <RoomStoppedModal\n                isCreator={isCreator}\n                isRemoteLogin={isRemoteLogin}\n                roomStatus={roomStatus}\n                onExit={onExit}\n            />\n        );\n    },\n);\n\nexport default RoomStatusStoppedModal;\n","import \"./style.less\";\n\nimport { CloudStorageContainer } from \"flat-components\";\nimport { observer } from \"mobx-react-lite\";\nimport React, { useCallback, useEffect, useMemo } from \"react\";\nimport { CloudStorageStore } from \"@netless/flat-stores\";\nimport { useHistory, useLocation } from \"react-router-dom\";\n\nexport interface CloudStoragePanelProps {\n    cloudStorage: CloudStorageStore;\n    onCoursewareInserted?: () => void;\n}\n\nexport const CloudStoragePanel = observer<CloudStoragePanelProps>(function CloudStoragePanel({\n    cloudStorage,\n    onCoursewareInserted,\n}) {\n    const history = useHistory();\n    const location = useLocation();\n    const path = useMemo(() => new URLSearchParams(location.search).get(\"path\"), [location.search]);\n\n    const pushHistory = useCallback(\n        (path: string): void => {\n            const search = new URLSearchParams({ path }).toString();\n            history.push({ search });\n        },\n        [history],\n    );\n\n    useEffect(\n        () => cloudStorage.initialize({ onCoursewareInserted }),\n        [cloudStorage, onCoursewareInserted],\n    );\n\n    useEffect(() => {\n        if (path !== null) {\n            cloudStorage.onParentDirectoryPathClick(path);\n        }\n    }, [path, cloudStorage]);\n\n    return <CloudStorageContainer path={path} pushHistory={pushHistory} store={cloudStorage} />;\n});\n","// TODO: remove this component when multi sub window is Done\nimport { Modal } from \"antd\";\nimport { SVGCloudOutlined, TopBarRightBtn } from \"flat-components\";\nimport { observer } from \"mobx-react-lite\";\nimport React, { useCallback } from \"react\";\nimport { CloudStoragePanel } from \"../CloudStoragePage/CloudStoragePanel\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\nimport \"./CloudStorageButton.less\";\nimport { useTranslate } from \"@netless/flat-i18n\";\n\ninterface CloudStorageButtonProps {\n    classroom: ClassroomStore;\n}\n\nexport const CloudStorageButton = observer<CloudStorageButtonProps>(function CloudStorageButton({\n    classroom,\n}) {\n    const t = useTranslate();\n    const hideModal = useCallback(() => classroom.toggleCloudStoragePanel(false), [classroom]);\n    const showModal = useCallback(() => classroom.toggleCloudStoragePanel(true), [classroom]);\n\n    if (!classroom.whiteboardStore.allowDrawing) {\n        return null;\n    }\n\n    return (\n        <>\n            <TopBarRightBtn\n                icon={<SVGCloudOutlined />}\n                title={t(\"cloud-storage\")}\n                onClick={showModal}\n            />\n            <Modal\n                centered\n                destroyOnClose\n                className=\"cloud-storage-button-modal\"\n                footer={[]}\n                open={classroom.isCloudStoragePanelVisible}\n                title={t(\"my-cloud\")}\n                onCancel={hideModal}\n            >\n                <CloudStoragePanel\n                    cloudStorage={classroom.whiteboardStore.cloudStorageStore}\n                    onCoursewareInserted={hideModal}\n                />\n            </Modal>\n        </>\n    );\n});\n","import {\n    CloseRoomConfirmModal,\n    ExitRoomConfirmModal,\n    StopClassConfirmModal,\n    errorTips,\n} from \"flat-components\";\nimport { observer } from \"mobx-react-lite\";\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { RoomStatus } from \"@netless/flat-server-api\";\nimport { useSafePromise } from \"../utils/hooks/lifecycle\";\nimport { RouteNameType, usePushHistory } from \"../utils/routes\";\nimport { WindowsSystemBtnContext } from \"./StoreProvider\";\n\nexport enum ExitRoomConfirmType {\n    StopClassButton,\n    ExitButton,\n}\n\nexport interface ExitRoomConfirmProps {\n    isCreator: boolean;\n    confirmType: ExitRoomConfirmType;\n    visible: boolean;\n    isReturnLoading: boolean;\n    isStopLoading: boolean;\n    onReturnMain: () => Promise<void>;\n    onStopClass: () => Promise<void>;\n    onCancel: () => void;\n    confirm: (confirmType: ExitRoomConfirmType) => void;\n}\n\nexport function useExitRoomConfirmModal({\n    roomStatus,\n    hangClass,\n    stopClass,\n}: {\n    roomStatus: RoomStatus;\n    hangClass: () => Promise<void>;\n    stopClass: () => Promise<void>;\n}): Omit<ExitRoomConfirmProps, \"isCreator\"> {\n    const [confirmType, setConfirmType] = useState(ExitRoomConfirmType.ExitButton);\n    const [visible, setVisible] = useState(false);\n    const [isReturnLoading, setReturnLoading] = useState(false);\n    const [isStopLoading, setStopLoading] = useState(false);\n    const sp = useSafePromise();\n    const pushHistory = usePushHistory();\n\n    const windowsBtn = useContext(WindowsSystemBtnContext);\n\n    const onReturnMain = useCallback(async () => {\n        setReturnLoading(true);\n\n        try {\n            await sp(hangClass());\n        } catch (e) {\n            setReturnLoading(false);\n            console.error(e);\n            errorTips(e);\n        }\n\n        pushHistory(RouteNameType.HomePage);\n    }, [pushHistory, hangClass, sp]);\n\n    const onStopClass = useCallback(async () => {\n        setStopLoading(true);\n\n        try {\n            await sp(stopClass());\n        } catch (e) {\n            setStopLoading(false);\n            console.error(e);\n            errorTips(e);\n        }\n    }, [stopClass, sp]);\n\n    const onCancel = useCallback(() => {\n        setVisible(false);\n    }, []);\n\n    const confirm = useCallback(\n        (confirmType: ExitRoomConfirmType) => {\n            if (roomStatus === RoomStatus.Started || roomStatus === RoomStatus.Paused) {\n                setVisible(true);\n                setConfirmType(confirmType);\n            } else {\n                void onReturnMain();\n            }\n        },\n        [onReturnMain, roomStatus],\n    );\n\n    // TODO:\n    useEffect(() => {\n        if (windowsBtn) {\n            windowsBtn.sendWindowWillCloseEvent(() => confirm(ExitRoomConfirmType.ExitButton));\n            return () => {\n                windowsBtn.removeWindowWillCloseEvent();\n            };\n        }\n        return;\n    });\n\n    return {\n        confirmType,\n        visible,\n        isReturnLoading,\n        isStopLoading,\n        onReturnMain,\n        onStopClass,\n        onCancel,\n        confirm,\n    };\n}\n\nexport const ExitRoomConfirm = observer<Omit<ExitRoomConfirmProps, \"confirm\">>(\n    function ExitRoomConfirm({\n        isCreator,\n        confirmType,\n        isReturnLoading,\n        isStopLoading,\n        onReturnMain,\n        onStopClass,\n        ...restProps\n    }) {\n        return isCreator ? (\n            confirmType === ExitRoomConfirmType.ExitButton ? (\n                <CloseRoomConfirmModal\n                    {...restProps}\n                    hangLoading={isReturnLoading}\n                    stopLoading={isStopLoading}\n                    onHang={onReturnMain}\n                    onStop={onStopClass}\n                />\n            ) : (\n                <StopClassConfirmModal\n                    {...restProps}\n                    loading={isStopLoading}\n                    onStop={onStopClass}\n                />\n            )\n        ) : (\n            <ExitRoomConfirmModal {...restProps} onExit={onReturnMain} />\n        );\n    },\n);\n\nexport default ExitRoomConfirm;\n","import React, { useCallback, useContext, useEffect } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { message } from \"antd\";\nimport { InviteModal as InviteModalImpl, errorTips } from \"flat-components\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { RoomItem } from \"@netless/flat-stores\";\nimport { GlobalStoreContext, RoomStoreContext } from \"../StoreProvider\";\nimport { FLAT_WEB_BASE_URL } from \"../../constants/process\";\n\nexport interface InviteModalProps {\n    visible: boolean;\n    room: RoomItem;\n    // after copy is performed\n    onCopied: () => void;\n    onCancel: () => void;\n}\n\nexport const InviteModal = observer<InviteModalProps>(function InviteModal({\n    visible,\n    room,\n    onCopied,\n    onCancel,\n}) {\n    const t = useTranslate();\n    const globalStore = useContext(GlobalStoreContext);\n    const roomStore = useContext(RoomStoreContext);\n\n    const { periodicUUID } = room;\n    const periodicInfo = periodicUUID ? roomStore.periodicRooms.get(periodicUUID) : undefined;\n\n    useEffect(() => {\n        if (periodicUUID) {\n            roomStore.syncPeriodicRoomInfo(periodicUUID).catch(errorTips);\n        }\n    }, [periodicUUID, roomStore]);\n\n    const onCopy = useCallback(\n        async (text: string): Promise<void> => {\n            await navigator.clipboard.writeText(text);\n            void message.success(t(\"copy-success\"));\n            onCopied();\n        },\n        [onCopied, t],\n    );\n\n    return (\n        <InviteModalImpl\n            baseUrl={FLAT_WEB_BASE_URL}\n            periodicWeeks={periodicInfo?.periodic.weeks}\n            room={room}\n            userName={globalStore.userName ?? \"\"}\n            visible={visible}\n            onCancel={onCancel}\n            onCopy={onCopy}\n        />\n    );\n});\n","import React, { useState } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { SVGUserInvite, TopBarRightBtn } from \"flat-components\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { RoomItem } from \"@netless/flat-stores\";\nimport { InviteModal } from \"./Modal/InviteModal\";\n\nexport interface InviteButtonProps {\n    roomInfo?: RoomItem;\n}\n\nexport const InviteButton = observer<InviteButtonProps>(function InviteButton({ roomInfo }) {\n    const t = useTranslate();\n    const [isShowInviteModal, showInviteModal] = useState(false);\n    const hideInviteModal = (): void => showInviteModal(false);\n    return (\n        <div>\n            <TopBarRightBtn\n                icon={<SVGUserInvite />}\n                title={t(\"invitation\")}\n                onClick={() => showInviteModal(true)}\n            />\n            {roomInfo && (\n                <InviteModal\n                    room={roomInfo}\n                    visible={isShowInviteModal}\n                    onCancel={hideInviteModal}\n                    onCopied={hideInviteModal}\n                />\n            )}\n        </div>\n    );\n});\n\nexport default InviteButton;\n","import React, { ReactElement } from \"react\";\nimport classNames from \"classnames\";\n\nimport \"./RealtimePanel.less\";\n\nexport type RealtimePanelProps = {\n    // is playing user video\n    isVideoOn: boolean;\n    // is visible\n    isShow: boolean;\n    videoSlot?: React.ReactNode;\n    chatSlot: React.ReactNode;\n};\n\nexport class RealtimePanel extends React.PureComponent<RealtimePanelProps> {\n    public override render(): ReactElement {\n        const { isVideoOn, isShow, videoSlot, chatSlot } = this.props;\n\n        return (\n            <div\n                className={classNames(\"realtime-panel-wrap\", {\n                    isActive: isShow,\n                })}\n            >\n                <div className=\"realtime-panel\">\n                    <div\n                        className={classNames(\"realtime-panel-video-slot\", {\n                            isActive: isVideoOn,\n                        })}\n                    >\n                        {videoSlot}\n                    </div>\n                    <div className=\"realtime-panel-chat-slot\">{chatSlot}</div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default RealtimePanel;\n","const SupportedFileExts = [\n    \".ppt\",\n    \".pptx\",\n    \".doc\",\n    \".docx\",\n    \".pdf\",\n    \".png\",\n    \".jpg\",\n    \".jpeg\",\n    \".gif\",\n    \".mp3\",\n    \".mp4\",\n];\n\nexport function isSupportedFileExt(file: File): boolean {\n    return SupportedFileExts.some(ext => file.name.endsWith(ext));\n}\n","import { message } from \"antd\";\nimport { v4 as v4uuid } from \"uuid\";\nimport { ApplianceNames, Room, Size } from \"white-web-sdk\";\nimport { listFiles } from \"@netless/flat-server-api\";\nimport { CloudStorageStore, UploadTask } from \"@netless/flat-stores\";\nimport { FlatI18n } from \"@netless/flat-i18n\";\n\nconst ImageFileTypes = [\n    \"image/png\",\n    \"image/jpg\",\n    \"image/jpeg\",\n    \"image/webp\",\n    \"image/apng\",\n    \"image/svg+xml\",\n    \"image/gif\",\n    \"image/bmp\",\n    \"image/avif\",\n    \"image/tiff\",\n];\n\nexport function isSupportedImageType(file: File): boolean {\n    return ImageFileTypes.includes(file.type);\n}\n\nexport async function onDropImage(\n    file: File,\n    x: number,\n    y: number,\n    room: Room,\n    cloudStorageStore: CloudStorageStore,\n): Promise<void> {\n    if (!isSupportedImageType(file)) {\n        console.log(\"[dnd:image] unsupported file type:\", file.type, file.name);\n        return;\n    }\n\n    const hideLoading = message.loading(FlatI18n.t(\"inserting-courseware-tips\"));\n\n    const getSize = getImageSize(file);\n    const task = new UploadTask(file, cloudStorageStore.parentDirectoryPath);\n    await task.upload();\n    const { files } = await listFiles({\n        page: 1,\n        order: \"DESC\",\n        directoryPath: cloudStorageStore.parentDirectoryPath,\n    });\n    const cloudFile = files.find(f => f.fileUUID === task.fileUUID);\n\n    hideLoading();\n\n    if (!cloudFile?.fileURL) {\n        console.log(\"[dnd:image] upload failed:\", file.name);\n        return;\n    }\n\n    const uuid = v4uuid();\n    const { width, height } = await getSize;\n    room.insertImage({ uuid, centerX: x, centerY: y, width, height, locked: false });\n    room.completeImageUpload(uuid, cloudFile.fileURL);\n    room.setMemberState({ currentApplianceName: ApplianceNames.selector });\n}\n\nexport function getImageSize(file: File): Promise<Size> {\n    const image = new Image();\n    const url = URL.createObjectURL(file);\n    const { innerWidth, innerHeight } = window;\n    // shrink the image a little to fit the screen\n    const maxWidth = innerWidth * 0.8;\n    const maxHeight = innerHeight * 0.8;\n    image.src = url;\n    return new Promise(resolve => {\n        image.onload = () => {\n            URL.revokeObjectURL(url);\n            const { width, height } = image;\n            let scale = 1;\n            if (width > maxWidth || height > maxHeight) {\n                scale = Math.min(maxWidth / width, maxHeight / height);\n            }\n            resolve({ width: Math.floor(width * scale), height: Math.floor(height * scale) });\n        };\n        image.onerror = () => {\n            resolve({ width: innerWidth, height: innerHeight });\n        };\n    });\n}\n","import type { PresetImage } from \"flat-components\";\n\nexport const PRESETS: PresetImage[] = [\n    {\n        src: \"https://flat-storage.oss-cn-hangzhou.aliyuncs.com/flat-resources/presets/math_1.png\",\n        i18nKey: \"presets.math_1\",\n    },\n    {\n        src: \"https://flat-storage.oss-cn-hangzhou.aliyuncs.com/flat-resources/presets/english_1.jpeg\",\n        i18nKey: \"presets.english_1\",\n    },\n    {\n        src: \"https://flat-storage.oss-cn-hangzhou.aliyuncs.com/flat-resources/presets/chinese_1.png\",\n        i18nKey: \"presets.chinese_1\",\n    },\n];\n","import { CloudFile } from \"@netless/flat-server-api\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport function createCloudFile(file: Partial<CloudFile>): CloudFile {\n    return {\n        fileUUID: uuidv4(),\n        fileName: \"\",\n        fileSize: 0,\n        fileURL: \"\",\n        resourceType: \"NormalResources\",\n        createAt: new Date(),\n        meta: {},\n        ...file,\n    };\n}\n","import \"./UserWindows.less\";\n\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport classNames from \"classnames\";\nimport { observer } from \"mobx-react-lite\";\nimport { ClassroomStore, UserWindow } from \"@netless/flat-stores\";\nimport { AvatarWindow, fixRect, Rectangle, ResizeHandle, useIsUnMounted } from \"flat-components\";\nimport { WHITEBOARD_RATIO } from \"@netless/flat-stores/src/constants\";\n\nconst WINDOW_RATIO = 9 / 16;\nconst DEFAULT_WIDTH_P = 0.4;\nconst MIN_WIDTH_P = 0.25;\n\nconst clamp = (x: number, min: number, max: number): number => (x < min ? min : x > max ? max : x);\n\nexport interface UserWindowsProps {\n    classroom: ClassroomStore;\n}\n\nexport const UserWindows = observer<UserWindowsProps>(function UserWindows({ classroom }) {\n    const ref = useRef<HTMLDivElement>(null);\n    const [boundingRect, setBoundingRect] = useState<DOMRect | null>(null);\n    const [hovering, setHovering] = useState(false);\n\n    useEffect(() => {\n        if (ref.current) {\n            const div = ref.current;\n            const observer = new ResizeObserver(() => {\n                setBoundingRect(div.getBoundingClientRect());\n            });\n            observer.observe(div);\n            return () => observer.disconnect();\n        }\n        return;\n    }, []);\n\n    const baseRect = useMemo(() => {\n        if (!boundingRect) {\n            return { width: 0, height: 0 };\n        }\n        const { width, height } = boundingRect;\n        const fixedHeight = width * WHITEBOARD_RATIO;\n        if (fixedHeight < height) {\n            return { width, height: fixedHeight, extraY: (height - fixedHeight) / 2 };\n        } else {\n            const fixedWidth = height / WHITEBOARD_RATIO;\n            return { width: fixedWidth, height, extraX: (width - fixedWidth) / 2 };\n        }\n    }, [boundingRect]);\n\n    const users = (classroom.userWindowsGrid || [...classroom.userWindows.keys()]).map(userUUID => {\n        return { userUUID, window: classroom.userWindows.get(userUUID) };\n    });\n\n    const userWindowsLength = classroom.userWindowsGrid ? classroom.userWindowsGrid.length : 0;\n\n    const paddings = useMemo(() => {\n        if (!boundingRect) {\n            return { x: 0, y: 0 };\n        }\n        let rows: number;\n        if (1 <= userWindowsLength && userWindowsLength <= 2) {\n            rows = 1;\n        } else if (3 <= userWindowsLength && userWindowsLength <= 6) {\n            rows = 2;\n        } else if (7 <= userWindowsLength && userWindowsLength <= 12) {\n            rows = 3;\n        } else {\n            rows = 4;\n        }\n        let cols: number;\n        if (userWindowsLength === 1) {\n            cols = 1;\n        } else if (2 <= userWindowsLength && userWindowsLength <= 4) {\n            cols = 2;\n        } else if (5 <= userWindowsLength && userWindowsLength <= 9) {\n            cols = 3;\n        } else {\n            cols = 4;\n        }\n        // Solve: width = cols * windowWidth, height = rows * windowHeight\n        //        windowWidth * WINDOW_RATIO = windowHeight\n        //        width <= boundingWidth, height <= boundingHeight\n        const windowWidth = Math.min(\n            boundingRect.width / cols,\n            boundingRect.height / rows / WINDOW_RATIO,\n        );\n        const width = windowWidth * cols;\n        const height = windowWidth * rows * WINDOW_RATIO;\n        return {\n            x: (boundingRect.width - width) / 2,\n            y: (boundingRect.height - height) / 2,\n        };\n    }, [boundingRect, userWindowsLength]);\n\n    const onDrop = useCallback(\n        (ev: React.DragEvent<HTMLDivElement>) => {\n            setHovering(false);\n            classroom.onDragEnd();\n\n            const data = ev.dataTransfer.getData(\"video-avatar\");\n            if (!data || !boundingRect) {\n                return;\n            }\n            const [userUUID, rx, ry] = JSON.parse(data) as [\n                userUUID: string,\n                rx: number,\n                ry: number,\n            ];\n\n            const windowWidth = baseRect.width * DEFAULT_WIDTH_P;\n            const windowHeight = windowWidth * WINDOW_RATIO;\n\n            let x = ev.clientX - boundingRect.left - windowWidth * rx - (baseRect.extraX || 0);\n            let y = ev.clientY - boundingRect.top - windowHeight * ry - (baseRect.extraY || 0);\n\n            x = clamp(x, 0, baseRect.width - windowWidth);\n            y = clamp(y, 0, baseRect.height - windowHeight);\n\n            classroom.createAvatarWindow(userUUID, {\n                x: x / baseRect.width,\n                y: y / baseRect.height,\n                width: windowWidth / baseRect.width,\n                height: windowHeight / baseRect.height,\n            });\n        },\n        [baseRect, boundingRect, classroom],\n    );\n\n    const isGrid = classroom.userWindowsGrid;\n\n    return (\n        <div\n            ref={ref}\n            className={classNames(\"user-windows\", {\n                \"is-grid\": isGrid && userWindowsLength > 0,\n                \"is-hovering\": hovering,\n            })}\n            data-size={userWindowsLength}\n            style={{\n                paddingLeft: paddings.x,\n                paddingRight: paddings.x,\n                paddingTop: paddings.y,\n                paddingBottom: paddings.y,\n            }}\n        >\n            {users.map(({ userUUID, window }) => (\n                <UserAvatarWindow\n                    key={userUUID}\n                    baseRect={baseRect}\n                    classroom={classroom}\n                    mode={classroom.userWindowsMode}\n                    readonly={!classroom.isCreator}\n                    userUUID={userUUID}\n                    window={window}\n                />\n            ))}\n            {classroom.isDraggingAvatar && (\n                <div\n                    className=\"user-windows-mask\"\n                    onDragLeave={() => setHovering(false)}\n                    onDragOver={() => setHovering(true)}\n                    onDrop={onDrop}\n                />\n            )}\n        </div>\n    );\n});\n\ninterface UserAvatarWindowProps {\n    mode: \"maximized\" | \"normal\";\n    readonly: boolean;\n    userUUID: string;\n    /** may not exist on maximized mode */\n    window?: UserWindow;\n    baseRect: { width: number; height: number; extraX?: number; extraY?: number };\n    classroom: ClassroomStore;\n}\n\nconst DEFAULT_WINDOW: UserWindow = { x: 0, y: 0, width: 0.4, height: 0.4 * WINDOW_RATIO, z: 0 };\n\nconst UserAvatarWindow = observer<UserAvatarWindowProps>(function UserAvatarWindow({\n    mode,\n    readonly,\n    userUUID,\n    window: realWindow,\n    baseRect,\n    classroom,\n}) {\n    const isUnMounted = useIsUnMounted();\n    const [tempWindow, setTempWindow] = useState<UserWindow | null>(null);\n\n    useEffect(() => {\n        if (tempWindow) {\n            const ticket = setTimeout(() => {\n                classroom.updateAvatarWindow(userUUID, tempWindow);\n                if (!isUnMounted.current) {\n                    setTempWindow(null);\n                }\n            }, 50);\n            return () => clearTimeout(ticket);\n        }\n        return;\n    }, [classroom, isUnMounted, tempWindow, userUUID]);\n\n    const window = tempWindow || realWindow || DEFAULT_WINDOW;\n    const rect: Rectangle = useMemo(\n        () => ({\n            x: window.x * baseRect.width + (baseRect.extraX || 0),\n            y: window.y * baseRect.height + (baseRect.extraY || 0),\n            width: window.width * baseRect.width,\n            height: window.height * baseRect.height,\n        }),\n        [baseRect, window],\n    );\n\n    const onClick = useCallback(() => {\n        realWindow && classroom.updateAvatarWindow(userUUID, realWindow);\n    }, [classroom, realWindow, userUUID]);\n\n    const onDoubleClick = useCallback(() => {\n        classroom.toggleUserWindowsMode();\n    }, [classroom]);\n\n    const onDragEnd = useCallback(\n        (ev: PointerEvent) => {\n            classroom.setDroppingUserUUID(null);\n            const el = document.elementFromPoint(ev.clientX, ev.clientY);\n            if (el && (el as HTMLElement).dataset?.userUuid) {\n                classroom.deleteAvatarWindow(userUUID);\n            }\n        },\n        [classroom, userUUID],\n    );\n\n    const onDragging = useCallback(\n        (ev: PointerEvent) => {\n            const el = document.elementFromPoint(ev.clientX, ev.clientY);\n            if (el && (el as HTMLElement).dataset?.userUuid) {\n                classroom.setDroppingUserUUID(userUUID);\n            } else {\n                classroom.setDroppingUserUUID(null);\n            }\n        },\n        [classroom, userUUID],\n    );\n\n    const onResize = useCallback(\n        (rect: Rectangle, handle: ResizeHandle | undefined) => {\n            rect.x -= baseRect.extraX || 0;\n            rect.y -= baseRect.extraY || 0;\n            const { x, y, width, height } = fixRect(\n                rect,\n                handle,\n                WINDOW_RATIO,\n                MIN_WIDTH_P * baseRect.width,\n                baseRect.width,\n                baseRect.height,\n            );\n            setTempWindow({\n                x: x / baseRect.width,\n                y: y / baseRect.height,\n                width: width / baseRect.width,\n                height: height / baseRect.height,\n                // give the temp window a very large z so that it renders correct,\n                // but set a correct z when we really update the storage.\n                // see classroom.updateAvatarWindow()\n                z: 2147483647,\n            });\n        },\n        [baseRect],\n    );\n\n    return (\n        <AvatarWindow\n            key={userUUID}\n            mode={mode}\n            readonly={readonly}\n            rect={rect}\n            zIndex={window.z}\n            onClick={onClick}\n            onDoubleClick={onDoubleClick}\n            onDragEnd={onDragEnd}\n            onDragging={onDragging}\n            onResize={onResize}\n        >\n            <UserWindowPortal classroom={classroom} mode={mode} userUUID={userUUID} />\n        </AvatarWindow>\n    );\n});\n\ninterface UserWindowPortalProps {\n    mode: \"maximized\" | \"normal\";\n    userUUID: string;\n    classroom: ClassroomStore;\n}\n\nconst UserWindowPortal: React.FC<UserWindowPortalProps> = ({ mode, userUUID, classroom }) => (\n    <div\n        ref={useCallback(element => classroom.setPortal(userUUID, element), [classroom, userUUID])}\n        className={classNames(\"user-window-portal\", { \"is-grid\": mode === \"maximized\" })}\n    />\n);\n","import \"@netless/window-manager/dist/style.css\";\nimport \"./Whiteboard.less\";\n\nimport classNames from \"classnames\";\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { RoomPhase } from \"white-web-sdk\";\nimport {\n    DarkModeContext,\n    PresetsModal,\n    RaiseHand,\n    RaisingHand,\n    SaveAnnotationModal,\n    SaveAnnotationModalProps,\n} from \"flat-components\";\nimport { FlatI18nTFunction, useTranslate } from \"@netless/flat-i18n\";\nimport { observer } from \"mobx-react-lite\";\nimport { message } from \"antd\";\nimport { WhiteboardStore, ClassroomStore } from \"@netless/flat-stores\";\nimport { FlatServices, getFileExt } from \"@netless/flat-services\";\nimport { format } from \"date-fns\";\nimport { listen } from \"@wopjs/dom\";\nimport { isSupportedFileExt } from \"../utils/drag-and-drop\";\nimport { isSupportedImageType, onDropImage } from \"../utils/drag-and-drop/image\";\nimport { PRESETS } from \"../constants/presets\";\nimport { createCloudFile } from \"../utils/create-cloud-file\";\nimport { UserWindows } from \"./UserWindows\";\n\nexport interface WhiteboardProps {\n    whiteboardStore: WhiteboardStore;\n    classRoomStore: ClassroomStore;\n    disableHandRaising?: boolean;\n}\n\nconst noop = (): void => {\n    // noop\n};\n\nexport const Whiteboard = observer<WhiteboardProps>(function Whiteboard({\n    whiteboardStore,\n    classRoomStore,\n    disableHandRaising,\n}) {\n    const t = useTranslate();\n    const { room, windowManager, phase, whiteboard } = whiteboardStore;\n    const isDark = useContext(DarkModeContext);\n\n    const [saveAnnotationVisible, showSaveAnnotation] = useState(false);\n    const [saveAnnotationImages, setSaveAnnotationImages] = useState<\n        SaveAnnotationModalProps[\"images\"]\n    >([]);\n    const [presetsVisible, showPresets] = useState(false);\n    const [page, setPage] = useState(0);\n    const [maxPage, setMaxPage] = useState(Infinity);\n    const [showPage, setShowPage] = useState(false);\n\n    const isReconnecting = phase === RoomPhase.Reconnecting;\n    const handRaisingCount = classRoomStore.users.handRaisingJoiners.length;\n\n    useEffect(() => {\n        return whiteboard.events.on(\"exportAnnotations\", () => showSaveAnnotation(true));\n    }, [whiteboard]);\n\n    useEffect(() => {\n        return whiteboard.events.on(\"insertPresets\", () => showPresets(true));\n    }, [whiteboard]);\n\n    useEffect(() => {\n        const stopListenPage = whiteboard.events.on(\"scrollPage\", setPage);\n        const stopListenMaxPage = whiteboard.events.on(\"maxScrollPage\", setMaxPage);\n        const stopListenUserScroll = whiteboard.events.on(\"userScroll\", () => setShowPage(true));\n        return () => {\n            stopListenPage();\n            stopListenMaxPage();\n            stopListenUserScroll();\n        };\n    }, [whiteboard]);\n\n    useEffect(() => {\n        if (showPage) {\n            let isMounted = true;\n            const timer = setTimeout(() => {\n                isMounted && setShowPage(false);\n            }, 1000);\n            return () => {\n                clearTimeout(timer);\n                isMounted = false;\n            };\n        } else {\n            return;\n        }\n    }, [showPage]);\n\n    useEffect(() => {\n        whiteboard.setTheme(isDark ? \"dark\" : \"light\");\n    }, [isDark, whiteboard]);\n\n    useEffect(() => {\n        return isReconnecting ? message.info(t(\"reconnecting\"), 0) : noop;\n    }, [isReconnecting, t]);\n\n    useEffect(() => {\n        if (saveAnnotationVisible) {\n            setSaveAnnotationImages(whiteboardStore.getSaveAnnotationImages());\n        }\n    }, [saveAnnotationVisible, whiteboardStore]);\n\n    const bindWhiteboard = useCallback(\n        (ref: HTMLDivElement | null) => {\n            ref && whiteboard.render(ref);\n        },\n        [whiteboard],\n    );\n\n    const insertPresetImage = useCallback(async (fileURL: string) => {\n        const fileService = await FlatServices.getInstance().requestService(\"file\");\n        if (fileService) {\n            fileService.insert(createCloudFile({ fileName: `${Date.now()}.png`, fileURL }));\n        }\n        showPresets(false);\n    }, []);\n\n    const onDragOver = useCallback(\n        (event: React.DragEvent<HTMLDivElement>) => {\n            event.preventDefault();\n            const file = event.dataTransfer.files[0];\n            if (room && file && isSupportedFileExt(file)) {\n                event.dataTransfer.dropEffect = \"copy\";\n            }\n        },\n        [room],\n    );\n\n    const onDrop = useCallback(\n        async (event: React.DragEvent<HTMLDivElement>) => {\n            event.preventDefault();\n            const file = event.dataTransfer.files[0];\n            if (room && file) {\n                if (isSupportedImageType(file)) {\n                    const rect = (event.target as HTMLDivElement).getBoundingClientRect();\n                    const rx = event.clientX - rect.left;\n                    const ry = event.clientY - rect.top;\n                    const { x, y } = room.convertToPointInWorld({ x: rx, y: ry });\n                    await onDropImage(file, x, y, room, whiteboardStore.cloudStorageStore);\n                } else if (isSupportedFileExt(file)) {\n                    whiteboardStore.onDrop(file);\n                }\n            }\n        },\n        [room, whiteboardStore],\n    );\n\n    useEffect(() => {\n        const pasteHandler = (event: ClipboardEvent): void => {\n            const file = event.clipboardData?.files[0];\n            if (room && windowManager && file) {\n                const { centerX, centerY } = windowManager.camera;\n                if (isSupportedImageType(file)) {\n                    const id = format(Date.now(), \"yyyy-MM-dd_HH-mm-ss\");\n                    const extname = getFileExt(file.name);\n                    const fileName = `screenshot_${id}.${extname}`;\n                    const renamed = new File([file], fileName, {\n                        type: file.type,\n                        lastModified: file.lastModified,\n                    });\n                    onDropImage(renamed, centerX, centerY, room, whiteboardStore.cloudStorageStore);\n                } else if (isSupportedFileExt(file)) {\n                    whiteboardStore.onDrop(file);\n                }\n            }\n        };\n        document.addEventListener(\"paste\", pasteHandler);\n        return () => document.removeEventListener(\"paste\", pasteHandler);\n    }, [room, whiteboardStore, windowManager]);\n\n    // Toggle off hand raising panel when there's user input on whiteboard.\n    useEffect(() => {\n        if (classRoomStore.isHandRaisingPanelVisible) {\n            const whiteboard: HTMLDivElement | null = document.querySelector(\".fastboard-view\");\n            if (whiteboard) {\n                return listen(\n                    whiteboard,\n                    \"pointerdown\",\n                    () => classRoomStore.onToggleHandRaisingPanel(false),\n                    { capture: true },\n                );\n            }\n        }\n        return;\n    }, [classRoomStore, classRoomStore.isHandRaisingPanelVisible]);\n\n    return (\n        <>\n            {room && (\n                <div\n                    className={classNames(\"whiteboard-container\", {\n                        \"is-readonly\": !whiteboardStore.allowDrawing,\n                    })}\n                    onDragOver={onDragOver}\n                    onDrop={onDrop}\n                >\n                    <div\n                        ref={bindWhiteboard}\n                        className={classNames(\"whiteboard\", {\n                            \"can-operate\":\n                                !classRoomStore.userWindowsGrid &&\n                                (classRoomStore.isCreator ||\n                                    classRoomStore.users.currentUser?.wbOperate),\n                        })}\n                    />\n                    <UserWindows classroom={classRoomStore} />\n                    {!whiteboardStore.isCreator &&\n                        classRoomStore.users.currentUser &&\n                        !classRoomStore.users.currentUser.isSpeak && (\n                            <div className=\"raise-hand-container\">\n                                <RaiseHand\n                                    disableHandRaising={disableHandRaising}\n                                    isRaiseHand={classRoomStore.users.currentUser?.isRaiseHand}\n                                    onRaiseHandChange={classRoomStore.onToggleHandRaising}\n                                />\n                            </div>\n                        )}\n                    {whiteboardStore.isCreator && (\n                        <div className=\"raise-hand-container\">\n                            <RaisingHand\n                                active={handRaisingCount > 0}\n                                count={handRaisingCount}\n                                onClick={() => classRoomStore.onToggleHandRaisingPanel()}\n                            />\n                        </div>\n                    )}\n                    <div\n                        className={classNames(\"whiteboard-scroll-page\", {\n                            \"is-active\": showPage,\n                        })}\n                    >\n                        {renderScrollPage(t, page, maxPage)}\n                    </div>\n                    <div\n                        className={classNames(\"hand-raising-panel\", {\n                            \"is-active\": classRoomStore.isHandRaisingPanelVisible,\n                            \"is-empty\": handRaisingCount === 0,\n                        })}\n                    >\n                        {classRoomStore.users.handRaisingJoiners.map(user => (\n                            <div\n                                key={user.userUUID}\n                                className=\"hand-raising-user\"\n                                title={user.name}\n                            >\n                                <img\n                                    alt=\"avatar\"\n                                    className=\"hand-raising-user-avatar\"\n                                    src={user.avatar}\n                                />\n                                <span className=\"hand-raising-user-name\">{user.name}</span>\n                                <button\n                                    className=\"hand-raising-btn\"\n                                    onClick={() => classRoomStore.onStaging(user.userUUID, true)}\n                                >\n                                    {t(\"agree\")}\n                                </button>\n                            </div>\n                        ))}\n                        {handRaisingCount === 0 && (\n                            <div className=\"hand-raising-empty\">{t(\"no-one-raising-hand\")}</div>\n                        )}\n                    </div>\n                </div>\n            )}\n            <SaveAnnotationModal\n                images={saveAnnotationImages}\n                visible={saveAnnotationVisible}\n                onClose={() => showSaveAnnotation(false)}\n            />\n            <PresetsModal\n                images={PRESETS}\n                visible={presetsVisible}\n                onClick={insertPresetImage}\n                onClose={() => showPresets(false)}\n            />\n        </>\n    );\n});\n\nfunction renderScrollPage(t: FlatI18nTFunction, page: number, maxPage: number): string {\n    if (page === 0) {\n        return t(\"scroll.first-page\");\n    } else if (page >= maxPage) {\n        return t(\"scroll.last-page\");\n    } else {\n        return t(\"scroll.page\", { page: ((((page + 1) * 10) | 0) / 10).toFixed(1) });\n    }\n}\n","import \"./AvatarCanvas.less\";\n\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport { IServiceVideoChatAvatar } from \"@netless/flat-services\";\n\nimport { User } from \"@netless/flat-stores\";\n\nexport interface AvatarCanvasProps {\n    /** the user of this avatar */\n    avatarUser?: User | null;\n    rtcAvatar?: IServiceVideoChatAvatar | null;\n}\n\nexport const AvatarCanvas = observer<\n    AvatarCanvasProps & {\n        children: (\n            getVolumeLevel: () => number,\n            canvas: React.ReactNode,\n        ) => React.ReactElement | null;\n    }\n>(function AvatarCanvas({ avatarUser, rtcAvatar, children }) {\n    const camera = avatarUser?.camera;\n    const mic = avatarUser?.mic;\n\n    const [canvasEl, setCanvasEl] = useState<HTMLDivElement | null>(null);\n\n    const getVolumeLevel = useCallback((): number => {\n        return rtcAvatar?.getVolumeLevel() || 0;\n    }, [rtcAvatar]);\n\n    useEffect(() => {\n        if (rtcAvatar) {\n            rtcAvatar.setElement(canvasEl);\n        }\n    }, [canvasEl, rtcAvatar]);\n\n    useEffect(\n        () => () => {\n            if (rtcAvatar) {\n                rtcAvatar.setElement(null);\n                rtcAvatar.enableCamera(false);\n                rtcAvatar.enableMic(false);\n            }\n        },\n        [rtcAvatar],\n    );\n\n    useEffect(() => {\n        if (rtcAvatar) {\n            rtcAvatar.enableCamera(Boolean(camera));\n        }\n    }, [camera, rtcAvatar]);\n\n    useEffect(() => {\n        if (rtcAvatar) {\n            rtcAvatar.enableMic(Boolean(mic));\n        }\n    }, [mic, rtcAvatar]);\n\n    const canvas = <div ref={setCanvasEl} className=\"video-avatar-canvas\" />;\n\n    return children(getVolumeLevel, canvas);\n});\n","import React, { FC } from \"react\";\nimport { observer } from \"mobx-react-lite\";\nimport {\n    VideoAvatar,\n    VideoAvatarAbsent,\n    VideoAvatarAbsentProps,\n    VideoAvatarProps,\n} from \"flat-components\";\nimport { AvatarCanvas, AvatarCanvasProps } from \"./AvatarCanvas\";\nexport type RTCAvatarProps = Omit<VideoAvatarProps, \"getVolumeLevel\" | \"avatarUser\" | \"portal\"> &\n    VideoAvatarAbsentProps &\n    AvatarCanvasProps & { getPortal: (userUUID: string) => HTMLElement | undefined };\n\nexport const RTCAvatar: FC<RTCAvatarProps> = /* @__PURE__ */ observer<RTCAvatarProps>(\n    function RTCAvatar({\n        userUUID,\n        avatarUser,\n        rtcAvatar,\n        isAvatarUserCreator,\n        small,\n        isCreator,\n        isDropTarget,\n        onDoubleClick,\n        getPortal,\n        onDragStart,\n        onDragEnd,\n        updateDeviceState,\n    }) {\n        return avatarUser && !avatarUser.hasLeft ? (\n            <AvatarCanvas avatarUser={avatarUser} rtcAvatar={rtcAvatar}>\n                {(getVolumeLevel, canvas) => (\n                    <VideoAvatar\n                        avatarUser={avatarUser}\n                        getVolumeLevel={getVolumeLevel}\n                        isCreator={isCreator}\n                        isDropTarget={isDropTarget}\n                        portal={getPortal(avatarUser.userUUID)}\n                        small={small}\n                        updateDeviceState={updateDeviceState}\n                        userUUID={userUUID}\n                        onDoubleClick={onDoubleClick}\n                        onDragEnd={onDragEnd}\n                        onDragStart={onDragStart}\n                    >\n                        {canvas}\n                    </VideoAvatar>\n                )}\n            </AvatarCanvas>\n        ) : (\n            <VideoAvatarAbsent\n                avatarUser={avatarUser}\n                isAvatarUserCreator={isAvatarUserCreator}\n                isCreator={isCreator}\n                isDropTarget={isDropTarget}\n                portal={avatarUser && getPortal(avatarUser.userUUID)}\n                small={small}\n                onDoubleClick={onDoubleClick}\n                onDragEnd={onDragEnd}\n                onDragStart={onDragStart}\n            />\n        );\n    },\n);\n","export default \"data:image/svg+xml;charset=utf8,%3csvg width='6' height='10' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M1 8a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2ZM1 4a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2ZM1 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z' fill='white' fill-rule='evenodd'/%3e%3c/svg%3e\";","import \"./style.less\";\n\nimport dragSVG from \"../../../assets/image/drag.svg\";\n\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\nimport { Button } from \"antd\";\n\nimport { WindowsSystemBtnContext } from \"../../StoreProvider\";\n\ninterface ShareScreenTipProps {\n    classroomStore: ClassroomStore;\n}\n\nexport const ShareScreenTip = observer<ShareScreenTipProps>(function ShareScreenTip({\n    classroomStore,\n}) {\n    const t = useTranslate();\n    const windows = useContext(WindowsSystemBtnContext);\n    const [containerEl] = useState(() => document.createElement(\"div\"));\n\n    useEffect(() => {\n        if (windows) {\n            return windows.createShareScreenTipPortalWindow(\n                containerEl,\n                t(\"share-screen.tip-window-title\"),\n            );\n        }\n        return;\n    }, [containerEl, t, windows]);\n\n    const stopShareScreen = useCallback(\n        () => classroomStore.toggleShareScreen(false),\n        [classroomStore],\n    );\n\n    return ReactDOM.createPortal(\n        <div className={\"share-screen-tip\"}>\n            <div>\n                <img alt=\"drag icon\" src={dragSVG} />\n                <span>{t(\"share-screen.tip-window-body\")}</span>\n            </div>\n            <Button danger ghost onClick={stopShareScreen}>\n                {t(\"share-screen.tip-window-button\")}\n            </Button>\n        </div>,\n        containerEl,\n    );\n});\n","import \"./style.less\";\n\nimport React, { useEffect, useMemo, useRef } from \"react\";\nimport classNames from \"classnames\";\nimport { message } from \"antd\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\n\nimport { ShareScreenTip } from \"./ShareScreenTip\";\n\ninterface ShareScreenProps {\n    classroomStore: ClassroomStore;\n}\n\nexport const ShareScreen = observer<ShareScreenProps>(function ShareScreen({ classroomStore }) {\n    const ref = useRef<HTMLDivElement>(null);\n    const t = useTranslate();\n\n    useEffect(() => {\n        if (ref.current) {\n            classroomStore.rtc.shareScreen.setElement(ref.current);\n        }\n    }, [classroomStore]);\n\n    useEffect(() => {\n        const onBrowserNotPermission = (error: Error): void => {\n            if (isAgoraRTCPermissionError(error) && browserNotPermission(error.message)) {\n                void message.error(t(\"share-screen.browser-not-permission\"));\n            }\n        };\n\n        classroomStore.rtc.shareScreen.events.on(\"err-enable\", onBrowserNotPermission);\n\n        return () => {\n            classroomStore.rtc.shareScreen.events.off(\"err-enable\", onBrowserNotPermission);\n        };\n    }, [classroomStore.rtc.shareScreen.events, t]);\n\n    const classNameList = useMemo(() => {\n        return classNames(\"share-screen\", {\n            active: classroomStore.isRemoteScreenSharing,\n        });\n    }, [classroomStore.isRemoteScreenSharing]);\n\n    if (window.isElectron) {\n        return (\n            <>\n                <div ref={ref} className={classNameList} />\n                {classroomStore.isScreenSharing && (\n                    <ShareScreenTip classroomStore={classroomStore} />\n                )}\n            </>\n        );\n    }\n\n    return <div ref={ref} className={classNameList} />;\n});\n\nfunction isAgoraRTCPermissionError(error: any): error is Error {\n    return \"code\" in error && \"message\" in error && error.code === \"PERMISSION_DENIED\";\n}\n\nfunction browserNotPermission(message: string): boolean {\n    return message.indexOf(\"by system\") !== -1;\n}\n","import { ClassroomStore, ClassroomStoreConfig } from \"@netless/flat-stores\";\nimport { useEffect, useState } from \"react\";\nimport { RouteNameType, usePushHistory } from \"../utils/routes\";\nimport { errorTips, useSafePromise } from \"flat-components\";\nimport { FlatServices } from \"@netless/flat-services\";\n\nexport type useClassRoomStoreConfig = Omit<\n    ClassroomStoreConfig,\n    \"rtc\" | \"rtm\" | \"whiteboard\" | \"recording\"\n>;\n\nexport function useClassroomStore(config: useClassRoomStoreConfig): ClassroomStore | undefined {\n    const [classroomStore, setClassroomStore] = useState<ClassroomStore>();\n\n    const pushHistory = usePushHistory();\n    const sp = useSafePromise();\n\n    const title = classroomStore?.roomInfo?.title;\n    useEffect(() => {\n        if (title) {\n            document.title = title;\n        }\n    }, [title]);\n\n    useEffect(() => {\n        let isUnmounted = false;\n        let classroomStore: ClassroomStore | undefined;\n        const flatServices = FlatServices.getInstance();\n\n        sp(\n            Promise.all([\n                flatServices.requestService(\"videoChat\"),\n                flatServices.requestService(\"textChat\"),\n                flatServices.requestService(\"whiteboard\"),\n                flatServices.requestService(\"recording\"),\n            ]),\n        ).then(([videoChat, textChat, whiteboard, recording]) => {\n            if (!isUnmounted && videoChat && textChat && whiteboard && recording) {\n                classroomStore = new ClassroomStore({\n                    ...config,\n                    rtc: videoChat,\n                    rtm: textChat,\n                    whiteboard,\n                    recording,\n                });\n                setClassroomStore(classroomStore);\n                sp(classroomStore.init()).catch(e => {\n                    errorTips(e);\n                    pushHistory(RouteNameType.HomePage);\n                });\n            }\n        });\n\n        return () => {\n            isUnmounted = true;\n            classroomStore?.destroy().catch(e => {\n                if (process.env.NODE_ENV !== \"production\") {\n                    console.error(e);\n                }\n            });\n            flatServices.shutdownService(\"videoChat\");\n            flatServices.shutdownService(\"textChat\");\n            flatServices.shutdownService(\"whiteboard\");\n            flatServices.shutdownService(\"recording\");\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    return classroomStore;\n}\n","import React from \"react\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\nimport { RouteNameType, RouteParams } from \"../utils/routes\";\nimport { useParams } from \"react-router-dom\";\nimport { useClassroomStore } from \"./use-classroom-store\";\nimport { LoadingPage } from \"flat-components\";\nimport { RoomPhase } from \"white-web-sdk\";\nimport { observer } from \"mobx-react-lite\";\n\nexport type WithClassroomStoreProps<P = {}> = P & { classroomStore: ClassroomStore };\n\nexport const withClassroomStore = <P extends {}>(\n    Component: React.ComponentType<WithClassroomStoreProps<P>>,\n): React.FC<P> =>\n    observer<P>(function WithClassroomStore(props) {\n        const params =\n            useParams<\n                RouteParams<\n                    | RouteNameType.BigClassPage\n                    | RouteNameType.SmallClassPage\n                    | RouteNameType.OneToOnePage\n                >\n            >();\n        const classroomStore = useClassroomStore(params);\n\n        const isReady =\n            classroomStore &&\n            classroomStore.whiteboardStore.room &&\n            classroomStore.whiteboardStore.phase !== RoomPhase.Connecting &&\n            classroomStore.whiteboardStore.phase !== RoomPhase.Disconnecting;\n\n        return isReady ? (\n            <Component classroomStore={classroomStore} {...props} />\n        ) : (\n            <LoadingPage onTimeout=\"full-reload\" />\n        );\n    });\n","import \"./style.less\";\n\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { IServiceShareScreenInfo } from \"@netless/flat-services\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\nimport { message } from \"antd\";\n\nconst uint8ArrayToImageURL = (buffer: Uint8Array): string => {\n    return URL.createObjectURL(\n        new Blob([buffer.buffer], {\n            type: \"image/png\",\n        }),\n    );\n};\n\ninterface ScreenListProps {\n    screenInfo: IServiceShareScreenInfo[];\n    classroomStore: ClassroomStore;\n}\n\nexport const ScreenList = observer<ScreenListProps>(function ShareScreen({\n    screenInfo,\n    classroomStore,\n}) {\n    const [activeInfo, setActiveInfo] = useState(\"\");\n    const t = useTranslate();\n\n    useEffect(() => {\n        if (screenInfo.length === 0) {\n            void message.error(t(\"share-screen.desktop-not-permission\"));\n        }\n    }, [screenInfo, t]);\n\n    const onClick = useCallback(\n        (screenInfo: IServiceShareScreenInfo, activeKey: string) => {\n            setActiveInfo(activeKey);\n            classroomStore.selectShareScreenInfo(screenInfo);\n        },\n        [classroomStore],\n    );\n\n    const cancelSelected = useCallback(() => {\n        setActiveInfo(\"\");\n        classroomStore.selectShareScreenInfo(null);\n    }, [classroomStore]);\n\n    return (\n        <div className=\"screen-list\">\n            {screenInfo.map(info => {\n                const id = typeof info.screenId === \"number\" ? info.screenId : info.screenId.id;\n                const key = `${info.type}-${id}`;\n                const isActive = activeInfo === key;\n\n                return (\n                    <ScreenItem\n                        key={key}\n                        active={isActive}\n                        activeKey={key}\n                        handleClick={isActive ? cancelSelected : onClick}\n                        info={info}\n                    />\n                );\n            })}\n        </div>\n    );\n});\n\ninterface ScreenItemProps {\n    info: IServiceShareScreenInfo;\n    handleClick: (screenInfo: IServiceShareScreenInfo, key: string) => void;\n    active: boolean;\n    activeKey: string;\n}\n\nconst ScreenItem = observer<ScreenItemProps>(function ScreenItem({\n    info,\n    handleClick,\n    active,\n    activeKey,\n}) {\n    return (\n        <>\n            <div className=\"screen-item\">\n                <div\n                    className={classNames(\"screen-image-box\", {\n                        active,\n                    })}\n                    onClick={() => handleClick(info, activeKey)}\n                >\n                    <img alt=\"screenshots\" src={uint8ArrayToImageURL(info.image)} />\n                </div>\n                <span>{info.name}</span>\n            </div>\n        </>\n    );\n});\n","import \"./style.less\";\n\nimport React, { useCallback, useLayoutEffect, useState } from \"react\";\nimport classNames from \"classnames\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\nimport { Button, Modal, Spin } from \"antd\";\nimport { observer } from \"mobx-react-lite\";\n\nimport { ScreenList } from \"./ScreenList\";\n\ninterface ShareScreenPickerProps {\n    classroomStore: ClassroomStore;\n    handleOk: () => void;\n}\n\nconst ShareScreenPickerModel = observer<ShareScreenPickerProps>(function ShareScreen({\n    classroomStore,\n    handleOk,\n}) {\n    const t = useTranslate();\n\n    useLayoutEffect(() => {\n        classroomStore.refreshShareScreenInfo();\n    }, [classroomStore]);\n\n    const closeModal = useCallback(() => {\n        classroomStore.toggleShareScreenPicker(false);\n    }, [classroomStore]);\n\n    const isSelected = classroomStore.selectedScreenInfo !== null;\n\n    return (\n        <div>\n            <Modal\n                centered\n                open\n                bodyStyle={{\n                    padding: \"16px 0 0 16px\",\n                }}\n                className=\"share-screen-picker-model\"\n                footer={[\n                    <Button key=\"cancel\" className=\"footer-button\" onClick={closeModal}>\n                        {t(\"cancel\")}\n                    </Button>,\n                    <ConfirmButton key={\"confirm\"} handleOk={handleOk} isSelected={isSelected} />,\n                ]}\n                title={t(\"share-screen.choose-share-content\")}\n                width=\"784px\"\n                onCancel={closeModal}\n            >\n                <div\n                    className={classNames(\"share-screen-picker\", {\n                        loading: classroomStore.shareScreenInfo.length === 0,\n                    })}\n                >\n                    {classroomStore.shareScreenInfo.length > 0 ? (\n                        <ScreenList\n                            classroomStore={classroomStore}\n                            screenInfo={classroomStore.shareScreenInfo}\n                        />\n                    ) : (\n                        <Spin size=\"large\" />\n                    )}\n                </div>\n            </Modal>\n        </div>\n    );\n});\n\nexport const ShareScreenPicker = observer<ShareScreenPickerProps>(function ShareScreen({\n    classroomStore: classRoomStore,\n    handleOk,\n}) {\n    return classRoomStore.shareScreenPickerVisible ? (\n        <ShareScreenPickerModel classroomStore={classRoomStore} handleOk={handleOk} />\n    ) : null;\n});\n\ninterface ConfirmButtonProps {\n    isSelected: boolean;\n    handleOk: () => void;\n}\n\nconst ConfirmButton = observer<ConfirmButtonProps>(function ConfirmButton({\n    isSelected,\n    handleOk,\n}) {\n    const [confirmLoading, setConfirmLoading] = useState(false);\n    const t = useTranslate();\n\n    return (\n        <Button\n            key=\"submit\"\n            className=\"footer-button\"\n            disabled={!isSelected}\n            loading={confirmLoading}\n            type=\"primary\"\n            onClick={() => {\n                setConfirmLoading(true);\n                handleOk();\n            }}\n        >\n            {t(\"confirm\")}\n        </Button>\n    );\n});\n","import \"./ExtraPadding.less\";\n\nimport React, { useContext } from \"react\";\nimport { RuntimeContext } from \"./StoreProvider\";\n\nexport const ExtraPadding: React.FC = React.memo(function ExtraPadding() {\n    const runtime = useContext(RuntimeContext);\n    return runtime?.isMac ? <div className=\"extra-padding\" /> : null;\n});\n","import \"./UsersButton.less\";\n\n// TODO: remove this component when multi sub window is done\nimport React, { useCallback, useEffect } from \"react\";\nimport { Modal } from \"antd\";\nimport { observer } from \"mobx-react-lite\";\nimport { useTranslate } from \"@netless/flat-i18n\";\nimport { ClassroomStore } from \"@netless/flat-stores\";\nimport { SVGUserGroup, TopBarRightBtn, useComputed, UsersPanel } from \"flat-components\";\n\ninterface UsersButtonProps {\n    classroom: ClassroomStore;\n}\n\nexport const UsersButton = observer<UsersButtonProps>(function UsersButton({ classroom }) {\n    const t = useTranslate();\n\n    // not including teacher\n    const users = useComputed(() => {\n        const { offlineJoiners } = classroom;\n        const { speakingJoiners, handRaisingJoiners, otherJoiners } = classroom.users;\n        return [...speakingJoiners, ...handRaisingJoiners, ...offlineJoiners, ...otherJoiners].sort(\n            (a, b) => a.name.localeCompare(b.name),\n        );\n    }).get();\n\n    const getDeviceState = useCallback(\n        (userUUID: string): { camera: boolean; mic: boolean } => {\n            return classroom.deviceStateStorage?.state[userUUID] ?? { camera: false, mic: false };\n        },\n        [classroom.deviceStateStorage],\n    );\n\n    const getVolumeLevel = useCallback(\n        (userUUID: string): number => {\n            const uid = classroom.users.cachedUsers.get(userUUID)?.rtcUID;\n            return classroom.rtc.getVolumeLevel(uid);\n        },\n        [classroom.rtc, classroom.users.cachedUsers],\n    );\n\n    useEffect(() => {\n        if (classroom.isRequestingCamera) {\n            const handle = Modal.confirm({\n                content: t(\"teacher-request-camera\"),\n                onOk() {\n                    const { mic } = getDeviceState(classroom.userUUID);\n                    classroom.updateDeviceState(classroom.userUUID, true, mic);\n                    classroom.toggleRequestingDevice(false, undefined);\n                    classroom.replyRequestingDevice(\"camera\", true);\n                },\n                onCancel() {\n                    classroom.toggleRequestingDevice(false, undefined);\n                    classroom.replyRequestingDevice(\"camera\", false);\n                },\n            });\n            return () => handle.destroy();\n        }\n        return;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [t, classroom.isRequestingCamera, getDeviceState]);\n\n    useEffect(() => {\n        if (classroom.isRequestingMic) {\n            const handle = Modal.confirm({\n                content: t(\"teacher-request-mic\"),\n                onOk() {\n                    const { camera } = getDeviceState(classroom.userUUID);\n                    classroom.updateDeviceState(classroom.userUUID, camera, true);\n                    classroom.toggleRequestingDevice(undefined, false);\n                    classroom.replyRequestingDevice(\"mic\", true);\n                },\n                onCancel() {\n                    classroom.toggleRequestingDevice(undefined, false);\n                    classroom.replyRequestingDevice(\"mic\", false);\n                },\n            });\n            return () => handle.destroy();\n        }\n        return;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [t, classroom.isRequestingMic, getDeviceState]);\n\n    return (\n        <>\n            <TopBarRightBtn\n                icon={<SVGUserGroup />}\n                title={t(\"users\")}\n                onClick={() => classroom.toggleUsersPanel(!classroom.isUsersPanelVisible)}\n            />\n            <Modal\n                centered\n                destroyOnClose\n                className=\"users-button-modal\"\n                footer={[]}\n                open={classroom.isUsersPanelVisible}\n                title={t(\"users\")}\n                onCancel={() => classroom.toggleUsersPanel(false)}\n            >\n                <UsersPanel\n                    getDeviceState={getDeviceState}\n                    getVolumeLevel={getVolumeLevel}\n                    ownerUUID={classroom.ownerUUID}\n                    roomInfo={classroom.roomInfo}\n                    userUUID={classroom.userUUID}\n                    users={users}\n                    onDeviceState={classroom.updateDeviceState}\n                    onMuteAll={classroom.muteAll}\n                    onOffStageAll={classroom.offStageAll}\n                    onStaging={classroom.onStaging}\n                    onWhiteboard={classroom.authorizeWhiteboard}\n                />\n            </Modal>\n        </>\n    );\n});\n"],"names":["_typeof","obj","add","dirtyDate","duration","requiredArgs","years","toInteger","months","weeks","days","hours","minutes","seconds","date","toDate","dateWithMonths","addMonths","dateWithDays","addDays","minutesToAdd","secondsToAdd","msToAdd","finalDate","differenceInCalendarMonths","dirtyDateLeft","dirtyDateRight","dateLeft","dateRight","yearDiff","monthDiff","differenceInCalendarYears","compareLocalAsc","diff","differenceInDays","sign","difference","differenceInCalendarDays","isLastDayNotFull","result","differenceInMilliseconds","differenceInHours","options","millisecondsInHour","getRoundingMethod","differenceInMinutes","millisecondsInMinute","isLastDayOfMonth","endOfDay","endOfMonth","differenceInMonths","compareAsc","isLastMonthNotFull","differenceInSeconds","differenceInYears","isLastYearNotFull","intervalToDuration","interval","start","end","remainingMonths","remainingDays","remainingHours","remainingMinutes","remainingSeconds","updateReducer","num","useUpdate","_a","useReducer","update","Switch","React","_ref","ref","_classNames","_ref$prefixCls","prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown","restProps","_objectWithoutProperties","_useMergedState","useMergedState","value","defaultValue","_useMergedState2","_slicedToArray","innerChecked","setInnerChecked","triggerChange","newChecked","event","mergedChecked","onInternalKeyDown","e","which","KeyCode","LEFT","RIGHT","onInternalClick","ret","switchClassName","classNames","_defineProperty","concat","_jsxs","Object","assign","type","role","_jsx","displayName","__rest","this","s","t","p","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","customizePrefixCls","customizeSize","size","customDisabled","loading","_a$className","props","_React$useContext","ConfigContext","getPrefixCls","direction","SizeContext","DisabledContext","mergedDisabled","LoadingOutlined","classes","Wave","RcSwitch","__ANT_SWITCH","Switch$1","chatMessagesDefaultSVG","chatMessagesDefaultDarkSVG","SVGCamera","active","SVGCameraMute","SVGChatBanning","SVGExit","SVGHandUp","SVGMenuFold","SVGMenuUnfold","SVGMicrophoneMute","SVGPlus","SVGRecord","SVGRecordStop","SVGScreenSharing","SVGSend","SVGUserInvite","ChatTypeBox","observer","isCreator","isBan","onBanChange","onMessageSend","useTranslate","sp","useSafePromise","inputRef","useRef","text","updateText","useState","isSending","updateSending","trimmedText","useMemo","trim","sendMessage","current","focus","console","warn","currentTarget","slice","key","DEFAULT_HEIGHT","DEFAULT_WIDTH","CellMeasurerCache","_this","params","_classCallCheck","index","_ref2","defaultHeight","defaultWidth","fixedHeight","fixedWidth","keyMapper","minHeight","minWidth","defaultKeyMapper","_createClass","rowIndex","columnIndex","_key","_key2","width","height","columnWidth","columnKey","rowHeight","_i","rowKey","ChatMessage","userUUID","messageUser","message","onMount","openCloudStorage","useEffect","status","time","Date","timestamp","fullTimeString","format","dateString","timeString","split","dateToday","finalTimeString","senderID","avatar","name","toISOString","toLocaleString","ChatMessageList","visible","messages","getUserByUUID","loadMoreRows","forceUpdate","scrollToIndex","setScrollToIndex","cellCache","uuid","clearAll","ticket","window","setTimeout","clearTimeout","useReaction","messageCount","latestMessage","prev","isFirstLoadRef","isRowLoaded","loaded","rowRenderer","parent","style","CellMeasurer","measure","registerChild","el","Observer","InfiniteLoader","onRowsRendered","AutoSizer","List","ChatMessages","isDark","useContext","DarkModeContext","isInteger","n","Number","isSafeInteger","ChatTabTitle","unreadCount","children","count","ChatPanel","totalUserCount","onClickTotalUsersCount","StopClassConfirmModal","onStop","onCancel","Modal","CloseRoomConfirmModal","hangLoading","stopLoading","onHang","Button","ExitRoomConfirmModal","onExit","signal0SVG","signal1SVG","signal2SVG","signal3SVG","getSignalIcon","uplink","downlink","NetworkStatus","networkQuality","signalIcon","signalText","delay","TopBarRightBtn","title","icon","RoomInfo","roomStatus","roomType","RoomStatus","Idle","roomStatusToI18nKey","RoomType","BigClass","RoomStoppedModal","isRemoteLogin","modalRef","setVisible","Stopped","countdown","info","okText","onOk","setInterval","clearInterval","destroy","IconMic","memo","getVolumeLevel","noise","Math","max","min","vHeight","vWidth","vBaseX","vBaseY","baseVolumeLevel","setBaseVolumeLevel","volumeLevel","setVolumeLevel","safeSetVolumeLevel","random","transform","transition","VideoAvatar","portal","small","avatarUser","isDropTarget","updateDeviceState","onDoubleClick","onDragStart","onDragEnd","isCameraCtrlDisable","isMicCtrlDisable","onDragStartImpl","ev","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","dataTransfer","setData","JSON","stringify","effectAllowed","view","classnames","undefined","camera","backgroundImage","mic","createPortal","SVGPlaceHolder","stopColor","VideoAvatarAbsent","isAvatarUserCreator","absentView","Placeholder","_Fragment","INFINITY","MAX_INTEGER","toFinite","toNumber","remainder","RaiseHand","isRaiseHand","disableHandRaising","onRaiseHandChange","RaisingHand","countLabel","addEventListener","target","listener","listen","preventEvent","stopPropagation","cancelable","preventDefault","AvatarWindow","mode","zIndex","readonly","onResize","onDragging","lastClick","disposers","forEach","dispose","handleTrackStart","isPrimary","button","node","parentElement","tagName","now","abs","main","setPointerCapture","pointerId","classList","trackingHandle","dataset","windowHandle","pageX","trackStartPageX","pageY","trackStartPageY","handleTracking","offsetX","offsetY","newX","newY","newWidth","newHeight","handleTrackEnd","releasePointerCapture","push","remove","passive","position","clamp","fixRect","input","handle","ratio","maxWidth","maxHeight","newRect","CloudRecordBtn","isRecording","convertToFP","fn","paddingHexCode","number","String","padStart","useClockTick","beginTime","updateTimestamp","unmounted","useIsUnMounted","timer","NaN","Started","startTimer","floor","requestAnimationFrame","cancelAnimationFrame","minutesAndSeconds","dayHours","Timer","Paused","timing","Thumbnail","canvasRef","loadImage","image","then","canvas","drawThumbnail","catch","error","context","getContext","dh","drawImage","dw","src","Promise","resolve","reject","Image","onload","onerror","ThumbnailWidth","ThumbnailHeight","PresetsModal","images","onClose","map","i18nKey","downloadSVG","download","filename","failText","a","document","createElement","href","toDataURL","click","err","SaveAnnotationModal","Annotation","footerText","setLoading","setCanvas","div","appendChild","firstChild","removeChild","downloadImage","useCallback","Spin","UsersPanel","ownerUUID","users","roomInfo","getDeviceState","onOffStageAll","onMuteAll","onStaging","onWhiteboard","onDeviceState","ownerAvatarURL","ownerName","filter","user","Row","getAnyVolumeLevel","setCamera","setMic","isSelf","hasLeft","isSpeak","wbOperate","UserStore","config","__publicField","observable","userUUIDs","group","editUser","editUserAction","action","unSortedUsers","shouldStopEditUser","shouldMoveOut","startIndex","joiner","makeAutoObservable","usersInfo","preferencesStore","ChatStore","SideEffectManager","insertPoint","m","runInAction","_message","workersSupported","classicWorkersSupported","transferStreamsSupported","CodecWorker","workerData","stream","workerOptions","onTaskFinished","readable","writable","streamOptions","useWebWorkers","transferStreams","scripts","signal","onstart","onprogress","onend","chunkOffset","transformer","callHandler","chunk","controller","createWebWorkerInterface","createWorkerInterface","handler","parameters","interfaceCodec","Codec","baseURL","chunkSize","getWorker","MESSAGE_EVENT_TYPE","onMessage","MESSAGE_START","initStreams","url","scriptUrl","worker","writer","data","transferrables","buffer","resolveResult","rejectResult","reader","messageId","reponseError","stack","code","close","MESSAGE_PULL","done","MESSAGE_DATA","MESSAGE_ACK_DATA","MESSAGE_CLOSE","pool","pendingRequests","indexWorker","runWorker","useCompressionStream","codecType","compressed","signed","encrypted","workerScripts","streamCopy","clearTerminateTimeout","terminateWorkerTimeout","terminateTimeout","DEFAULT_CHUNK_SIZE","Stream","Reader","offset","BlobReader","blob","BlobWriter","contentType","transformStream","headers","initStream","initSize","MAX_32_BITS","MAX_16_BITS","COMPRESSION_METHOD_DEFLATE","COMPRESSION_METHOD_STORE","COMPRESSION_METHOD_AES","LOCAL_FILE_HEADER_SIGNATURE","CENTRAL_FILE_HEADER_SIGNATURE","END_OF_CENTRAL_DIR_SIGNATURE","ZIP64_END_OF_CENTRAL_DIR_SIGNATURE","ZIP64_END_OF_CENTRAL_DIR_LOCATOR_SIGNATURE","END_OF_CENTRAL_DIR_LENGTH","ZIP64_END_OF_CENTRAL_DIR_LOCATOR_LENGTH","ZIP64_END_OF_CENTRAL_DIR_LENGTH","EXTRAFIELD_TYPE_ZIP64","EXTRAFIELD_TYPE_AES","EXTRAFIELD_TYPE_NTFS","EXTRAFIELD_TYPE_NTFS_TAG1","EXTRAFIELD_TYPE_EXTENDED_TIMESTAMP","EXTRAFIELD_TYPE_UNICODE_PATH","EXTRAFIELD_TYPE_UNICODE_COMMENT","BITFLAG_ENCRYPTED","BITFLAG_LEVEL","BITFLAG_DATA_DESCRIPTOR","BITFLAG_LANG_ENCODING_FLAG","FILE_ATTR_MSDOS_DIR_MASK","DIRECTORY_SIGNATURE","decodeText","encoding","decodeCP437","PROPERTY_NAMES","Entry","ERR_BAD_FORMAT","ERR_EOCDR_NOT_FOUND","ERR_EOCDR_ZIP64_NOT_FOUND","ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND","ERR_CENTRAL_DIRECTORY_NOT_FOUND","ERR_LOCAL_FILE_HEADER_NOT_FOUND","ERR_EXTRAFIELD_ZIP64_NOT_FOUND","ERR_ENCRYPTED","ERR_UNSUPPORTED_ENCRYPTION","ERR_UNSUPPORTED_COMPRESSION","CHARSET_UTF8","CHARSET_CP437","ZIP64_PROPERTIES","ZipReader","getConfiguration","zipReader","getChunkSize","endOfDirectoryInfo","seekSignature","endOfDirectoryView","getDataView","directoryDataLength","getUint32","directoryDataOffset","commentOffset","commentLength","getUint16","appendedDataOffset","filesLength","prependedDataLength","startOffset","endOfDirectoryLocatorArray","readUint8Array","endOfDirectoryLocatorView","getBigUint64","endOfDirectoryArray","expectedDirectoryDataOffset","originalDirectoryDataOffset","directoryArray","directoryView","filenameEncoding","getOptionValue","commentEncoding","indexFile","fileEntry","ZipEntry","readCommonHeader","languageEncodingFlag","filenameOffset","extraFieldOffset","versionMadeBy","msDosCompatible","rawFilename","endOffset","rawComment","filenameUTF8","commentUTF8","directory","getUint8","offsetFileEntry","comment","readCommonFooter","entry","extractPrependedData","extractAppendedData","entries","zipEntry","extraFieldAES","compressionMethod","bitFlag","signature","rawLastModDate","uncompressedSize","compressedSize","localDirectory","dataArray","dataView","password","zipCrypto","dataOffset","preventClose","CODEC_INFLATE","rawBitFlag","getDate","rawExtraField","extraField","rawExtraFieldView","offsetExtraField","extraFieldZip64","readExtraFieldZip64","extraFieldUnicodePath","readExtraFieldUnicode","extraFieldUnicodeComment","readExtraFieldAES","extraFieldNTFS","readExtraFieldNTFS","extraFieldExtendedTimestamp","readExtraFieldExtendedTimestamp","extraFieldView","indexValue","missingProperties","propertyName","indexMissingProperty","extraFieldUnicode","rawPropertyName","crc32","Crc32","dataViewSignature","strength","tag1Data","tagValue","attributeSize","tag1View","rawLastAccessDate","rawCreationDate","lastModDate","getDateNTFS","lastAccessDate","creationDate","extraFieldData","flags","timeProperties","timeRawProperties","indexProperty","minimumBytes","maximumLength","signatureArray","signatureView","setUint32","maximumBytes","seek","bytes","indexByte","timeRaw","array","CoursewarePreloader","pptSrc","pptInfo","pptType","taskUUID","zipData","getZipData","resourceUrlPrefix","pptFiles","resourceUrl","flatCache","cachePPTConvert","response","coursewarePreloader","WhiteboardStore","RoomPhase","whiteboardApp","room","manager","isWritable","allowDrawing","open","show","debounce","file","FileConvertStep","FlatI18n","FileResourceType","fileService","FlatServices","CloudStorageStore","globalStore","Region","_c","_b","WHITEBOARD_RATIO","fastboardAPP","windowManager","AnimationMode","ClassModeType","RoomStatusLoadingType","RoomStatusLoadingType2","ClassroomStore","windows","exclude","maxZ","grid","newValue","oldValue","cloudStorage","checkRTMCensor","errorTips","classMode","local","remote","shareScreenInfo","force","onStage","raiseHandUsers","id","state","payload","enabled","deviceState","shouldNotify","reaction","isRaisingHand","shareScreen","roomStore","fastboard","deviceStateStorage","classroomStorage","onStageUsersStorage","whiteboardStorage","userWindowsStorage","updateRaiseHandUsers","updateUserStagingState","wasJoinerOnStage","onStageUsers","isJoinerOnStage","disposer","initialUserWindows","userWindow","autorun","owner","b","ban","showWarning","limit","device","startClass","roomUUID","periodicUUID","pauseClass","stopClass","IServiceVideoChatMode","IServiceVideoChatRole","generateRTCToken","_d","noop","classRoomStore","ChatPanelImpl","cachedUsers","get","chatStore","toggleCloudStoragePanel","handRaisingJoiners","onToggleBan","toggleUsersPanel","RoomStatusStoppedModal","pushHistory","usePushHistory","RouteNameType","HomePage","CloudStoragePanel","onCoursewareInserted","history","useHistory","location","useLocation","path","URLSearchParams","search","toString","initialize","onParentDirectoryPathClick","CloudStorageContainer","CloudStorageButton","classroom","hideModal","showModal","whiteboardStore","SVGCloudOutlined","isCloudStoragePanelVisible","cloudStorageStore","ExitRoomConfirmType","StopClassButton","ExitButton","useExitRoomConfirmModal","hangClass","confirmType","setConfirmType","isReturnLoading","setReturnLoading","isStopLoading","setStopLoading","windowsBtn","WindowsSystemBtnContext","onReturnMain","onStopClass","confirm","sendWindowWillCloseEvent","removeWindowWillCloseEvent","ExitRoomConfirm","InviteModal","onCopied","GlobalStoreContext","RoomStoreContext","periodicInfo","periodicRooms","syncPeriodicRoomInfo","onCopy","navigator","clipboard","writeText","success","InviteModalImpl","FLAT_WEB_BASE_URL","periodic","userName","InviteButton","isShowInviteModal","showInviteModal","hideInviteModal","RealtimePanel","PureComponent","render","isVideoOn","isShow","videoSlot","chatSlot","isActive","SupportedFileExts","isSupportedFileExt","ext","ImageFileTypes","isSupportedImageType","onDropImage","hideLoading","getSize","getImageSize","task","UploadTask","files","listFiles","cloudFile","v4uuid","ApplianceNames","innerWidth","innerHeight","scale","PRESETS","createCloudFile","uuidv4","WINDOW_RATIO","DEFAULT_WIDTH_P","MIN_WIDTH_P","UserWindows","boundingRect","setBoundingRect","hovering","setHovering","ResizeObserver","observe","disconnect","baseRect","extraY","extraX","userWindowsGrid","userWindows","keys","userWindowsLength","paddings","rows","cols","windowWidth","onDrop","getData","rx","ry","parse","windowHeight","createAvatarWindow","isGrid","paddingLeft","paddingRight","paddingTop","paddingBottom","UserAvatarWindow","userWindowsMode","isDraggingAvatar","DEFAULT_WINDOW","z","realWindow","isUnMounted","tempWindow","setTempWindow","updateAvatarWindow","toggleUserWindowsMode","setDroppingUserUUID","elementFromPoint","userUuid","deleteAvatarWindow","UserWindowPortal","element","setPortal","Whiteboard","phase","whiteboard","saveAnnotationVisible","showSaveAnnotation","saveAnnotationImages","setSaveAnnotationImages","presetsVisible","showPresets","page","setPage","maxPage","setMaxPage","Infinity","showPage","setShowPage","isReconnecting","Reconnecting","handRaisingCount","events","on","stopListenPage","stopListenMaxPage","stopListenUserScroll","isMounted","setTheme","getSaveAnnotationImages","bindWhiteboard","insertPresetImage","fileURL","getInstance","requestService","insert","fileName","onDragOver","dropEffect","convertToPointInWorld","pasteHandler","clipboardData","centerX","centerY","extname","getFileExt","renamed","File","lastModified","removeEventListener","isHandRaisingPanelVisible","querySelector","onToggleHandRaisingPanel","capture","currentUser","onToggleHandRaising","renderScrollPage","toFixed","AvatarCanvas","rtcAvatar","canvasEl","setCanvasEl","setElement","enableCamera","enableMic","Boolean","RTCAvatar","getPortal","dragSVG","ShareScreenTip","classroomStore","containerEl","createShareScreenTipPortalWindow","stopShareScreen","toggleShareScreen","ReactDOM","ShareScreen","rtc","onBrowserNotPermission","isAgoraRTCPermissionError","browserNotPermission","off","classNameList","isRemoteScreenSharing","isElectron","isScreenSharing","useClassroomStore","setClassroomStore","isUnmounted","flatServices","videoChat","textChat","recording","withClassroomStore","Component","useParams","isReady","Connecting","Disconnecting","LoadingPage","uint8ArrayToImageURL","URL","createObjectURL","Blob","ScreenList","screenInfo","activeInfo","setActiveInfo","activeKey","selectShareScreenInfo","cancelSelected","screenId","ScreenItem","handleClick","ShareScreenPickerModel","handleOk","useLayoutEffect","refreshShareScreenInfo","closeModal","toggleShareScreenPicker","isSelected","selectedScreenInfo","padding","ConfirmButton","ShareScreenPicker","shareScreenPickerVisible","confirmLoading","setConfirmLoading","ExtraPadding","runtime","RuntimeContext","isMac","UsersButton","useComputed","offlineJoiners","speakingJoiners","otherJoiners","sort","localeCompare","uid","rtcUID","isRequestingCamera","content","toggleRequestingDevice","replyRequestingDevice","isRequestingMic","SVGUserGroup","isUsersPanelVisible","muteAll","offStageAll","authorizeWhiteboard"],"mappings":"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"}