var Lt=Object.defineProperty;var Ut=(t,e,a)=>e in t?Lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var $=(t,e,a)=>(Ut(t,typeof e!="symbol"?e+"":e,a),a);import{k as i,a5 as ht,q as f,x as pe,l as Q,a4 as ee,av as ie,n as Ft,t as K,a8 as oe,a7 as vt,aI as Bt,m as me,al as Ot,aL as Ht,df as Wt,a1 as ot,s as At,_ as Me,dg as jt,S as yt,dh as Ce,br as je,cK as Vt,di as lt,c4 as Ie,bs as ye,c5 as zt,r as Xt,c9 as Yt,c6 as ut,b8 as De,aZ as gt,bb as mt,b3 as Kt,A as Fe,b0 as pt,bc as Gt,dj as qt,aw as Zt,aB as Jt,aE as Qt,bv as ct,b4 as ea,bm as ta,cB as aa}from"./index.43c4ffc0.js";import{W as ra,T as na}from"./constants.dd61e0d4.js";import{u as sa,e as ia}from"./routes.73fc4946.js";import{u as oa}from"./use-login-check.e01c4832.js";import{W as la}from"./index.10dbff5d.js";var be=i.exports.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0});function Ve(t,e,a){return(t-e)/(a-e)}function ze(t,e,a,r){var n=Ve(e,a,r),s={};switch(t){case"rtl":s.right="".concat(n*100,"%"),s.transform="translateX(50%)";break;case"btt":s.bottom="".concat(n*100,"%"),s.transform="translateY(50%)";break;case"ttb":s.top="".concat(n*100,"%"),s.transform="translateY(-50%)";break;default:s.left="".concat(n*100,"%"),s.transform="translateX(-50%)";break}return s}function Re(t,e){return Array.isArray(t)?t[e]:t}var ua=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange"],ca=i.exports.forwardRef(function(t,e){var a,r,n=t.prefixCls,s=t.value,o=t.valueIndex,c=t.onStartMove,k=t.style,b=t.render,m=t.dragging,x=t.onOffsetChange,y=ht(t,ua),d=i.exports.useContext(be),h=d.min,g=d.max,v=d.direction,p=d.disabled,u=d.range,w=d.tabIndex,N=d.ariaLabelForHandle,T=d.ariaLabelledByForHandle,B=d.ariaValueTextFormatterForHandle,S="".concat(n,"-handle"),_=function(A){p||c(A,o)},E=function(A){if(!p){var I=null;switch(A.which||A.keyCode){case ie.LEFT:I=v==="ltr"||v==="btt"?-1:1;break;case ie.RIGHT:I=v==="ltr"||v==="btt"?1:-1;break;case ie.UP:I=v!=="ttb"?1:-1;break;case ie.DOWN:I=v!=="ttb"?-1:1;break;case ie.HOME:I="min";break;case ie.END:I="max";break;case ie.PAGE_UP:I=2;break;case ie.PAGE_DOWN:I=-2;break}I!==null&&(A.preventDefault(),x(I,o))}},C=ze(v,s,h,g),L=f("div",{ref:e,className:pe(S,(a={},Q(a,"".concat(S,"-").concat(o+1),u),Q(a,"".concat(S,"-dragging"),m),a)),style:ee(ee({},C),k),onMouseDown:_,onTouchStart:_,onKeyDown:E,tabIndex:p?null:Re(w,o),role:"slider","aria-valuemin":h,"aria-valuemax":g,"aria-valuenow":s,"aria-disabled":p,"aria-label":Re(N,o),"aria-labelledby":Re(T,o),"aria-valuetext":(r=Re(B,o))===null||r===void 0?void 0:r(s),...y});return b&&(L=b(L,{index:o,prefixCls:n,value:s,dragging:m})),L}),da=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","draggingIndex"],fa=i.exports.forwardRef(function(t,e){var a=t.prefixCls,r=t.style,n=t.onStartMove,s=t.onOffsetChange,o=t.values,c=t.handleRender,k=t.draggingIndex,b=ht(t,da),m=i.exports.useRef({});return i.exports.useImperativeHandle(e,function(){return{focus:function(y){var d;(d=m.current[y])===null||d===void 0||d.focus()}}}),f(Ft,{children:o.map(function(x,y){return f(ca,{ref:function(h){h?m.current[y]=h:delete m.current[y]},dragging:k===y,prefixCls:a,style:Re(r,y),value:x,valueIndex:y,onStartMove:n,onOffsetChange:s,render:c,...b},y)})})});function dt(t){var e="touches"in t?t.touches[0]:t;return{pageX:e.pageX,pageY:e.pageY}}function ha(t,e,a,r,n,s,o,c,k){var b=i.exports.useState(null),m=K(b,2),x=m[0],y=m[1],d=i.exports.useState(-1),h=K(d,2),g=h[0],v=h[1],p=i.exports.useState(a),u=K(p,2),w=u[0],N=u[1],T=i.exports.useState(a),B=K(T,2),S=B[0],_=B[1],E=i.exports.useRef(null),C=i.exports.useRef(null);i.exports.useEffect(function(){g===-1&&N(a)},[a,g]),i.exports.useEffect(function(){return function(){document.removeEventListener("mousemove",E.current),document.removeEventListener("mouseup",C.current),document.removeEventListener("touchmove",E.current),document.removeEventListener("touchend",C.current)}},[]);var L=function(M,U){w.some(function(j,q){return j!==M[q]})&&(U!==void 0&&y(U),N(M),o(M))},O=function(M,U){if(M===-1){var j=S[0],q=S[S.length-1],le=r-j,te=n-q,V=U*(n-r);V=Math.max(V,le),V=Math.min(V,te);var G=s(j+V);V=G-j;var ae=S.map(function(Pe){return Pe+V});L(ae)}else{var Z=(n-r)*U,X=oe(w);X[M]=S[M];var ue=k(X,Z,M,"dist");L(ue.values,ue.value)}},A=i.exports.useRef(O);A.current=O;var I=function(M,U){M.stopPropagation();var j=a[U];v(U),y(j),_(a);var q=dt(M),le=q.pageX,te=q.pageY,V=function(Z){Z.preventDefault();var X=dt(Z),ue=X.pageX,Pe=X.pageY,Se=ue-le,_e=Pe-te,re=t.current.getBoundingClientRect(),ce=re.width,de=re.height,H;switch(e){case"btt":H=-_e/de;break;case"ttb":H=_e/de;break;case"rtl":H=-Se/ce;break;default:H=Se/ce}A.current(U,H)},G=function ae(Z){Z.preventDefault(),document.removeEventListener("mouseup",ae),document.removeEventListener("mousemove",V),document.removeEventListener("touchend",ae),document.removeEventListener("touchmove",V),E.current=null,C.current=null,v(-1),c()};document.addEventListener("mouseup",G),document.addEventListener("mousemove",V),document.addEventListener("touchend",G),document.addEventListener("touchmove",V),E.current=V,C.current=G},z=i.exports.useMemo(function(){var Y=oe(a).sort(function(U,j){return U-j}),M=oe(w).sort(function(U,j){return U-j});return Y.every(function(U,j){return U===M[j]})?w:a},[a,w]);return[g,x,z,I]}function va(t){var e=t.prefixCls,a=t.style,r=t.start,n=t.end,s=t.index,o=t.onStartMove,c=i.exports.useContext(be),k=c.direction,b=c.min,m=c.max,x=c.disabled,y=c.range,d="".concat(e,"-track"),h=Ve(r,b,m),g=Ve(n,b,m),v=function(w){!x&&o&&o(w,-1)},p={};switch(k){case"rtl":p.right="".concat(h*100,"%"),p.width="".concat(g*100-h*100,"%");break;case"btt":p.bottom="".concat(h*100,"%"),p.height="".concat(g*100-h*100,"%");break;case"ttb":p.top="".concat(h*100,"%"),p.height="".concat(g*100-h*100,"%");break;default:p.left="".concat(h*100,"%"),p.width="".concat(g*100-h*100,"%")}return f("div",{className:pe(d,y&&"".concat(d,"-").concat(s+1)),style:ee(ee({},p),a),onMouseDown:v,onTouchStart:v})}function ya(t){var e=t.prefixCls,a=t.style,r=t.values,n=t.startPoint,s=t.onStartMove,o=i.exports.useContext(be),c=o.included,k=o.range,b=o.min,m=i.exports.useMemo(function(){if(!k){if(r.length===0)return[];var x=n!=null?n:b,y=r[0];return[{start:Math.min(x,y),end:Math.max(x,y)}]}for(var d=[],h=0;h<r.length-1;h+=1)d.push({start:r[h],end:r[h+1]});return d},[r,k,n,b]);return c?m.map(function(x,y){var d=x.start,h=x.end;return f(va,{index:y,prefixCls:e,style:Re(a,y),start:d,end:h,onStartMove:s},y)}):null}function ga(t){var e=t.prefixCls,a=t.style,r=t.children,n=t.value,s=t.onClick,o=i.exports.useContext(be),c=o.min,k=o.max,b=o.direction,m=o.includedStart,x=o.includedEnd,y=o.included,d="".concat(e,"-text"),h=ze(b,n,c,k);return f("span",{className:pe(d,Q({},"".concat(d,"-active"),y&&m<=n&&n<=x)),style:ee(ee({},h),a),onMouseDown:function(v){v.stopPropagation()},onClick:function(){s(n)},children:r})}function ma(t){var e=t.prefixCls,a=t.marks,r=t.onClick,n="".concat(e,"-mark");return a.length?f("div",{className:n,children:a.map(function(s){var o=s.value,c=s.style,k=s.label;return f(ga,{prefixCls:n,style:c,value:o,onClick:r,children:k},o)})}):null}function pa(t){var e=t.prefixCls,a=t.value,r=t.style,n=t.activeStyle,s=i.exports.useContext(be),o=s.min,c=s.max,k=s.direction,b=s.included,m=s.includedStart,x=s.includedEnd,y="".concat(e,"-dot"),d=b&&m<=a&&a<=x,h=ee(ee({},ze(k,a,o,c)),r);return d&&(h=ee(ee({},h),n)),f("span",{className:pe(y,Q({},"".concat(y,"-active"),d)),style:h})}function ba(t){var e=t.prefixCls,a=t.marks,r=t.dots,n=t.style,s=t.activeStyle,o=i.exports.useContext(be),c=o.min,k=o.max,b=o.step,m=i.exports.useMemo(function(){var x=new Set;if(a.forEach(function(d){x.add(d.value)}),r)for(var y=c;y<=k;)x.add(y),y+=b;return Array.from(x)},[c,k,b,r,a]);return f("div",{className:"".concat(e,"-step"),children:m.map(function(x){return f(pa,{prefixCls:e,value:x,style:n,activeStyle:s},x)})})}function Pa(t,e,a,r,n,s){var o=i.exports.useCallback(function(d){var h=isFinite(d)?d:t;return h=Math.min(e,d),h=Math.max(t,h),h},[t,e]),c=i.exports.useCallback(function(d){if(a!==null){var h=t+Math.round((o(d)-t)/a)*a,g=function(w){return(String(w).split(".")[1]||"").length},v=Math.max(g(a),g(e),g(t)),p=Number(h.toFixed(v));return t<=p&&p<=e?p:null}return null},[a,t,e,o]),k=i.exports.useCallback(function(d){var h=o(d),g=r.map(function(u){return u.value});a!==null&&g.push(c(d)),g.push(t,e);var v=g[0],p=e-t;return g.forEach(function(u){var w=Math.abs(h-u);w<=p&&(v=u,p=w)}),v},[t,e,r,a,o,c]),b=function d(h,g,v){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof g=="number"){var u,w=h[v],N=w+g,T=[];r.forEach(function(C){T.push(C.value)}),T.push(t,e),T.push(c(w));var B=g>0?1:-1;p==="unit"?T.push(c(w+B*a)):T.push(c(N)),T=T.filter(function(C){return C!==null}).filter(function(C){return g<0?C<=w:C>=w}),p==="unit"&&(T=T.filter(function(C){return C!==w}));var S=p==="unit"?w:N;u=T[0];var _=Math.abs(u-S);if(T.forEach(function(C){var L=Math.abs(C-S);L<_&&(u=C,_=L)}),u===void 0)return g<0?t:e;if(p==="dist")return u;if(Math.abs(g)>1){var E=oe(h);return E[v]=u,d(E,g-B,v,p)}return u}else{if(g==="min")return t;if(g==="max")return e}},m=function(h,g,v){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",u=h[v],w=b(h,g,v,p);return{value:w,changed:w!==u}},x=function(h){return s===null&&h===0||typeof s=="number"&&h<s},y=function(h,g,v){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",u=h.map(k),w=u[v],N=b(u,g,v,p);if(u[v]=N,n===!1){var T=s||0;v>0&&u[v-1]!==w&&(u[v]=Math.max(u[v],u[v-1]+T)),v<u.length-1&&u[v+1]!==w&&(u[v]=Math.min(u[v],u[v+1]-T))}else if(typeof s=="number"||s===null){for(var B=v+1;B<u.length;B+=1)for(var S=!0;x(u[B]-u[B-1])&&S;){var _=m(u,1,B);u[B]=_.value,S=_.changed}for(var E=v;E>0;E-=1)for(var C=!0;x(u[E]-u[E-1])&&C;){var L=m(u,-1,E-1);u[E-1]=L.value,C=L.changed}for(var O=u.length-1;O>0;O-=1)for(var A=!0;x(u[O]-u[O-1])&&A;){var I=m(u,-1,O-1);u[O-1]=I.value,A=I.changed}for(var z=0;z<u.length-1;z+=1)for(var Y=!0;x(u[z+1]-u[z])&&Y;){var M=m(u,1,z+1);u[z+1]=M.value,Y=M.changed}}return{value:u[v],values:u}};return[k,y]}var ka=i.exports.forwardRef(function(t,e){var a,r=t.prefixCls,n=r===void 0?"rc-slider":r,s=t.className,o=t.style,c=t.disabled,k=c===void 0?!1:c,b=t.autoFocus,m=t.onFocus,x=t.onBlur,y=t.min,d=y===void 0?0:y,h=t.max,g=h===void 0?100:h,v=t.step,p=v===void 0?1:v,u=t.value,w=t.defaultValue,N=t.range,T=t.count,B=t.onChange,S=t.onBeforeChange,_=t.onAfterChange,E=t.allowCross,C=E===void 0?!0:E,L=t.pushable,O=L===void 0?!1:L,A=t.draggableTrack,I=t.reverse,z=t.vertical,Y=t.included,M=Y===void 0?!0:Y,U=t.startPoint,j=t.trackStyle,q=t.handleStyle,le=t.railStyle,te=t.dotStyle,V=t.activeDotStyle,G=t.marks,ae=t.dots,Z=t.handleRender,X=t.tabIndex,ue=X===void 0?0:X,Pe=t.ariaLabelForHandle,Se=t.ariaLabelledByForHandle,_e=t.ariaValueTextFormatterForHandle,re=i.exports.useRef(),ce=i.exports.useRef(),de=i.exports.useMemo(function(){return z?I?"ttb":"btt":I?"rtl":"ltr"},[I,z]),H=i.exports.useMemo(function(){return isFinite(d)?d:0},[d]),ke=i.exports.useMemo(function(){return isFinite(g)?g:100},[g]),fe=i.exports.useMemo(function(){return p!==null&&p<=0?1:p},[p]),Pt=i.exports.useMemo(function(){return O===!0?fe:O>=0?O:!1},[O,fe]),$e=i.exports.useMemo(function(){var F=Object.keys(G||{});return F.map(function(R){var P=G[R],W={value:Number(R)};return P&&vt(P)==="object"&&!i.exports.isValidElement(P)&&("label"in P||"style"in P)?(W.style=P.style,W.label=P.label):W.label=P,W}).filter(function(R){var P=R.label;return P||typeof P=="number"}).sort(function(R,P){return R.value-P.value})},[G]),kt=Pa(H,ke,fe,$e,C,Pt),Ye=K(kt,2),Ne=Ye[0],Ke=Ye[1],xt=Bt(w,{value:u}),Ge=K(xt,2),ne=Ge[0],wt=Ge[1],J=i.exports.useMemo(function(){var F=ne==null?[]:Array.isArray(ne)?ne:[ne],R=K(F,1),P=R[0],W=P===void 0?H:P,D=ne===null?[]:[W];if(N){if(D=oe(F),T||ne===void 0){var we=T>=0?T+1:2;for(D=D.slice(0,we);D.length<we;){var ve;D.push((ve=D[D.length-1])!==null&&ve!==void 0?ve:H)}}D.sort(function(se,Ee){return se-Ee})}return D.forEach(function(se,Ee){D[Ee]=Ne(se)}),D},[ne,N,H,T,Ne]),Le=i.exports.useRef(J);Le.current=J;var he=function(R){return N?R:R[0]},Be=function(R){var P=oe(R).sort(function(W,D){return W-D});B&&!Ot(P,Le.current)&&B(he(P)),wt(P)},qe=function(R){if(!k){var P=0,W=ke-H;J.forEach(function(we,ve){var se=Math.abs(R-we);se<=W&&(W=se,P=ve)});var D=oe(J);D[P]=R,N&&!J.length&&T===void 0&&D.push(R),S==null||S(he(D)),Be(D),_==null||_(he(D))}},Ct=function(R){R.preventDefault();var P=ce.current.getBoundingClientRect(),W=P.width,D=P.height,we=P.left,ve=P.top,se=P.bottom,Ee=P.right,st=R.clientX,it=R.clientY,Te;switch(de){case"btt":Te=(se-it)/D;break;case"ttb":Te=(it-ve)/D;break;case"rtl":Te=(Ee-st)/W;break;default:Te=(st-we)/W}var Nt=H+Te*(ke-H);qe(Ne(Nt))},Rt=i.exports.useState(null),Ze=K(Rt,2),Oe=Ze[0],Je=Ze[1],St=function(R,P){if(!k){var W=Ke(J,R,P);S==null||S(he(J)),Be(W.values),_==null||_(he(W.values)),Je(W.value)}};i.exports.useEffect(function(){if(Oe!==null){var F=J.indexOf(Oe);F>=0&&re.current.focus(F)}Je(null)},[Oe]);var _t=i.exports.useMemo(function(){return A&&fe===null?!1:A},[A,fe]),Et=function(){_==null||_(he(Le.current))},Tt=ha(ce,de,J,H,ke,Ne,Be,Et,Ke),Ue=K(Tt,4),Qe=Ue[0],Mt=Ue[1],He=Ue[2],It=Ue[3],et=function(R,P){It(R,P),S==null||S(he(Le.current))},tt=Qe!==-1;i.exports.useEffect(function(){if(!tt){var F=J.lastIndexOf(Mt);re.current.focus(F)}},[tt]);var xe=i.exports.useMemo(function(){return oe(He).sort(function(F,R){return F-R})},[He]),Dt=i.exports.useMemo(function(){return N?[xe[0],xe[xe.length-1]]:[H,xe[0]]},[xe,N,H]),at=K(Dt,2),rt=at[0],nt=at[1];i.exports.useImperativeHandle(e,function(){return{focus:function(){re.current.focus(0)},blur:function(){var R=document,P=R.activeElement;ce.current.contains(P)&&(P==null||P.blur())}}}),i.exports.useEffect(function(){b&&re.current.focus(0)},[]);var $t=i.exports.useMemo(function(){return{min:H,max:ke,direction:de,disabled:k,step:fe,included:M,includedStart:rt,includedEnd:nt,range:N,tabIndex:ue,ariaLabelForHandle:Pe,ariaLabelledByForHandle:Se,ariaValueTextFormatterForHandle:_e}},[H,ke,de,k,fe,M,rt,nt,N,ue,Pe,Se,_e]);return f(be.Provider,{value:$t,children:me("div",{ref:ce,className:pe(n,s,(a={},Q(a,"".concat(n,"-disabled"),k),Q(a,"".concat(n,"-vertical"),z),Q(a,"".concat(n,"-horizontal"),!z),Q(a,"".concat(n,"-with-marks"),$e.length),a)),style:o,onMouseDown:Ct,children:[f("div",{className:"".concat(n,"-rail"),style:le}),f(ya,{prefixCls:n,style:j,values:xe,startPoint:U,onStartMove:_t?et:null}),f(ba,{prefixCls:n,marks:$e,dots:ae,style:te,activeStyle:V}),f(fa,{ref:re,prefixCls:n,style:q,values:He,draggingIndex:Qe,onStartMove:et,onOffsetChange:St,onFocus:m,onBlur:x,handleRender:Z}),f(ma,{prefixCls:n,marks:$e,onClick:qe})]})})}),xa=i.exports.forwardRef(function(t,e){var a=t.open,r=i.exports.useRef(null),n=i.exports.useRef(null);function s(){ot.cancel(n.current),n.current=null}function o(){n.current=ot(function(){var c;(c=r.current)===null||c===void 0||c.forcePopupAlign(),n.current=null})}return i.exports.useEffect(function(){return a?o():s(),s},[a,t.title]),f(Ht,{ref:Wt(r,e),...t})});const wa=xa;var Ca=globalThis&&globalThis.__rest||function(t,e){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(a[r[n]]=t[r[n]]);return a},Ra=i.exports.forwardRef(function(t,e){var a=i.exports.useContext(At),r=a.getPrefixCls,n=a.direction,s=a.getPopupContainer,o=i.exports.useState({}),c=K(o,2),k=c[0],b=c[1],m=function(_,E){b(function(C){return Me(Me({},C),Q({},_,E))})},x=function(_,E){return _||(E?n==="rtl"?"left":"right":"top")},y=t.prefixCls,d=t.range,h=t.className,g=Ca(t,["prefixCls","range","className"]),v=r("slider",y),p=pe(h,Q({},"".concat(v,"-rtl"),n==="rtl"));n==="rtl"&&!g.vertical&&(g.reverse=!g.reverse);var u=i.exports.useMemo(function(){return d?vt(d)==="object"?[!0,d.draggableTrack]:[!0,!1]:[!1]},[d]),w=K(u,2),N=w[0],T=w[1],B=function(_,E){var C,L=E.index,O=E.dragging,A=r(),I=t.tooltip,z=I===void 0?{}:I,Y=t.vertical,M=Me({formatter:(C=t.tipFormatter)!==null&&C!==void 0?C:function(X){return typeof X=="number"?X.toString():""},open:t.tooltipVisible,placement:t.tooltipPlacement,getPopupContainer:t.getTooltipPopupContainer},z),U=M.open,j=M.placement,q=M.getPopupContainer,le=M.prefixCls,te=M.formatter,V=te?k[L]||O:!1,G=U||U===void 0&&V,ae=Me(Me({},_.props),{onMouseEnter:function(){return m(L,!0)},onMouseLeave:function(){return m(L,!1)}}),Z=r("tooltip",le);return f(wa,{prefixCls:Z,title:te?te(E.value):"",open:G,placement:x(j,Y),transitionName:"".concat(A,"-zoom-down"),overlayClassName:"".concat(v,"-tooltip"),getPopupContainer:q||s,children:i.exports.cloneElement(_,ae)},L)};return f(ka,{...g,step:g.step,range:N,draggableTrack:T,className:p,ref:e,prefixCls:v,handleRender:B})});const Sa=Ra,_a=({active:t,className:e="",...a})=>f("svg",{className:`${e} flat-icon ${t?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...a,children:f("path",{className:"flat-icon-fill-color",clipRule:"evenodd",d:"M10 5H6v14h4V5Zm8 0h-4v14h4V5Z",fill:"#5D6066",fillRule:"evenodd"})}),Ea=({active:t,className:e="",...a})=>f("svg",{className:`${e} flat-icon ${t?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...a,children:f("path",{className:"flat-icon-fill-color",clipRule:"evenodd",d:"M6.5 5v14l11-7-11-7Z",fill:"#5D6066",fillRule:"evenodd"})}),Ta=({active:t,className:e="",...a})=>me("svg",{className:`${e} flat-icon ${t?"is-active":""}`,fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...a,children:[f("circle",{className:"flat-icon-fill-color",cx:"19",cy:"8",fill:"#5D6066",r:"1"}),f("circle",{className:"flat-icon-fill-color",cx:"19",cy:"12",fill:"#5D6066",r:"1"}),f("circle",{className:"flat-icon-fill-color",cx:"19",cy:"16",fill:"#5D6066",r:"1"}),f("path",{className:"flat-icon-stroke-color",d:"M4 8H16",stroke:"#5D6066",strokeWidth:"1.25"}),f("path",{className:"flat-icon-stroke-color",d:"M4 12H16",stroke:"#5D6066",strokeWidth:"1.25"}),f("path",{className:"flat-icon-stroke-color",d:"M4 16H16",stroke:"#5D6066",strokeWidth:"1.25"})]});var l=(t=>(t.Ready="Ready",t.Pause="Pause",t.Buffering="Buffering",t.Playing="Playing",t.Ended="Ended",t))(l||{});function Ma(t){return Math.floor(t*1e3)/1e3}function bt(t,e){return Math.floor(t*1e3)===Math.floor(e*1e3)}class Xe extends jt{constructor(e){super(),this._offset=0,this._visible=!0,this.ignoreSetStatus=!1,this._sideEffect=new yt,this._status=l.Ready,this._currentTime=0,this._duration=0,this._playbackRate=1,this._initStatus=ge.Idle,this.name=e==null?void 0:e.name,this.loadInit=this.init()}get offset(){return this._offset}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.emit("visibilitychange"))}get isReady(){return this._initStatus===ge.Ready}get isPlaying(){return this._status===l.Playing||this._status===l.Buffering}get status(){return this._status}set status(e){!this.ignoreSetStatus&&this._status!==e&&(this._status=e,this.emit("status"))}get currentTime(){return this._currentTime}set currentTime(e){e=Math.floor(e),this._currentTime!==e&&(this._currentTime=e,this.emit("timeupdate"))}get duration(){return this._duration}set duration(e){e=Math.floor(e),this._duration!==e&&(this._duration=e,this.emit("durationchange"))}get playbackRate(){return this._playbackRate}set playbackRate(e){const a=Ma(e);bt(this._playbackRate,a)||(this.setPlaybackRateImpl(a),this._playbackRate=a,this.emit("ratechange"))}setPlaybackRate(e){this.playbackRate=e}async play(){if(this.isReady||(this.status=l.Buffering,await this.loadInit),this._status!==l.Playing)try{await this.playImpl()}catch(e){if(this._status!==l.Ready&&this._status!==l.Pause)throw e}}async pause(){this.isReady||await this.loadInit,this._status!==l.Pause&&this._status!==l.Ended&&(this.status=l.Pause,await this.pauseImpl())}async stop(){this.isReady||await this.loadInit,this._status!==l.Ended&&(this.status=l.Ended,this.ignoreSetStatus=!0,await this.readyImpl(!0),await this.stopImpl(),this.ignoreSetStatus=!1)}async seek(e){if(this.isReady||await this.loadInit,e=Math.floor(e),e===this._currentTime)return;if(e>=this.duration){await this.stop();return}const a=this._status;switch(await this.seekImpl(e),a){case l.Ready:case l.Ended:{await this.ready();break}case l.Pause:{await this.pause();break}case l.Buffering:case l.Playing:{await this.play();break}}}async ready(e){this._status!==l.Ready&&(e!==void 0&&(this.ignoreSetStatus=e),this.status=l.Ready,await this.readyImpl(e),e!==void 0&&(this.ignoreSetStatus=!1))}destroy(){this._sideEffect.flushAll()}initImpl(){return Promise.resolve()}async init(){switch(this._initStatus){case ge.Ready:return;case ge.Initializing:return new Promise(e=>this.once("ready",e));default:this.ignoreSetStatus=!0,this._initStatus=ge.Initializing,await new Promise(e=>setTimeout(e)),await this.initImpl(),this._initStatus=ge.Ready,this.emit("ready"),this.ignoreSetStatus=!1}}}var ge=(t=>(t[t.Idle=0]="Idle",t[t.Initializing=1]="Initializing",t[t.Ready=2]="Ready",t))(ge||{});class Ia extends Xe{constructor(e){super({name:e.name||`{${e.rowPlayer.name||"unknown"}-${e.colPlayer.name||"unknown"}}`}),this.rowPlayer=e.rowPlayer,this.colPlayer=e.colPlayer,this.longerPlayer=this.rowPlayer.duration>=this.colPlayer.duration?this.rowPlayer:this.colPlayer,this.duration=this.longerPlayer.duration,this.playbackRate=this.longerPlayer.playbackRate;const a=(r,n)=>{this._sideEffect.add(()=>{const s=()=>{n(this.rowPlayer,this.colPlayer)};return this.rowPlayer.on(r,s),()=>{this.rowPlayer.off(r,s)}}),this._sideEffect.add(()=>{const s=()=>{n(this.colPlayer,this.rowPlayer)};return this.colPlayer.on(r,s),()=>{this.colPlayer.off(r,s)}})};a("status",(r,n)=>{var s;this.ignoreSetStatus||(this.syncSubPlayer(r,n),this.updateStatus(r,n),this.rowPlayer.status===l.Playing&&this.colPlayer.status===l.Playing?this.startFrameDropCheck():(s=this.stopFrameDropCheck)==null||s.call(this))}),a("timeupdate",r=>{this.longerPlayer===r&&r.status!==l.Ended&&(this.currentTime=r.currentTime)}),a("durationchange",(r,n)=>{r.duration>=this.longerPlayer.duration?r!==this.longerPlayer&&(this.longerPlayer=r):this.longerPlayer=n,this.duration=this.longerPlayer.duration}),a("ratechange",r=>{bt(r.playbackRate,this.playbackRate)||(this.playbackRate=r.playbackRate)})}destroy(){var e;super.destroy(),(e=this.stopFrameDropCheck)==null||e.call(this),this.rowPlayer.destroy(),this.colPlayer.destroy()}get isReady(){return this.rowPlayer.isReady&&this.colPlayer.isReady}async ready(e){await this.readyImpl(e)}async play(){this.status!==l.Ended&&await this.playImpl()}async pause(){await this.pauseImpl()}async stop(){await this.stopImpl()}async seek(e){await this.seekImpl(e)}async readyImpl(e){await this.invokeSubPlayers(a=>a.ready(e))}async playImpl(){await this.invokeSubPlayers(e=>e.play())}async pauseImpl(){await this.invokeSubPlayers(e=>e.pause())}async stopImpl(){await this.invokeSubPlayers(e=>e.stop())}async seekImpl(e){await Promise.all([this.rowPlayer.seek(e),this.colPlayer.seek(e)])}setPlaybackRateImpl(e){this.rowPlayer.setPlaybackRate(e),this.colPlayer.setPlaybackRate(e)}updateStatus(e,a){switch(e.status){case l.Ready:{switch(a.status){case l.Ready:case l.Ended:{this.status=l.Ready;break}}break}case l.Pause:{a.status!==l.Playing&&(this.status=l.Pause);break}case l.Buffering:{a.status!==l.Pause&&(this.status=l.Buffering);break}case l.Playing:{switch(a.status){case l.Playing:case l.Ended:{this.status=l.Playing;break}}break}case l.Ended:{this.status=a.status;break}}}async syncSubPlayer(e,a){switch(e.status){case l.Pause:{a.isPlaying&&await a.pause();break}case l.Buffering:{a.status===l.Playing&&await a.ready();break}case l.Playing:{a.status===l.Buffering?await e.ready():a.status===l.Ready&&(a.duration<=0||e.currentTime<a.duration)&&await a.play();break}}}startFrameDropCheck(){if(this.stopFrameDropCheck)return;let e=0;const a=setInterval(async()=>{if(this.status!==l.Playing)e=0;else{const r=this.rowPlayer.currentTime-this.colPlayer.currentTime;e=Math.abs(r)>1e3?e+1:0,e>=2&&(r<0?await this.rowPlayer.seek(this.colPlayer.currentTime):await this.colPlayer.seek(this.rowPlayer.currentTime),e=0)}},2e3);this.stopFrameDropCheck=()=>{this.stopFrameDropCheck=void 0,clearInterval(a)}}async invokeSubPlayers(e){await Promise.all([this.rowPlayer,this.colPlayer].filter(a=>a.status!==l.Ended).map(e))}}function Da(t,e,a,r){return t.addEventListener(e,a,r),()=>t.removeEventListener(e,a,r)}const $a=Da;class Na extends Xe{constructor(e){super(e),this.video=e.video,this.video.controls=!1;const a=(s,o)=>{this._sideEffect.push($a(this.video,s,o))};["waiting","canplay","pause","suspend","playing","play","seeking","seeked","stalled","canplaythrough"].forEach(s=>{a(s,o=>{if(this.status===l.Ended)return;const c=o.type;this.video.paused||c==="seeking"?this.status!==l.Pause&&this.status!==l.Ready&&(c==="pause"?this.status=l.Ready:this.status=l.Buffering):this.status=l.Playing})}),a("error",()=>{this.status===l.Playing&&this.video.paused&&(this.status=l.Buffering)}),a("ended",()=>{this.status=l.Ended});const r=()=>{this.currentTime=this.video.currentTime*1e3};r(),a("timeupdate",r);const n=()=>{this.duration=this.video.duration*1e3};n(),a("durationchange",n)}async readyImpl(){this.video.pause()}async playImpl(){try{await this.video.play()}catch{}}async pauseImpl(){this.video.pause()}async stopImpl(){this.video.currentTime=this.duration/1e3-.5}async seekImpl(e){this.video.currentTime=e/1e3}setPlaybackRateImpl(e){this.video.playbackRate=e}}class La extends Xe{constructor(e){super(e),this.player=e.player,this._sideEffect.add(()=>{const a=r=>{if(this.status!==l.Ended)switch(r){case Ce.Ended:case Ce.Stopped:{this.status=l.Ended;break}case Ce.Playing:{this.status=l.Playing;break}default:{this.status!==l.Pause&&this.status!==l.Ready&&(this.status=l.Buffering);break}}};return this.player.callbacks.on("onPhaseChanged",a),()=>this.player.callbacks.off("onPhaseChanged",a)}),this.duration=this.player.timeDuration||0,this.playbackRate=this.player.playbackSpeed,this._sideEffect.add(()=>{const a=()=>{this.duration=this.player.timeDuration||0,this.playbackRate=this.player.playbackSpeed};return this.player.callbacks.on("onLoadFirstFrame",a),()=>this.player.callbacks.off("onLoadFirstFrame",a)}),this._sideEffect.add(()=>{const a=r=>{this.currentTime=r};return this.player.callbacks.on("onProgressTimeChanged",a),()=>this.player.callbacks.off("onProgressTimeChanged",a)})}async initImpl(){const e=new Promise(a=>{const{player:r}=this,n=this._sideEffect.add(()=>{const s=o=>{if(o===Ce.Playing)try{r.pause()}catch{}if(o===Ce.Pause)return this._sideEffect.flush(n),a()};return r.callbacks.on("onPhaseChanged",s),()=>r.callbacks.off("onPhaseChanged",s)})});this._safeSeek(0),await e}async readyImpl(){this._safePause()}async playImpl(){const e=new Promise(a=>{const{player:r}=this,n=this._sideEffect.add(()=>{const s=o=>{o===Ce.Playing&&(this._sideEffect.flush(n),a())};return r.callbacks.on("onPhaseChanged",s),()=>r.callbacks.off("onPhaseChanged",s)})});this._safePlay(),await e}async pauseImpl(){this._safePause()}async stopImpl(){this._safeSeek(this.duration)}async seekImpl(e){this._safeSeek(e)}setPlaybackRateImpl(e){try{this.player.playbackSpeed=e}catch{}}_safeSeek(e){try{this.player.seekToProgressTime(e)}catch{}}_safePause(){try{this.player.pause()}catch{}}_safePlay(){try{this.player.play()}catch{}}}const Ua=function(e){return e.players.reduce((a,r)=>new Ia({rowPlayer:a,colPlayer:r}))};async function Fa(t){await je.syncRecordInfo(t);const e=je.rooms.get(t);return Vt(e==null?void 0:e.recordings)||[]}const Ba=/\.m3u8$/i;function Oa(t){const e=document.createElement("video"),a=document.createElement("source");if(a.src=t,e.appendChild(a),Ba.test(t))if(lt.isSupported()){const r=new lt;r.loadSource(t),r.attachMedia(e)}else e.canPlayType("application/vnd.apple.mpegurl")&&(e.src=t);return e}class Ha{constructor(e){$(this,"sideEffect",new yt);$(this,"roomUUID");$(this,"ownerUUID");$(this,"userUUID");$(this,"roomType");$(this,"recordings",Ie.array());$(this,"currentRecording",null);$(this,"video",null);$(this,"fastboard",null);$(this,"syncPlayer",null);$(this,"onStageUsersStorage",null);$(this,"onStageUsers",Ie.array([]));$(this,"isPlaying",!1);$(this,"isBuffering",!1);$(this,"tempTimestamp",0);$(this,"currentTime",0);$(this,"duration",0);$(this,"_isLoadingRecording",{current:!1,next:null});$(this,"seek",e=>{this.tempTimestamp=e,this.sideEffect.setTimeout(this.seekNow,100,"seek")});$(this,"seekNow",()=>{this.currentRecording&&this.syncPlayer&&(this.syncPlayer.seek(this.tempTimestamp-this.currentRecording.beginTime),this.tempTimestamp=0)});$(this,"togglePlayPause",()=>{this.isPlaying?this.pause():this.play()});if(!ye.userUUID)throw new Error("Missing userUUID");window.classroomReplayStore=this,this.roomUUID=e.roomUUID,this.ownerUUID=e.ownerUUID,this.userUUID=ye.userUUID,this.roomType=e.roomType,zt(this,{sideEffect:!1,fastboard:Ie.ref,syncPlayer:Ie.ref,currentRecording:Ie.ref,_isLoadingRecording:!1})}get currentTimestamp(){return this.tempTimestamp||this.realTimestamp}get realTimestamp(){var e;return(((e=this.currentRecording)==null?void 0:e.beginTime)||0)+this.currentTime}get roomInfo(){return je.rooms.get(this.roomUUID)}get isCreator(){return this.ownerUUID===this.userUUID}async init(){this.updateRecordings(await Fa(this.roomUUID))}async destroy(){var e,a;(e=this.syncPlayer)==null||e.pause(),this.sideEffect.flushAll(),(a=this.fastboard)==null||a.destroy(),window.classroomReplayStore=void 0}updateRecordings(e){this.recordings.replace(e)}async loadRecording(e){var k;if(!ye.whiteboardRoomUUID||!ye.whiteboardRoomToken)throw new Error("Missing whiteboard UUID and Token");if(e===this.currentRecording)return;if(this._isLoadingRecording.current){this._isLoadingRecording.next=e;return}this._isLoadingRecording={current:!0,next:null},this.currentRecording=e,this.isPlaying=!1,this.currentTime=0,this.video=null,this.fastboard&&await this.fastboard.destroy();const a=await Xt({sdkConfig:{appIdentifier:"cFjxAJjiEeuUQ0211QCRBw/mO9uJB_DiCIqug",region:(k=ye.region)!=null?k:"cn-hz",pptParams:{useServerWrap:!0}},replayRoom:{room:ye.whiteboardRoomUUID,roomToken:ye.whiteboardRoomToken,beginTimestamp:e.beginTime,duration:e.endTime-e.beginTime},managerConfig:{cursor:!0,containerSizeRatio:ra,viewMode:"scroll"}}),r=a.syncedStore.connectStorage("onStageUsers",{});this.sideEffect.push(r.on("stateChanged",()=>{this.updateOnStageUsers(r.state)}),"onStageUsers");const n=this._isLoadingRecording.next;if(n)return this._isLoadingRecording={current:!1,next:null},await a.destroy(),this.loadRecording(n);this._isLoadingRecording={current:!1,next:null},this.sideEffect.push(a.phase.subscribe(b=>{Yt(()=>{this.isBuffering=b==="buffering",b==="ended"&&this.pause()})}),"isBuffering"),this.updateFastboard(a,r);const s=[],o=new La({name:"whiteboard",player:a.player});if(s.push(o),e.videoURL){const b=Oa(e.videoURL),m=new Na({name:"main",video:b});s.push(m),this.updateVideo(b)}else this.updateVideo(null);const c=new Ua({players:s});this.sideEffect.add(()=>{const b=ut(()=>{this.duration=c.duration});c.on("durationchange",b);const m=ut(()=>{this.currentTime=c.currentTime});return c.on("timeupdate",m),()=>{c.off("durationchange",b),c.off("timeupdate",m)}},"syncCurrentTime"),this.updateSyncPlayer(c)}updateVideo(e){this.video=e}updateSyncPlayer(e){var a;(a=this.syncPlayer)==null||a.pause(),this.syncPlayer=e}updateFastboard(e,a){this.fastboard=e,this.onStageUsersStorage=a}updateOnStageUsers(e){this.onStageUsers.replace(Object.keys(e).filter(a=>e[a]))}play(){var e;(e=this.syncPlayer)==null||e.play(),this.isPlaying=!0}pause(){var e;this.isPlaying=!1,(e=this.syncPlayer)==null||e.pause()}}const Wa=De(function({visible:e,onCancel:a,onConfirm:r,onSendWindowWillClose:n}){const s=gt(),o=i.exports.useContext(mt);return i.exports.useEffect(()=>{if(o)return o.sendWindowWillCloseEvent(n),()=>{o.removeWindowWillCloseEvent()}}),f(Kt,{footer:[f(Fe,{onClick:a,children:s("cancel")},"exit-cancel"),f(Fe,{onClick:r,children:s("confirm")},"exit-confirm")],open:e,title:s("exit-replay"),onCancel:a,children:s("exit-reply-tips")})});function Aa(t){var o;const e=pt(),a=sa(),[r,n]=i.exports.useState(),s=(o=r==null?void 0:r.roomInfo)==null?void 0:o.title;return i.exports.useEffect(()=>{s&&(document.title=s)},[s]),i.exports.useEffect(()=>{const c=new Ha(t);return n(c),e(c.init()).catch(k=>{ia(k),a(Gt.HomePage)}),()=>{c==null||c.destroy().catch(k=>{})}},[]),r}const ja=["click"],Va=De(function({classroomReplayStore:e}){const a=gt(),r=pt(),{currentRecording:n,recordings:s}=e,[o,c]=i.exports.useState(!1),k=n?s.indexOf(n):-1,b=i.exports.useCallback(async y=>{c(!0),await r(e.loadRecording(y)),c(!1)},[e,r]),m=o||e.isBuffering;i.exports.useEffect(()=>{!n&&s.length>0&&b(s[0])},[n,b,s,s.length]);const x=i.exports.useCallback(y=>y&&n&&We(y-n.beginTime),[n]);return me("div",{className:"replay-playlist",children:[n&&f(Sa,{className:"replay-progress",max:n.endTime,min:n.beginTime,tooltip:{formatter:x},value:e.currentTimestamp,onChange:e.seek}),f(Fe,{disabled:!n||m,onClick:e.togglePlayPause,children:e.isPlaying?f(_a,{}):f(Ea,{})}),n&&f(qt,{color:m?"yellow":"blue",children:me("div",{className:"replay-current-recording",children:[m&&f(la,{indicator:f(Zt,{spin:!0})}),a(m?"replay-page.loading":"replay-page.playing"),": ",ft(a,k,n)]})}),f("div",{className:"replay-splitter"}),e.duration>0&&me("div",{className:"replay-time",children:[We(e.currentTime),"/",We(e.duration)]}),f("span",{className:"replay-playlist-dropdown-wrapper",children:f(Jt,{className:"replay-playlist-dropdown",overlay:f(Qt,{items:s.map((y,d)=>({key:d,label:ft(a,d,y)})),onClick:({key:y})=>b(s[+y])}),placement:"topRight",trigger:ja,children:f(Fe,{className:"replay-select-playlist",disabled:m,children:f(Ta,{})})})})]})});function ft(t,e,a){let r=t("record-nth",{nth:e+1});if(a){const{beginTime:n,endTime:s}=a;r+=" ("+ct(n,"HH:mm:ss")+" ~ "+ct(s,"HH:mm:ss")+")"}return r}function We(t){const e=t/1e3|0,a=e/60|0,r=a/60|0;return`${Ae(r)}:${Ae(a%60)}:${Ae(e%60)}`}function Ae(t){return t.toString().padStart(2,"0")}const za=De(function({classroomReplayStore:e}){const a=i.exports.useRef(null);return i.exports.useEffect(()=>{a.current&&(a.current.firstChild&&a.current.removeChild(a.current.firstChild),e.video&&a.current.appendChild(e.video))},[e.video]),f("div",{ref:a,className:"replay-video"})}),Xa=De(function({classroomReplayStore:e}){const a=i.exports.useContext(ea),r=i.exports.useRef(null),n=e==null?void 0:e.fastboard;return i.exports.useEffect(()=>{n&&r.current&&n.bindContainer(r.current)},[n]),i.exports.useEffect(()=>{n&&n.manager.setPrefersColorScheme(a?"dark":"light")},[n,a]),f("div",{ref:r,className:"replay-whiteboard"})}),Qa=De(function({match:e}){oa();const a=ta(),r=Aa(e.params),[n,s]=i.exports.useState(!1),o=i.exports.useContext(mt);return r?me("div",{className:"replay-container",children:[o&&f(na,{showWindowsSystemBtn:o.showWindowsBtn,onClickWindowsSystemBtn:o.onClickWindowsSystemBtn,onDoubleClick:o.clickWindowMaximize}),f("div",{className:"replay-videos is-horizontal",children:f(za,{classroomReplayStore:r})}),me("div",{className:"replay-content",children:[f(Xa,{classroomReplayStore:r}),f("div",{className:"replay-share-screen"}),f("div",{className:pe("replay-bottom",{"is-playing":r.isPlaying}),children:f(Va,{classroomReplayStore:r})})]}),f(Wa,{visible:n,onCancel:()=>s(!1),onConfirm:()=>a.goBack(),onSendWindowWillClose:()=>s(!0)})]}):f(aa,{})});export{Qa as ReplayPage,Qa as default};
//# sourceMappingURL=index.94cd8c30.js.map
