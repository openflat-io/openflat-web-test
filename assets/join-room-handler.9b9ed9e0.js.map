{"version":3,"file":"join-room-handler.9b9ed9e0.js","sources":["../../../../packages/flat-pages/src/utils/join-room-handler.ts"],"sourcesContent":["import { RouteNameType, usePushHistory } from \"../utils/routes\";\nimport { roomStore, globalStore } from \"@netless/flat-stores\";\nimport { RoomType } from \"@netless/flat-server-api\";\nimport { errorTips } from \"flat-components\";\n\nexport const joinRoomHandler = async (\n    roomUUID: string,\n    pushHistory: ReturnType<typeof usePushHistory>,\n): Promise<void> => {\n    try {\n        const formatRoomUUID = roomUUID.replace(/\\s+/g, \"\");\n        const roomInfo = roomStore.rooms.get(formatRoomUUID);\n        const periodicUUID = roomInfo?.periodicUUID;\n        const data = await roomStore.joinRoom(periodicUUID || formatRoomUUID);\n        globalStore.updateShowGuide(data.showGuide);\n        globalStore.updatePeriodicUUID(roomInfo?.periodicUUID);\n\n        switch (data.roomType) {\n            case RoomType.BigClass: {\n                pushHistory(RouteNameType.BigClassPage, data);\n                break;\n            }\n            case RoomType.SmallClass: {\n                pushHistory(RouteNameType.SmallClassPage, data);\n                break;\n            }\n            case RoomType.OneToOne: {\n                pushHistory(RouteNameType.OneToOnePage, data);\n                break;\n            }\n            default: {\n                new Error(\"failed to join room: incorrect room type\");\n            }\n        }\n    } catch (e) {\n        pushHistory(RouteNameType.HomePage);\n        errorTips(e);\n    }\n};\n"],"names":["joinRoomHandler","roomUUID","pushHistory","formatRoomUUID","roomInfo","roomStore","periodicUUID","data","globalStore","RoomType","RouteNameType","e","errorTips"],"mappings":"0GAKa,MAAAA,EAAkB,MAC3BC,EACAC,IACgB,CACZ,GAAA,CACA,MAAMC,EAAiBF,EAAS,QAAQ,OAAQ,EAAE,EAC5CG,EAAWC,EAAU,MAAM,IAAIF,CAAc,EAC7CG,EAAeF,GAAA,YAAAA,EAAU,aACzBG,EAAO,MAAMF,EAAU,SAASC,GAAgBH,CAAc,EAIpE,OAHYK,EAAA,gBAAgBD,EAAK,SAAS,EAC9BC,EAAA,mBAAmBJ,GAAA,YAAAA,EAAU,YAAY,EAE7CG,EAAK,SAAU,CACnB,KAAKE,EAAS,SAAU,CACRP,EAAAQ,EAAc,aAAcH,CAAI,EAC5C,KACJ,CACA,KAAKE,EAAS,WAAY,CACVP,EAAAQ,EAAc,eAAgBH,CAAI,EAC9C,KACJ,CACA,KAAKE,EAAS,SAAU,CACRP,EAAAQ,EAAc,aAAcH,CAAI,EAC5C,KACJ,CACA,QACI,IAAI,MAAM,0CAA0C,CAE5D,QACKI,GACLT,EAAYQ,EAAc,QAAQ,EAClCE,EAAUD,CAAC,CACf,CACJ"}